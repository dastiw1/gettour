"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();exports.__isNativeEvent=__isNativeEvent;var _utils=require("./utils");function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function __isNativeEvent(event){var defaultEvents=["click","mouseover","mouseout","keyup","keypress","change","focus","submit"];return defaultEvents.indexOf(event)>-1}var ChangesListener=function(){function ChangesListener(_ref){var listener_id=_ref.listener_id,selector=_ref.selector,event=_ref.event,attributeName=_ref.attributeName;_classCallCheck(this,ChangesListener);this.__tourObject=null;this.listener_id=listener_id;this.selector=selector;this.event=event;this.attributeName=attributeName}_createClass(ChangesListener,[{key:"init",value:function init(){var _this=this;if(this.tourJs==null){(0,_utils.showError)("Сперва задайте значение tourJs");return}var isBody=false;var event=this.event;var config={attributes:true,childList:true,characterData:false};var target=document.querySelector(this.selector);if(__isNativeEvent(event)){if(event==="click"){this.callback=this.nativeClickListener.bind(this);document.addEventListener(event,this.callback,false)}else if(target!=null){this.callback=this.nativeEventListener.bind(this);target.addEventListener(event,this.callback,false)}else if(target==null){(0,_utils.showError)("Ошибка: Элемент отсутствует в DOM")}return}if(!target){target=document.body;config.subtree=true;isBody=true}if(isBody===false){var observer=void 0;var callback=void 0;switch(event){case"show":callback=this.IntersectionShowCallback;break;case"hide":callback=this.IntersectionHideCallback;break;case"class_change":callback=this.classChangeCallback;break;case"attr_change":callback=this.attributeChangeCallback;break;case"text_change":config=Object.assign(config,{subtree:true,characterData:true,attributeOldValue:true,characterDataOldValue:true});callback=this.characterDataChangeCallback;break;case"children_change":config.subtree=true;callback=this.childrenChangeCallback;break;default:(0,_utils.showError)("Не попал под условия: "+this.selector+" - "+event);return}if(typeof callback!=="function"){(0,_utils.showError)("Callback функция не определена!");return}if(["show","hide"].indexOf(event)>-1){observer=new IntersectionObserver(function(entries,context){entries.forEach(callback.bind(context))})}else{observer=new MutationObserver(function(mutations,context){mutations.forEach(callback.bind(context))})}this.tourJs.__observers[this.listener_id]=observer;observer.observe(target,config)}else{var _observer=new MutationObserver(function(mutations,context){switch(event){case"show":mutations.forEach(_this.showCallback.bind(context));break;case"hide":mutations.forEach(_this.hideCallback.bind(context));break;default:(0,_utils.showError)("Не попал под условия: "+_this.selector+" - "+_this.event);_this.disconnectListener();break}});this.tourJs.__observers[this.listener_id]=_observer;_observer.observe(target,config)}}},{key:"disconnectListener",value:function disconnectListener(){var listener=this.tourJs.__observers[this.listener_id];if(!listener){(0,_utils.showError)("Listener с id "+this.listener_id+" не найден");return}listener.disconnect()}},{key:"sendMessage",value:function sendMessage(){this.tourJs.sendMessage({listener_id:this.listener_id})}},{key:"nativeEventListener",value:function nativeEventListener(jsEvent){if(jsEvent.target.matches(this.selector)){this.sendMessage();jsEvent.target.removeEventListener(this.event,this.callback,false)}}},{key:"nativeClickListener",value:function nativeClickListener(jsEvent){if(jsEvent.target.matches(this.selector)){this.sendMessage();jsEvent.target.removeEventListener(this.event,this.callback,false)}}},{key:"IntersectionShowCallback",value:function IntersectionShowCallback(changeListener){if(this.isIntersecting){changeListener.sendMessage();changeListener.disconnectListener()}}},{key:"IntersectionHideCallback",value:function IntersectionHideCallback(changeListener){if(this.intersectionRatio===0&&this.isIntersecting===false){changeListener.sendMessage();changeListener.disconnectListener()}}},{key:"showCallback",value:function showCallback(changeListener){if(this.type==="childList"&&this.addedNodes.length>0){var el=document.querySelector(changeListener.selector);if(this.addedNodes[0].isSameNode(el)){changeListener.sendMessage();return changeListener.disconnectListener()}}return false}},{key:"hideCallback",value:function hideCallback(changeListener){if(this.type==="childList"&&this.removedNodes.length>0){var node=this.removedNodes[0];if(node.nodeType===1&&node.matches(changeListener.selector)){changeListener.sendMessage();return changeListener.disconnectListener()}}return false}},{key:"classChangeCallback",value:function classChangeCallback(changeListener){if(this.type==="attributes"&&this.attributeName==="class"){changeListener.sendMessage();return changeListener.disconnectListener()}return false}},{key:"attributeChangeCallback",value:function attributeChangeCallback(changeListener){if(this.type==="attributes"&&this.attributeName===changeListener.attributeName){changeListener.sendMessage();return changeListener.disconnectListener()}return false}},{key:"characterDataChangeCallback",value:function characterDataChangeCallback(changeListener){if(this.type==="characterData"||this.type==="childList"){changeListener.sendMessage();changeListener.disconnectListener()}}},{key:"childrenChangeCallback",value:function childrenChangeCallback(changeListener){if(this.type==="childList"){changeListener.sendMessage();changeListener.disconnectListener()}}},{key:"tourJs",get:function get(){return this.__tourObject},set:function set(val){this.__tourObject=val}}]);return ChangesListener}();exports.default=ChangesListener;"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj};var _introChat=require("./intro-chat");var _introChat2=_interopRequireDefault(_introChat);var _ChangesListener=require("./ChangesListener");var _ChangesListener2=_interopRequireDefault(_ChangesListener);var _utils=require("./utils");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function setOptions(_ref){var options=_ref.options;if((typeof options==="undefined"?"undefined":_typeof(options))==="object"){this.__intro.setOptions(options)}else{this.__intro.setOptions(this.config)}}function isAnyPartOfElementInViewport(el){var scroll=window.scrollY||window.pageYOffset;var boundsTop=el.getBoundingClientRect().top+scroll;var viewport={top:scroll,bottom:scroll+window.innerHeight};var bounds={top:boundsTop,bottom:boundsTop+el.clientHeight};return bounds.bottom>=viewport.top&&bounds.bottom<=viewport.bottom||bounds.top<=viewport.bottom&&bounds.top>=viewport.top}function isMessageFromWidget(event){if(event.origin.indexOf("https://getchat.me")||event.origin.indexOf("http://localhost:3000")){if(_typeof(event.data)!=="object"||event.data.source!=="getchat-widget"){return false}return true}return false}var onboarding={stylesFilePath:"http://localhost:3000/gettour-styles.css",selector:".getchat-widget__frame",expandClass:"getchat-widget--expanded",active:false,__intro:null,widgetHash:null,autoShowConditions:[],domain:null,block:null,setOptions:setOptions,stylesLoaded:false,__observers:{},init:function init(hash){var _this=this;var self=this;this.hash=hash;this.loadWidgetData().then(function(data){_this.domain=data.domain;_this.active=data.widget_active;_this.autoShowConditions=data.conditions;if(_this.domain!==window.location.host){(0,_utils.showError)("[Ошибка] Виджет не для этого домена");return}if(!_this.active){return}_this.__intro=(0,_introChat2.default)();_this.__intro.onchange(function(){self.__intro.refresh();return _this});_this.__intro.onbeforechange(function(){if(_this.__intro._introItems.length){var step=_this.__intro._introItems[0];self.setOptions(step)}var closeBtn=document.querySelector(".getchat-widget > .getchat-widget__btn--icon");if(closeBtn){closeBtn.style.display="none"}});_this.__intro.onexit(function(){var closeBtn=document.querySelector(".getchat-widget > .getchat-widget__btn--icon");if(closeBtn){closeBtn.style.display="inline-flex"}});window.addEventListener("message",function(event){_this.__listenForHighlightRequests.call(_this,event)});window.addEventListener("message",function(event){_this.__listenForActionClickedRequests.call(_this,event)});window.addEventListener("message",function(event){_this.__listenForObserveRequests.call(_this,event)});_this.loadCondition();_this.listenForLocationChange()});return this},loadCondition:function loadCondition(){var _this2=this;this.autoShowConditions.forEach(function(cond){var regex=new RegExp(cond.urlRegex,"i");if(regex.test(window.location.pathname)){setTimeout(function(){_this2.renderWidget(cond.src);if(!_this2.stylesLoaded){_this2.loadStyles()}_this2.initEventListeners()},cond.timeInterval*1e3)}})},listenForLocationChange:function listenForLocationChange(){var _this3=this;history.pushState=function(f){return function pushState(){var ret=f.apply(this,arguments);window.dispatchEvent(new Event("pushState"));window.dispatchEvent(new Event("locationchange"));return ret}}(history.pushState);history.replaceState=function(f){return function replaceState(){var ret=f.apply(this,arguments);window.dispatchEvent(new Event("replaceState"));window.dispatchEvent(new Event("locationchange"));return ret}}(history.replaceState);window.addEventListener("popstate",function(){window.dispatchEvent(new Event("locationchange"))});window.addEventListener("locationchange",function(){_this3.reset();_this3.loadCondition()})},__listenForActionClickedRequests:function __listenForActionClickedRequests(e){if(isMessageFromWidget(e)&&e.data.action==="ACTION_CLICKED"){var answer_id=e.data.answer_id;if(answer_id===this.__intro._options.steps[0].highlightEventAnswerId){this.__intro.exit()}}},__listenForObserveRequests:function __listenForObserveRequests(e){if(isMessageFromWidget(e)&&e.data.action==="OBSERVE"){var listener=new _ChangesListener2.default(e.data);listener.tourJs=this;listener.init()}},__listenForHighlightRequests:function __listenForHighlightRequests(e){if(isMessageFromWidget(e)&&e.data.action==="HIGHLIGHT"){if(e.data.selector){this.highlight(e.data)}}},__getElementForHighlight:function __getElementForHighlight(selector){var elements=document.querySelectorAll(selector);var elementsArray=Array.from(elements);return elementsArray.find(isAnyPartOfElementInViewport)},highlight:function highlight(_ref2){var _this4=this;var selector=_ref2.selector,closeEvent=_ref2.closeEvent,highlightEventAnswerId=_ref2.highlightEventAnswerId;var step={element:selector,fixed:true,closeEvent:closeEvent,highlightEventAnswerId:highlightEventAnswerId};var introElement=this.__getElementForHighlight(selector);if(introElement==null){(0,_utils.showError)("Element doesn't exist on DOM");return}if(closeEvent==="chatListenerClick"){this.setOptions({options:{exitOnEsc:false,exitOnOverlayClick:false,disableInteraction:true}})}else{this.setOptions({options:{exitOnEsc:true,exitOnOverlayClick:false,disableInteraction:false}})}this.__intro.addStep(step);introElement.addEventListener(closeEvent,function(){_this4.__intro.exit()},{once:true});if(this.__intro._introItems.length){this.__intro.goToStepNumber(0)}this.__intro.exit();setTimeout(function(){_this4.__intro.start(step)},50)},sendMessage:function sendMessage(msg){this.__intro.exit();var iframe=document.querySelector(this.selector);if(!iframe){(0,_utils.showError)("Widget's iframe not found!");return}iframe.contentWindow.postMessage(Object.assign(msg,{source:"get-tour-library"}))},reset:function reset(){this.__intro._options.steps=[];this.__intro.refresh();this.destroyWidget()},destroyWidget:function destroyWidget(){if(this.block){this.block.remove()}},renderWidget:function renderWidget(widgetUrl){this.block=document.createElement("div");this.block.className="getchat-widget getchat-widget--expanded";var widgetHtml='<button type="button" class="getchat-widget__btn--icon" >'+'<i aria-hidden="true" class="getchat-widget__icon--close"></i></button>'+('<iframe src="'+widgetUrl+'" class="getchat-widget__frame"></iframe>');this.block.innerHTML=widgetHtml;document.body.appendChild(this.block)},loadStyles:function loadStyles(){(0,_utils.loadCss)(this.stylesFilePath);this.stylesLoaded=true},initEventListeners:function initEventListeners(){var _this5=this;var $closeBtn=document.querySelector(".getchat-widget__btn--icon");$closeBtn.addEventListener("click",function(){if(_this5.block.classList.contains(_this5.expandClass)){_this5.hideBlock()}else{_this5.showBlock()}})},hideBlock:function hideBlock(){var $closeBtn=document.querySelector(".getchat-widget__btn--icon");var $icon=$closeBtn.children[0];this.block.classList.remove(this.expandClass);$icon.className="getchat-widget__icon--expand"},expandBlock:function expandBlock(){var $closeBtn=document.querySelector(".getchat-widget__btn--icon");var $icon=$closeBtn.children[0];this.block.classList.add(this.expandClass);$icon.className="getchat-widget__icon--close"},loadWidgetData:function loadWidgetData(){var url="http://localhost:3000/api/the-bot/widget/"+this.hash+"/data";return new Promise(function(resolve,reject){return fetch(url,{method:"GET",headers:{"Content-Type":"application/json"}}).then(function(res){if(res.status===200){return res.json()}(0,_utils.showError)("[Ошибка] "+res.statusText);return{}}).then(function(response){return resolve(response)}).catch(function(error){(0,_utils.showError)(error);reject(error)})})}};exports.default=onboarding;module.exports=exports.default;"use strict";var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj};(function(f){if((typeof exports==="undefined"?"undefined":_typeof(exports))==="object"&&typeof module!=="undefined"){module.exports=f();module.exports.introJs=function(){console.warn('Deprecated: please use require("intro.js") directly, instead of the introJs method of the function');return f().apply(this,arguments)}}else if(typeof define==="function"&&define.amd){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}g.introJs=f()}})(function(){var VERSION="2.9.3";function IntroJs(obj){this._targetElement=obj;this._introItems=[];this._options={highlightClass:"",exitOnEsc:true,exitOnOverlayClick:true,keyboardNavigation:false,scrollToElement:true,scrollTo:"element",scrollPadding:30,overlayOpacity:.8,positionPrecedence:["bottom","top","right","left"],disableInteraction:false,helperElementPadding:0,buttonClass:"introjs-button"}}function _introForElement(targetElm,step){var introItems=[];var currentItem=_cloneObject(step);currentItem.step=introItems.length+1;if(typeof currentItem.element==="string"){currentItem.element=document.querySelector(currentItem.element)}if(typeof currentItem.element==="undefined"||currentItem.element===null){var floatingElementQuery=document.querySelector(".introjsFloatingElement");if(floatingElementQuery===null){floatingElementQuery=document.createElement("div");floatingElementQuery.className="introjsFloatingElement";document.body.appendChild(floatingElementQuery)}currentItem.element=floatingElementQuery;currentItem.position="floating"}currentItem.scrollTo=currentItem.scrollTo||this._options.scrollTo;if(typeof currentItem.disableInteraction==="undefined"){currentItem.disableInteraction=this._options.disableInteraction}if(currentItem.element!==null){introItems=[currentItem]}this._introItems=introItems;if(_addOverlayLayer.call(this,targetElm)){_nextStep.call(this);if(this._options.keyboardNavigation){DOMEvent.on(window,"keydown",_onKeyDown,this,true)}DOMEvent.on(window,"resize",_onResize,this,true)}return false}function _onResize(){this.refresh.call(this)}function _onKeyDown(e){var code=e.code===null?e.which:e.code;if(code===null){code=e.charCode===null?e.keyCode:e.charCode}if((code==="Escape"||code===27)&&this._options.exitOnEsc===true){_exitIntro.call(this,this._targetElement)}}function _cloneObject(object){if(object===null||(typeof object==="undefined"?"undefined":_typeof(object))!=="object"||typeof object.nodeType!=="undefined"){return object}var temp={};for(var key in object){if(typeof window.jQuery!=="undefined"&&object[key]instanceof window.jQuery){temp[key]=object[key]}else{temp[key]=_cloneObject(object[key])}}return temp}function _goToStep(step){this._currentStep=step-2;if(typeof this._introItems!=="undefined"){_nextStep.call(this)}}function _goToStepNumber(step){this._currentStepNumber=step;if(typeof this._introItems!=="undefined"){_nextStep.call(this)}}function _nextStep(){this._direction="forward";if(typeof this._currentStepNumber!=="undefined"){_forEach(this._introItems,function(item,i){if(item.step===this._currentStepNumber){this._currentStep=i-1;this._currentStepNumber=undefined}}.bind(this))}if(typeof this._currentStep==="undefined"){this._currentStep=0}else{++this._currentStep}var nextStep=this._introItems[0];var continueStep=true;if(typeof this._introBeforeChangeCallback!=="undefined"){continueStep=this._introBeforeChangeCallback.call(this,nextStep.element)}if(continueStep===false){--this._currentStep;return false}if(this._introItems.length<=this._currentStep){if(typeof this._introCompleteCallback==="function"){this._introCompleteCallback.call(this)}_exitIntro.call(this,this._targetElement);return}_showElement.call(this,nextStep)}function _refresh(){_setHelperLayerPosition.call(this,document.querySelector(".introjs-helperLayer"));_setHelperLayerPosition.call(this,document.querySelector(".introjs-tooltipReferenceLayer"));_setHelperLayerPosition.call(this,document.querySelector(".introjs-disableInteraction"));return this}function _exitIntro(targetElement,force){var continueExit=true;if(this._introBeforeExitCallback!==undefined){continueExit=this._introBeforeExitCallback.call(this)}if(!force&&continueExit===false)return;var overlayLayers=targetElement.querySelectorAll(".introjs-overlay");if(overlayLayers&&overlayLayers.length){_forEach(overlayLayers,function(overlayLayer){overlayLayer.style.opacity=0;window.setTimeout(function(){if(this.parentNode){this.parentNode.removeChild(this)}}.bind(overlayLayer),500)}.bind(this))}var helperLayer=targetElement.querySelector(".introjs-helperLayer");if(helperLayer){helperLayer.parentNode.removeChild(helperLayer)}var referenceLayer=targetElement.querySelector(".introjs-tooltipReferenceLayer");if(referenceLayer){referenceLayer.parentNode.removeChild(referenceLayer)}var disableInteractionLayer=targetElement.querySelector(".introjs-disableInteraction");if(disableInteractionLayer){disableInteractionLayer.parentNode.removeChild(disableInteractionLayer)}var floatingElement=document.querySelector(".introjsFloatingElement");if(floatingElement){floatingElement.parentNode.removeChild(floatingElement)}_removeShowElement();var fixParents=document.querySelectorAll(".introjs-fixParent");_forEach(fixParents,function(parent){_removeClass(parent,/introjs-fixParent/g)});DOMEvent.off(window,"keydown",_onKeyDown,this,true);DOMEvent.off(window,"resize",_onResize,this,true);if(this._introExitCallback!==undefined){this._introExitCallback.call(this)}this._currentStep=undefined}function _checkRight(targetOffset,tooltipLayerStyleLeft,tooltipOffset,windowSize,tooltipLayer){if(targetOffset.left+tooltipLayerStyleLeft+tooltipOffset.width>windowSize.width){tooltipLayer.style.left=windowSize.width-tooltipOffset.width-targetOffset.left+"px";return false}tooltipLayer.style.left=tooltipLayerStyleLeft+"px";return true}function _checkLeft(targetOffset,tooltipLayerStyleRight,tooltipOffset,tooltipLayer){if(targetOffset.left+targetOffset.width-tooltipLayerStyleRight-tooltipOffset.width<0){tooltipLayer.style.left=-targetOffset.left+"px";return false}tooltipLayer.style.right=tooltipLayerStyleRight+"px";return true}function _determineAutoPosition(targetElement,tooltipLayer,desiredTooltipPosition){var possiblePositions=this._options.positionPrecedence.slice();var windowSize=_getWinSize();var tooltipHeight=_getOffset(tooltipLayer).height+10;var tooltipWidth=_getOffset(tooltipLayer).width+20;var targetElementRect=targetElement.getBoundingClientRect();var calculatedPosition="floating";if(targetElementRect.bottom+tooltipHeight+tooltipHeight>windowSize.height){_removeEntry(possiblePositions,"bottom")}if(targetElementRect.top-tooltipHeight<0){_removeEntry(possiblePositions,"top")}if(targetElementRect.right+tooltipWidth>windowSize.width){_removeEntry(possiblePositions,"right")}if(targetElementRect.left-tooltipWidth<0){_removeEntry(possiblePositions,"left")}var desiredAlignment=function(pos){var hyphenIndex=pos.indexOf("-");if(hyphenIndex!==-1){return pos.substr(hyphenIndex)}return""}(desiredTooltipPosition||"");if(desiredTooltipPosition){desiredTooltipPosition=desiredTooltipPosition.split("-")[0]}if(possiblePositions.length){if(desiredTooltipPosition!=="auto"&&possiblePositions.indexOf(desiredTooltipPosition)>-1){calculatedPosition=desiredTooltipPosition}else{calculatedPosition=possiblePositions[0]}}if(["top","bottom"].indexOf(calculatedPosition)!==-1){calculatedPosition+=_determineAutoAlignment(targetElementRect.left,tooltipWidth,windowSize,desiredAlignment)}return calculatedPosition}function _determineAutoAlignment(offsetLeft,tooltipWidth,windowSize,desiredAlignment){var halfTooltipWidth=tooltipWidth/2,winWidth=Math.min(windowSize.width,window.screen.width),possibleAlignments=["-left-aligned","-middle-aligned","-right-aligned"],calculatedAlignment="";if(winWidth-offsetLeft<tooltipWidth){_removeEntry(possibleAlignments,"-left-aligned")}if(offsetLeft<halfTooltipWidth||winWidth-offsetLeft<halfTooltipWidth){_removeEntry(possibleAlignments,"-middle-aligned")}if(offsetLeft<tooltipWidth){_removeEntry(possibleAlignments,"-right-aligned")}if(possibleAlignments.length){if(possibleAlignments.indexOf(desiredAlignment)!==-1){calculatedAlignment=desiredAlignment}else{calculatedAlignment=possibleAlignments[0]}}else{calculatedAlignment="-middle-aligned"}return calculatedAlignment}function _removeEntry(stringArray,stringToRemove){if(stringArray.indexOf(stringToRemove)>-1){stringArray.splice(stringArray.indexOf(stringToRemove),1)}}function _setHelperLayerPosition(helperLayer){var _this=this;if(helperLayer){if(!this._introItems[this._currentStep])return;var currentElement=this._introItems[this._currentStep],elementPosition=_getOffset(currentElement.element),widthHeightPadding=this._options.helperElementPadding;if(_isFixed(currentElement.element)){_addClass(helperLayer,"introjs-fixedTooltip")}else{_removeClass(helperLayer,"introjs-fixedTooltip")}if(currentElement.position==="floating"){widthHeightPadding=0}helperLayer.style.cssText="width: "+(elementPosition.width+widthHeightPadding)+"px; "+"height:"+(elementPosition.height+widthHeightPadding)+"px; "+"top:"+(elementPosition.top-widthHeightPadding/2)+"px;"+"left: "+(elementPosition.left-widthHeightPadding/2)+"px;";window.setTimeout(function(){_setClipPathOfHelper.call(_this,helperLayer)},35)}}function _disableInteraction(){var disableInteractionLayer=document.querySelector(".introjs-disableInteraction");if(disableInteractionLayer===null){disableInteractionLayer=document.createElement("div");disableInteractionLayer.className="introjs-disableInteraction";this._targetElement.appendChild(disableInteractionLayer)}_setHelperLayerPosition.call(this,disableInteractionLayer)}function _setAnchorAsButton(anchor){anchor.setAttribute("role","button");anchor.tabIndex=0}function _getDimensions(helper){return{width:helper.offsetWidth,height:helper.offsetHeight,left:helper.offsetLeft,top:helper.offsetTop}}function _setClipPathOfHelper(helperLayer){var step=this._introItems[0];var overlay=document.querySelector(".introjs-overlay");if(step.fixed){var _getDimensions$call=_getDimensions.call(this,helperLayer),width=_getDimensions$call.width,height=_getDimensions$call.height,left=_getDimensions$call.left,top=_getDimensions$call.top;var coords=[{x:"0%",y:"0%"},{x:"0%",y:"100%"},{x:left+"px",y:"100%"},{x:left+"px",y:top+"px"},{x:left+width+"px",y:top+"px"},{x:left+width+"px",y:top+height+"px"},{x:left+"px",y:top+height+"px"},{x:left+"px",y:"100%"},{x:"100%",y:"100%"},{x:"100%",y:"0%"}];if(overlay){overlay.style.clipPath="polygon("+coords.map(function(_ref){var x=_ref.x,y=_ref.y;return x+" "+y}).join(", ")+")"}helperLayer.style.visibility="hidden"}else{overlay.style.clipPath="";helperLayer.style.visibility="visible"}}function _showElement(targetElement){if(typeof this._introChangeCallback!=="undefined"){this._introChangeCallback.call(this,targetElement.element)}var self=this,oldHelperLayer=document.querySelector(".introjs-helperLayer"),oldReferenceLayer=document.querySelector(".introjs-tooltipReferenceLayer"),highlightClass="introjs-helperLayer",scrollParent;if(typeof targetElement.highlightClass==="string"){highlightClass+=" "+targetElement.highlightClass}if(typeof this._options.highlightClass==="string"){highlightClass+=" "+this._options.highlightClass}if(oldHelperLayer!==null){scrollParent=_getScrollParent(targetElement.element);if(scrollParent!==document.body){_scrollParentToElement(scrollParent,targetElement.element)}_setHelperLayerPosition.call(self,oldHelperLayer);_setHelperLayerPosition.call(self,oldReferenceLayer);var fixParents=document.querySelectorAll(".introjs-fixParent");_forEach(fixParents,function(parent){_removeClass(parent,/introjs-fixParent/g)});_removeShowElement();if(self._lastShowElementTimer){window.clearTimeout(self._lastShowElementTimer)}self._lastShowElementTimer=window.setTimeout(function(){_scrollTo.call(self,targetElement.scrollTo,targetElement)},350)}else{var helperLayer=document.createElement("div"),referenceLayer=document.createElement("div");helperLayer.className=highlightClass;referenceLayer.className="introjs-tooltipReferenceLayer";scrollParent=_getScrollParent(targetElement.element);if(scrollParent!==document.body){_scrollParentToElement(scrollParent,targetElement.element)}_setHelperLayerPosition.call(self,helperLayer);_setHelperLayerPosition.call(self,referenceLayer);this._targetElement.appendChild(helperLayer);this._targetElement.appendChild(referenceLayer);_scrollTo.call(this,targetElement.scrollTo,targetElement)}var disableInteractionLayer=self._targetElement.querySelector(".introjs-disableInteraction");if(disableInteractionLayer){disableInteractionLayer.parentNode.removeChild(disableInteractionLayer)}if(targetElement.disableInteraction){_disableInteraction.call(self)}_setShowElement(targetElement);if(typeof this._introAfterChangeCallback!=="undefined"){this._introAfterChangeCallback.call(this,targetElement.element)}}function _scrollTo(scrollTo,targetElement){if(scrollTo==="off")return;var rect;if(!this._options.scrollToElement)return;rect=targetElement.element.getBoundingClientRect();if(!_elementInViewport(targetElement.element)){var winHeight=_getWinSize().height;var top=rect.bottom-(rect.bottom-rect.top);if(top<0||targetElement.element.clientHeight>winHeight){window.scrollBy(0,rect.top-(winHeight/2-rect.height/2)-this._options.scrollPadding)}else{window.scrollBy(0,rect.top-(winHeight/2-rect.height/2)+this._options.scrollPadding)}}}function _removeShowElement(){var elms=document.querySelectorAll(".introjs-showElement");_forEach(elms,function(elm){_removeClass(elm,/introjs-[a-zA-Z]+/g)})}function _setShowElement(targetElement){var parentElm;if(targetElement.element instanceof SVGElement){parentElm=targetElement.element.parentNode;while(targetElement.element.parentNode!==null){if(!parentElm.tagName||parentElm.tagName.toLowerCase()==="body")break;if(parentElm.tagName.toLowerCase()==="svg"){_addClass(parentElm,"introjs-showElement introjs-relativePosition")}parentElm=parentElm.parentNode}}_addClass(targetElement.element,"introjs-showElement");var currentElementPosition=_getPropValue(targetElement.element,"position");if(currentElementPosition!=="absolute"&&currentElementPosition!=="relative"&&currentElementPosition!=="fixed"){_addClass(targetElement.element,"introjs-relativePosition")}parentElm=targetElement.element.parentNode;while(parentElm!==null){if(!parentElm.tagName||parentElm.tagName.toLowerCase()==="body")break;var zIndex=_getPropValue(parentElm,"z-index");var opacity=parseFloat(_getPropValue(parentElm,"opacity"));var transform=_getPropValue(parentElm,"transform")||_getPropValue(parentElm,"-webkit-transform")||_getPropValue(parentElm,"-moz-transform")||_getPropValue(parentElm,"-ms-transform")||_getPropValue(parentElm,"-o-transform");if(/[0-9]+/.test(zIndex)||opacity<1||transform!=="none"&&transform!==undefined){_addClass(parentElm,"introjs-fixParent")}parentElm=parentElm.parentNode}}function _forEach(arr,forEachFnc,completeFnc){if(arr){for(var i=0,len=arr.length;i<len;i++){forEachFnc(arr[i],i)}}if(typeof completeFnc==="function"){completeFnc()}}var _stamp=function(){var keys={};return function stamp(obj,key){key=key||"introjs-stamp";keys[key]=keys[key]||0;if(obj[key]===undefined){obj[key]=keys[key]++}return obj[key]}}();var DOMEvent=function(){function DOMEvent(){var events_key="introjs_event";this._id=function(obj,type,listener,context){return type+_stamp(listener)+(context?"_"+_stamp(context):"")};this.on=function(obj,type,listener,context,useCapture){var id=this._id.apply(this,arguments),handler=function handler(e){return listener.call(context||obj,e||window.event)};if("addEventListener"in obj){obj.addEventListener(type,handler,useCapture)}else if("attachEvent"in obj){obj.attachEvent("on"+type,handler)}obj[events_key]=obj[events_key]||{};obj[events_key][id]=handler};this.off=function(obj,type,listener,context,useCapture){var id=this._id.apply(this,arguments),handler=obj[events_key]&&obj[events_key][id];if(!handler){return}if("removeEventListener"in obj){obj.removeEventListener(type,handler,useCapture)}else if("detachEvent"in obj){obj.detachEvent("on"+type,handler)}obj[events_key][id]=null}}return new DOMEvent}();function _addClass(element,className){if(element instanceof SVGElement){var pre=element.getAttribute("class")||"";element.setAttribute("class",pre+" "+className)}else{if(element.classList!==undefined){var classes=className.split(" ");_forEach(classes,function(cls){element.classList.add(cls)})}else if(!element.className.match(className)){element.className+=" "+className}}}function _removeClass(element,classNameRegex){if(element instanceof SVGElement){var pre=element.getAttribute("class")||"";element.setAttribute("class",pre.replace(classNameRegex,"").replace(/^\s+|\s+$/g,""))}else{element.className=element.className.replace(classNameRegex,"").replace(/^\s+|\s+$/g,"")}}function _getPropValue(element,propName){var propValue="";if(element.currentStyle){propValue=element.currentStyle[propName]}else if(document.defaultView&&document.defaultView.getComputedStyle){propValue=document.defaultView.getComputedStyle(element,null).getPropertyValue(propName)}if(propValue&&propValue.toLowerCase){return propValue.toLowerCase()}else{return propValue}}function _isFixed(element){var p=element.parentNode;if(!p||p.nodeName==="HTML"){return false}if(_getPropValue(element,"position")==="fixed"){return true}return _isFixed(p)}function _getWinSize(){if(window.innerWidth!==undefined){return{width:window.innerWidth,height:window.innerHeight}}else{var D=document.documentElement;return{width:D.clientWidth,height:D.clientHeight}}}function _elementInViewport(el){var rect=el.getBoundingClientRect();return rect.top>=0&&rect.left>=0&&rect.bottom+80<=window.innerHeight&&rect.right<=window.innerWidth}function _addOverlayLayer(targetElm){var overlayLayer=document.createElement("div"),styleText="",self=this;overlayLayer.className="introjs-overlay";if(!targetElm.tagName||targetElm.tagName.toLowerCase()==="body"){styleText+="top: 0;bottom: 0; left: 0;right: 0;position: fixed;";overlayLayer.style.cssText=styleText}else{var elementPosition=_getOffset(targetElm);if(elementPosition){styleText+="width: "+elementPosition.width+"px; height:"+elementPosition.height+"px; top:"+elementPosition.top+"px;left: "+elementPosition.left+"px;";overlayLayer.style.cssText=styleText}}targetElm.appendChild(overlayLayer);overlayLayer.onclick=function(){if(self._options.exitOnOverlayClick===true){_exitIntro.call(self,targetElm)}};window.setTimeout(function(){styleText+="opacity: "+self._options.overlayOpacity.toString()+";";overlayLayer.style.cssText=styleText},10);return true}function _getOffset(element){var body=document.body;var docEl=document.documentElement;var scrollTop=window.pageYOffset||docEl.scrollTop||body.scrollTop;var scrollLeft=window.pageXOffset||docEl.scrollLeft||body.scrollLeft;var x=element.getBoundingClientRect();return{top:x.top+scrollTop,width:x.width,height:x.height,left:x.left+scrollLeft}}function _getScrollParent(element){var style=window.getComputedStyle(element);var excludeStaticParent=style.position==="absolute";var overflowRegex=/(auto|scroll)/;if(style.position==="fixed")return document.body;for(var parent=element;parent=parent.parentElement;){style=window.getComputedStyle(parent);if(excludeStaticParent&&style.position==="static"){continue}if(overflowRegex.test(style.overflow+style.overflowY+style.overflowX))return parent}return document.body}function _scrollParentToElement(parent,element){parent.scrollTop=element.offsetTop-parent.offsetTop}function _mergeOptions(obj1,obj2){var obj3={},attrname;for(attrname in obj1){obj3[attrname]=obj1[attrname]}for(attrname in obj2){obj3[attrname]=obj2[attrname]}return obj3}var introJs=function introJs(targetElm){var instance;if((typeof targetElm==="undefined"?"undefined":_typeof(targetElm))==="object"){instance=new IntroJs(targetElm)}else if(typeof targetElm==="string"){var targetElement=document.querySelector(targetElm);if(targetElement){instance=new IntroJs(targetElement)}else{throw new Error("There is no element with given selector.")}}else{instance=new IntroJs(document.body)}introJs.instances[_stamp(instance,"introjs-instance")]=instance;return instance};introJs.version=VERSION;introJs.instances={};introJs.fn=IntroJs.prototype={clone:function clone(){return new IntroJs(this)},setOption:function setOption(option,value){this._options[option]=value;return this},setOptions:function setOptions(options){this._options=_mergeOptions(this._options,options);return this},start:function start(selector){_introForElement.call(this,this._targetElement,selector);return this},goToStep:function goToStep(step){_goToStep.call(this,step);return this},addStep:function addStep(options){if(!this._options.steps){this._options.steps=[]}this._options.steps.push(options);return this},goToStepNumber:function goToStepNumber(step){_goToStepNumber.call(this,step);return this},nextStep:function nextStep(){_nextStep.call(this);return this},exit:function exit(force){_exitIntro.call(this,this._targetElement,force);return this},refresh:function refresh(){_refresh.call(this);return this},onbeforechange:function onbeforechange(providedCallback){if(typeof providedCallback==="function"){this._introBeforeChangeCallback=providedCallback}else{throw new Error("Provided callback for onbeforechange was not a function")}return this},onchange:function onchange(providedCallback){if(typeof providedCallback==="function"){this._introChangeCallback=providedCallback}else{throw new Error("Provided callback for onchange was not a function.")}return this},onafterchange:function onafterchange(providedCallback){if(typeof providedCallback==="function"){this._introAfterChangeCallback=providedCallback}else{throw new Error("Provided callback for onafterchange was not a function")}return this},oncomplete:function oncomplete(providedCallback){if(typeof providedCallback==="function"){this._introCompleteCallback=providedCallback}else{throw new Error("Provided callback for oncomplete was not a function.")}return this},onexit:function onexit(providedCallback){if(typeof providedCallback==="function"){this._introExitCallback=providedCallback}else{throw new Error("Provided callback for onexit was not a function.")}return this},onbeforeexit:function onbeforeexit(providedCallback){if(typeof providedCallback==="function"){this._introBeforeExitCallback=providedCallback}else{throw new Error("Provided callback for onbeforeexit was not a function.")}return this}};return introJs});"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.showError=showError;exports.loadCss=loadCss;function showError(msg){console.error(msg)}function loadCss(path){var head=document.getElementsByTagName("HEAD")[0];var link=document.createElement("link");link.rel="stylesheet";link.type="text/css";link.href=path;head.appendChild(link)}var utils={showError:showError,loadCss:loadCss};exports.default=utils;