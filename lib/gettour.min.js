!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("gettour",[],e):"object"==typeof exports?exports.gettour=e():t.gettour=e()}("undefined"!=typeof self?self:this,function(){return function(t){var e={};function n(i){if(e[i])return e[i].exports;var o=e[i]={i:i,l:!1,exports:{}};return t[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(i,o,function(e){return t[e]}.bind(null,o));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=1)}([function(t,e,n){"use strict";function i(t){console.error(t)}function o(t){var e=document.getElementsByTagName("HEAD")[0],n=document.createElement("link");n.rel="stylesheet",n.type="text/css",n.href=t,e.appendChild(n)}Object.defineProperty(e,"__esModule",{value:!0}),e.showError=i,e.loadCss=o,e.default=void 0;var r={showError:i,loadCss:o};e.default=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=s(n(2)),o=s(n(3)),r=n(0);function s(t){return t&&t.__esModule?t:{default:t}}function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function c(t){var e=window.scrollY||window.pageYOffset,n=t.getBoundingClientRect().top+e,i=e,o=e+window.innerHeight,r=n,s=n+t.clientHeight;return s>=i&&s<=o||r<=o&&r>=i}function l(t){return!(!t.origin.indexOf("https://getchat.me")&&!t.origin.indexOf("http://localhost:3000"))&&("object"===a(t.data)&&"getchat-widget"===t.data.source)}var h={stylesFilePath:"http://localhost:3000/gettour-styles.css",selector:".getchat-widget__frame",expandClass:"getchat-widget--expanded",active:!1,__intro:null,widgetHash:null,autoShowConditions:[],hash:null,domain:null,block:null,setOptions:function(t){var e=t.options;"object"===a(e)?this.__intro.setOptions(e):this.__intro.setOptions(this.config)},stylesLoaded:!1,__observers:{},init:function(t){var e=this,n=this;return this.hash=t,this.loadWidgetData().then(function(t){e.domain=t.domain,e.active=t.widget_active,e.autoShowConditions=t.conditions,e.domain===window.location.host?e.active&&(e.__intro=(0,i.default)(),e.__intro.onchange(function(){return n.__intro.refresh(),e}),e.__intro.onbeforechange(function(){if(e.__intro._introItems.length){var t=e.__intro._introItems[0];n.setOptions(t)}var i=document.querySelector(".getchat-widget > .getchat-widget__btn--icon");i&&(i.style.display="none")}),e.__intro.onexit(function(){var t=document.querySelector(".getchat-widget > .getchat-widget__btn--icon");t&&(t.style.display="inline-flex")}),window.addEventListener("message",function(t){e.__listenForHighlightRequests.call(e,t)}),window.addEventListener("message",function(t){e.__listenForActionClickedRequests.call(e,t)}),window.addEventListener("message",function(t){e.__listenForObserveRequests.call(e,t)}),e.loadCondition(),e.listenForLocationChange()):(0,r.showError)("[Ошибка] Виджет не для этого домена")}),this},loadCondition:function(){var t=this;this.autoShowConditions.forEach(function(e){new RegExp(e.urlRegex,"i").test(window.location.pathname)&&setTimeout(function(){t.renderWidget(e.src),t.stylesLoaded||t.loadStyles(),t.initEventListeners()},1e3*e.timeInterval)})},listenForLocationChange:function(){var t,e=this;history.pushState=(t=history.pushState,function(){var e=t.apply(this,arguments);return window.dispatchEvent(new Event("pushState")),window.dispatchEvent(new Event("locationchange")),e}),history.replaceState=function(t){return function(){var e=t.apply(this,arguments);return window.dispatchEvent(new Event("replaceState")),window.dispatchEvent(new Event("locationchange")),e}}(history.replaceState),window.addEventListener("popstate",function(){window.dispatchEvent(new Event("locationchange"))}),window.addEventListener("locationchange",function(){e.reset(),e.loadCondition()})},__listenForActionClickedRequests:function(t){l(t)&&"ACTION_CLICKED"===t.data.action&&(t.data.answer_id===this.__intro._options.steps[0].highlightEventAnswerId&&this.__intro.exit())},__listenForObserveRequests:function(t){if(l(t)&&"OBSERVE"===t.data.action){var e=new o.default(t.data);e.tourJs=this,e.init()}},__listenForHighlightRequests:function(t){l(t)&&"HIGHLIGHT"===t.data.action&&t.data.selector&&this.highlight(t.data)},__getElementForHighlight:function(t){var e=document.querySelectorAll(t);return Array.from(e).find(c)},highlight:function(t){var e=this,n=t.selector,i=t.closeEvent,o={element:n,fixed:!0,closeEvent:i,highlightEventAnswerId:t.highlightEventAnswerId},s=this.__getElementForHighlight(n);null!=s?("chatListenerClick"===i?this.setOptions({options:{exitOnEsc:!1,exitOnOverlayClick:!1,disableInteraction:!0}}):this.setOptions({options:{exitOnEsc:!0,exitOnOverlayClick:!1,disableInteraction:!1}}),this.__intro.addStep(o),s.addEventListener(i,function(){e.__intro.exit()},{once:!0}),this.__intro._introItems.length&&this.__intro.goToStepNumber(0),this.__intro.exit(),setTimeout(function(){e.__intro.start(o)},50)):(0,r.showError)("Element doesn't exist on DOM")},sendMessage:function(t){this.__intro.exit();var e=document.querySelector(this.selector);e?e.contentWindow.postMessage(Object.assign(t,{source:"get-tour-library"})):(0,r.showError)("Widget's iframe not found!")},reset:function(){this.__intro._options.steps=[],this.__intro.refresh(),this.destroyWidget()},destroyWidget:function(){this.block&&this.block.remove()},renderWidget:function(t){this.block=document.createElement("div"),this.block.className="getchat-widget getchat-widget--expanded";var e='<button type="button" class="getchat-widget__btn getchat-widget__btn--icon" ><i aria-hidden="true" class="getchat-widget__icon--close"></i></button>'+'<iframe src="'.concat(t,'" class="getchat-widget__frame"></iframe>');this.block.innerHTML=e,document.body.appendChild(this.block)},loadStyles:function(){(0,r.loadCss)(this.stylesFilePath),this.stylesLoaded=!0},initEventListeners:function(){var t=this;document.querySelector(".getchat-widget__btn--icon").addEventListener("click",function(){t.block.classList.contains(t.expandClass)?t.hideBlock():t.expandBlock()})},hideBlock:function(){var t=document.querySelector(".getchat-widget__btn--icon").children[0];this.block.classList.remove(this.expandClass),t.className="getchat-widget__icon--expand"},expandBlock:function(){var t=document.querySelector(".getchat-widget__btn--icon").children[0];this.block.classList.add(this.expandClass),t.className="getchat-widget__icon--close"},loadWidgetData:function(){var t="http://localhost:3000/api/the-bot/widget/".concat(this.hash,"/data");return new Promise(function(e,n){return fetch(t,{method:"GET",credentials:"omit",headers:{"Content-Type":"application/json"},mode:"cors",cache:"no-cache",dataType:"jsonp"}).then(function(t){return 200===t.status?t.json():((0,r.showError)("[Ошибка] ".concat(t.statusText)),{})}).then(function(t){return e(t)}).catch(function(t){(0,r.showError)(t),n(t)})})}};e.default=h,t.exports=e.default},function(t,e,n){var i,o,r,s;function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}s=function(){function t(t){this._targetElement=t,this._introItems=[],this._options={highlightClass:"",exitOnEsc:!0,exitOnOverlayClick:!0,keyboardNavigation:!1,scrollToElement:!0,scrollTo:"element",scrollPadding:30,overlayOpacity:.9,positionPrecedence:["bottom","top","right","left"],disableInteraction:!1,helperElementPadding:0,buttonClass:"introjs-button"}}function e(t,e){var s=[],c=function t(e){if(null===e||"object"!==a(e)||void 0!==e.nodeType)return e;var n={};for(var i in e)void 0!==window.jQuery&&e[i]instanceof window.jQuery?n[i]=e[i]:n[i]=t(e[i]);return n}(e);if(c.step=s.length+1,"string"==typeof c.element&&(c.element=document.querySelector(c.element)),void 0===c.element||null===c.element){var l=document.querySelector(".introjsFloatingElement");null===l&&((l=document.createElement("div")).className="introjsFloatingElement",document.body.appendChild(l)),c.element=l,c.position="floating"}return c.scrollTo=c.scrollTo||this._options.scrollTo,void 0===c.disableInteraction&&(c.disableInteraction=this._options.disableInteraction),null!==c.element&&(s=[c]),this._introItems=s,function(t){var e=document.createElement("div"),n="",i=this;if(e.className="introjs-overlay",t.tagName&&"body"!==t.tagName.toLowerCase()){var o=y(t);o&&(n+="width: "+o.width+"px; height:"+o.height+"px; top:"+o.top+"px;left: "+o.left+"px;",e.style.cssText=n)}else n+="top: 0;bottom: 0; left: 0;right: 0;position: fixed;",e.style.cssText=n;return t.appendChild(e),e.onclick=function(){!0===i._options.exitOnOverlayClick&&r.call(i,t)},window.setTimeout(function(){n+="opacity: "+i._options.overlayOpacity.toString()+";",e.style.cssText=n},10),!0}.call(this,t)&&(o.call(this),this._options.keyboardNavigation&&f.on(window,"keydown",i,this,!0),f.on(window,"resize",n,this,!0)),!1}function n(){this.refresh.call(this)}function i(t){var e=null===t.code?t.which:t.code;null===e&&(e=null===t.charCode?t.keyCode:t.charCode),"Escape"!==e&&27!==e||!0!==this._options.exitOnEsc||r.call(this,this._targetElement)}function o(){this._direction="forward",void 0!==this._currentStepNumber&&h(this._introItems,function(t,e){t.step===this._currentStepNumber&&(this._currentStep=e-1,this._currentStepNumber=void 0)}.bind(this)),void 0===this._currentStep?this._currentStep=0:++this._currentStep;var t=this._introItems[0],e=!0;return void 0!==this._introBeforeChangeCallback&&(e=this._introBeforeChangeCallback.call(this,t.element)),!1===e?(--this._currentStep,!1):this._introItems.length<=this._currentStep?("function"==typeof this._introCompleteCallback&&this._introCompleteCallback.call(this),void r.call(this,this._targetElement)):void function(t){void 0!==this._introChangeCallback&&this._introChangeCallback.call(this,t.element);var e,n=this,i=document.querySelector(".introjs-helperLayer"),o=document.querySelector(".introjs-tooltipReferenceLayer"),r="introjs-helperLayer";"string"==typeof t.highlightClass&&(r+=" "+t.highlightClass);"string"==typeof this._options.highlightClass&&(r+=" "+this._options.highlightClass);if(null!==i){(e=b(t.element))!==document.body&&_(e,t.element),s.call(n,i),s.call(n,o);var a=document.querySelectorAll(".introjs-fixParent");h(a,function(t){m(t,/introjs-fixParent/g)}),l(),n._lastShowElementTimer&&window.clearTimeout(n._lastShowElementTimer),n._lastShowElementTimer=window.setTimeout(function(){c.call(n,t.scrollTo,t)},350)}else{var u=document.createElement("div"),d=document.createElement("div");u.className=r,d.className="introjs-tooltipReferenceLayer",(e=b(t.element))!==document.body&&_(e,t.element),s.call(n,u),s.call(n,d),this._targetElement.appendChild(u),this._targetElement.appendChild(d),c.call(this,t.scrollTo,t)}var f=n._targetElement.querySelector(".introjs-disableInteraction");f&&f.parentNode.removeChild(f);t.disableInteraction&&function(){var t=document.querySelector(".introjs-disableInteraction");null===t&&((t=document.createElement("div")).className="introjs-disableInteraction",this._targetElement.appendChild(t));s.call(this,t)}.call(n);(function(t){var e;if(t.element instanceof SVGElement)for(e=t.element.parentNode;null!==t.element.parentNode&&e.tagName&&"body"!==e.tagName.toLowerCase();)"svg"===e.tagName.toLowerCase()&&p(e,"introjs-showElement introjs-relativePosition"),e=e.parentNode;p(t.element,"introjs-showElement");var n=v(t.element,"position");for("absolute"!==n&&"relative"!==n&&"fixed"!==n&&p(t.element,"introjs-relativePosition"),e=t.element.parentNode;null!==e&&e.tagName&&"body"!==e.tagName.toLowerCase();){var i=v(e,"z-index"),o=parseFloat(v(e,"opacity")),r=v(e,"transform")||v(e,"-webkit-transform")||v(e,"-moz-transform")||v(e,"-ms-transform")||v(e,"-o-transform");(/[0-9]+/.test(i)||o<1||"none"!==r&&void 0!==r)&&p(e,"introjs-fixParent"),e=e.parentNode}})(t),void 0!==this._introAfterChangeCallback&&this._introAfterChangeCallback.call(this,t.element)}.call(this,t)}function r(t,e){var o=!0;if(void 0!==this._introBeforeExitCallback&&(o=this._introBeforeExitCallback.call(this)),e||!1!==o){var r=t.querySelectorAll(".introjs-overlay");r&&r.length&&h(r,function(t){t.style.opacity=0,window.setTimeout(function(){this.parentNode&&this.parentNode.removeChild(this)}.bind(t),500)}.bind(this));var s=t.querySelector(".introjs-helperLayer");s&&s.parentNode.removeChild(s);var a=t.querySelector(".introjs-tooltipReferenceLayer");a&&a.parentNode.removeChild(a);var c=t.querySelector(".introjs-disableInteraction");c&&c.parentNode.removeChild(c);var u=document.querySelector(".introjsFloatingElement");u&&u.parentNode.removeChild(u),l(),h(document.querySelectorAll(".introjs-fixParent"),function(t){m(t,/introjs-fixParent/g)}),f.off(window,"keydown",i,this,!0),f.off(window,"resize",n,this,!0),void 0!==this._introExitCallback&&this._introExitCallback.call(this),this._currentStep=void 0}}function s(t){var e=this;if(t){if(!this._introItems[this._currentStep])return;var n=this._introItems[this._currentStep],i=y(n.element),o=this._options.helperElementPadding;!function t(e){var n=e.parentNode;if(!n||"HTML"===n.nodeName)return!1;if("fixed"===v(e,"position"))return!0;return t(n)}(n.element)?m(t,"introjs-fixedTooltip"):p(t,"introjs-fixedTooltip"),"floating"===n.position&&(o=0),t.style.cssText="width: "+(i.width+o)+"px; height:"+(i.height+o)+"px; top:"+(i.top-o/2)+"px;left: "+(i.left-o/2)+"px;",window.setTimeout(function(){(function(t){var e=this._introItems[0],n=document.querySelector(".introjs-overlay");if(e.fixed){var i=function(t){return{width:t.offsetWidth,height:t.offsetHeight,left:t.offsetLeft,top:t.offsetTop}}.call(this,t),o=i.width,r=i.height,s=i.left,a=i.top,c=[{x:"0%",y:"0%"},{x:"0%",y:"100%"},{x:s+"px",y:"100%"},{x:s+"px",y:a+"px"},{x:s+o+"px",y:a+"px"},{x:s+o+"px",y:a+r+"px"},{x:s+"px",y:a+r+"px"},{x:s+"px",y:"100%"},{x:"100%",y:"100%"},{x:"100%",y:"0%"}];n&&(n.style.clipPath="polygon(".concat(c.map(function(t){var e=t.x,n=t.y;return e+" "+n}).join(", "),")")),t.style.visibility="hidden"}else n.style.clipPath="",t.style.visibility="visible"}).call(e,t)},35)}}function c(t,e){var n;if("off"!==t&&(this._options.scrollToElement&&(n=e.element.getBoundingClientRect(),!function(t){var e=t.getBoundingClientRect();return e.top>=0&&e.left>=0&&e.bottom+80<=window.innerHeight&&e.right<=window.innerWidth}(e.element)))){var i=g().height;n.bottom-(n.bottom-n.top)<0||e.element.clientHeight>i?window.scrollBy(0,n.top-(i/2-n.height/2)-this._options.scrollPadding):window.scrollBy(0,n.top-(i/2-n.height/2)+this._options.scrollPadding)}}function l(){h(document.querySelectorAll(".introjs-showElement"),function(t){m(t,/introjs-[a-zA-Z]+/g)})}function h(t,e,n){if(t)for(var i=0,o=t.length;i<o;i++)e(t[i],i);"function"==typeof n&&n()}var u,d=(u={},function(t,e){return u[e=e||"introjs-stamp"]=u[e]||0,void 0===t[e]&&(t[e]=u[e]++),t[e]}),f=function(){return new function(){var t="introjs_event";this._id=function(t,e,n,i){return e+d(n)+(i?"_"+d(i):"")},this.on=function(e,n,i,o,r){var s=this._id.apply(this,arguments),a=function(t){return i.call(o||e,t||window.event)};"addEventListener"in e?e.addEventListener(n,a,r):"attachEvent"in e&&e.attachEvent("on"+n,a),e[t]=e[t]||{},e[t][s]=a},this.off=function(e,n,i,o,r){var s=this._id.apply(this,arguments),a=e[t]&&e[t][s];a&&("removeEventListener"in e?e.removeEventListener(n,a,r):"detachEvent"in e&&e.detachEvent("on"+n,a),e[t][s]=null)}}}();function p(t,e){if(t instanceof SVGElement){var n=t.getAttribute("class")||"";t.setAttribute("class",n+" "+e)}else{if(void 0!==t.classList)h(e.split(" "),function(e){t.classList.add(e)});else t.className.match(e)||(t.className+=" "+e)}}function m(t,e){if(t instanceof SVGElement){var n=t.getAttribute("class")||"";t.setAttribute("class",n.replace(e,"").replace(/^\s+|\s+$/g,""))}else t.className=t.className.replace(e,"").replace(/^\s+|\s+$/g,"")}function v(t,e){var n="";return t.currentStyle?n=t.currentStyle[e]:document.defaultView&&document.defaultView.getComputedStyle&&(n=document.defaultView.getComputedStyle(t,null).getPropertyValue(e)),n&&n.toLowerCase?n.toLowerCase():n}function g(){if(void 0!==window.innerWidth)return{width:window.innerWidth,height:window.innerHeight};var t=document.documentElement;return{width:t.clientWidth,height:t.clientHeight}}function y(t){var e=document.body,n=document.documentElement,i=window.pageYOffset||n.scrollTop||e.scrollTop,o=window.pageXOffset||n.scrollLeft||e.scrollLeft,r=t.getBoundingClientRect();return{top:r.top+i,width:r.width,height:r.height,left:r.left+o}}function b(t){var e=window.getComputedStyle(t),n="absolute"===e.position,i=/(auto|scroll)/;if("fixed"===e.position)return document.body;for(var o=t;o=o.parentElement;)if(e=window.getComputedStyle(o),(!n||"static"!==e.position)&&i.test(e.overflow+e.overflowY+e.overflowX))return o;return document.body}function _(t,e){t.scrollTop=e.offsetTop-t.offsetTop}var w=function e(n){var i;if("object"===a(n))i=new t(n);else if("string"==typeof n){var o=document.querySelector(n);if(!o)throw new Error("There is no element with given selector.");i=new t(o)}else i=new t(document.body);return e.instances[d(i,"introjs-instance")]=i,i};return w.version="2.9.3",w.instances={},w.fn=t.prototype={clone:function(){return new t(this)},setOption:function(t,e){return this._options[t]=e,this},setOptions:function(t){return this._options=function(t,e){var n,i={};for(n in t)i[n]=t[n];for(n in e)i[n]=e[n];return i}(this._options,t),this},start:function(t){return e.call(this,this._targetElement,t),this},goToStep:function(t){return function(t){this._currentStep=t-2,void 0!==this._introItems&&o.call(this)}.call(this,t),this},addStep:function(t){return this._options.steps||(this._options.steps=[]),this._options.steps.push(t),this},goToStepNumber:function(t){return function(t){this._currentStepNumber=t,void 0!==this._introItems&&o.call(this)}.call(this,t),this},nextStep:function(){return o.call(this),this},exit:function(t){return r.call(this,this._targetElement,t),this},refresh:function(){return function(){return s.call(this,document.querySelector(".introjs-helperLayer")),s.call(this,document.querySelector(".introjs-tooltipReferenceLayer")),s.call(this,document.querySelector(".introjs-disableInteraction")),this}.call(this),this},onbeforechange:function(t){if("function"!=typeof t)throw new Error("Provided callback for onbeforechange was not a function");return this._introBeforeChangeCallback=t,this},onchange:function(t){if("function"!=typeof t)throw new Error("Provided callback for onchange was not a function.");return this._introChangeCallback=t,this},onafterchange:function(t){if("function"!=typeof t)throw new Error("Provided callback for onafterchange was not a function");return this._introAfterChangeCallback=t,this},oncomplete:function(t){if("function"!=typeof t)throw new Error("Provided callback for oncomplete was not a function.");return this._introCompleteCallback=t,this},onexit:function(t){if("function"!=typeof t)throw new Error("Provided callback for onexit was not a function.");return this._introExitCallback=t,this},onbeforeexit:function(t){if("function"!=typeof t)throw new Error("Provided callback for onbeforeexit was not a function.");return this._introBeforeExitCallback=t,this}},w},"object"===a(e)&&void 0!==t?(t.exports=s(),t.exports.introJs=function(){return console.warn('Deprecated: please use require("intro.js") directly, instead of the introJs method of the function'),s().apply(this,arguments)}):(o=[],void 0===(r="function"==typeof(i=s)?i.apply(e,o):i)||(t.exports=r))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.__isNativeEvent=r,e.default=void 0;var i=n(0);function o(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function r(t){return["click","mouseover","mouseout","keyup","keypress","change","focus","submit"].indexOf(t)>-1}var s=function(){function t(e){var n=e.listener_id,i=e.selector,o=e.event,r=e.attributeName;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.__tourObject=null,this.listener_id=n,this.selector=i,this.event=o,this.attributeName=r}var e,n,s;return e=t,(n=[{key:"init",value:function(){var t=this;if(null!=this.tourJs){var e=!1,n=this.event,o={attributes:!0,childList:!0,characterData:!1},s=document.querySelector(this.selector);if(r(n))"click"===n?(this.callback=this.nativeClickListener.bind(this),document.addEventListener(n,this.callback,!1)):null!=s?(this.callback=this.nativeEventListener.bind(this),s.addEventListener(n,this.callback,!1)):null==s&&(0,i.showError)("Ошибка: Элемент отсутствует в DOM");else if(s||(s=document.body,o.subtree=!0,e=!0),!1===e){var a,c;switch(n){case"show":c=this.IntersectionShowCallback;break;case"hide":c=this.IntersectionHideCallback;break;case"class_change":c=this.classChangeCallback;break;case"attr_change":c=this.attributeChangeCallback;break;case"text_change":o=Object.assign(o,{subtree:!0,characterData:!0,attributeOldValue:!0,characterDataOldValue:!0}),c=this.characterDataChangeCallback;break;case"children_change":o.subtree=!0,c=this.childrenChangeCallback;break;default:return void(0,i.showError)("Не попал под условия: ".concat(this.selector," - ").concat(n))}if("function"!=typeof c)return void(0,i.showError)("Callback функция не определена!");a=["show","hide"].indexOf(n)>-1?new IntersectionObserver(function(t,e){t.forEach(c.bind(e))}):new MutationObserver(function(t,e){t.forEach(c.bind(e))}),this.tourJs.__observers[this.listener_id]=a,a.observe(s,o)}else{var l=new MutationObserver(function(e,o){switch(n){case"show":e.forEach(t.showCallback.bind(o));break;case"hide":e.forEach(t.hideCallback.bind(o));break;default:(0,i.showError)("Не попал под условия: ".concat(t.selector," - ").concat(t.event)),t.disconnectListener()}});this.tourJs.__observers[this.listener_id]=l,l.observe(s,o)}}else(0,i.showError)("Сперва задайте значение tourJs")}},{key:"disconnectListener",value:function(){var t=this.tourJs.__observers[this.listener_id];t?t.disconnect():(0,i.showError)("Listener с id ".concat(this.listener_id," не найден"))}},{key:"sendMessage",value:function(){this.tourJs.sendMessage({listener_id:this.listener_id})}},{key:"nativeEventListener",value:function(t){t.target.matches(this.selector)&&(this.sendMessage(),t.target.removeEventListener(this.event,this.callback,!1))}},{key:"nativeClickListener",value:function(t){t.target.matches(this.selector)&&(this.sendMessage(),t.target.removeEventListener(this.event,this.callback,!1))}},{key:"IntersectionShowCallback",value:function(t){this.isIntersecting&&(t.sendMessage(),t.disconnectListener())}},{key:"IntersectionHideCallback",value:function(t){0===this.intersectionRatio&&!1===this.isIntersecting&&(t.sendMessage(),t.disconnectListener())}},{key:"showCallback",value:function(t){if("childList"===this.type&&this.addedNodes.length>0){var e=document.querySelector(t.selector);if(this.addedNodes[0].isSameNode(e))return t.sendMessage(),t.disconnectListener()}return!1}},{key:"hideCallback",value:function(t){if("childList"===this.type&&this.removedNodes.length>0){var e=this.removedNodes[0];if(1===e.nodeType&&e.matches(t.selector))return t.sendMessage(),t.disconnectListener()}return!1}},{key:"classChangeCallback",value:function(t){return"attributes"===this.type&&"class"===this.attributeName&&(t.sendMessage(),t.disconnectListener())}},{key:"attributeChangeCallback",value:function(t){return"attributes"===this.type&&this.attributeName===t.attributeName&&(t.sendMessage(),t.disconnectListener())}},{key:"characterDataChangeCallback",value:function(t){"characterData"!==this.type&&"childList"!==this.type||(t.sendMessage(),t.disconnectListener())}},{key:"childrenChangeCallback",value:function(t){"childList"===this.type&&(t.sendMessage(),t.disconnectListener())}},{key:"tourJs",get:function(){return this.__tourObject},set:function(t){this.__tourObject=t}}])&&o(e.prototype,n),s&&o(e,s),t}();e.default=s}])});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9nZXR0b3VyL3dlYnBhY2svdW5pdmVyc2FsTW9kdWxlRGVmaW5pdGlvbiIsIndlYnBhY2s6Ly9nZXR0b3VyL3dlYnBhY2svYm9vdHN0cmFwIiwid2VicGFjazovL2dldHRvdXIvLi9zcmMvdXRpbHMuanMiLCJ3ZWJwYWNrOi8vZ2V0dG91ci8uL3NyYy9pbmRleC5qcyIsIndlYnBhY2s6Ly9nZXR0b3VyLy4vc3JjL2ludHJvLWNoYXQuanMiLCJ3ZWJwYWNrOi8vZ2V0dG91ci8uL3NyYy9DaGFuZ2VzTGlzdGVuZXIuanMiXSwibmFtZXMiOlsicm9vdCIsImZhY3RvcnkiLCJleHBvcnRzIiwibW9kdWxlIiwiZGVmaW5lIiwiYW1kIiwic2VsZiIsInRoaXMiLCJpbnN0YWxsZWRNb2R1bGVzIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiaSIsImwiLCJtb2R1bGVzIiwiY2FsbCIsIm0iLCJjIiwiZCIsIm5hbWUiLCJnZXR0ZXIiLCJvIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJlbnVtZXJhYmxlIiwiZ2V0IiwiciIsIlN5bWJvbCIsInRvU3RyaW5nVGFnIiwidmFsdWUiLCJ0IiwibW9kZSIsIl9fZXNNb2R1bGUiLCJucyIsImNyZWF0ZSIsImtleSIsImJpbmQiLCJuIiwib2JqZWN0IiwicHJvcGVydHkiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsInAiLCJzIiwic2hvd0Vycm9yIiwibXNnIiwiY29uc29sZSIsImVycm9yIiwibG9hZENzcyIsInBhdGgiLCJoZWFkIiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50c0J5VGFnTmFtZSIsImxpbmsiLCJjcmVhdGVFbGVtZW50IiwicmVsIiwidHlwZSIsImhyZWYiLCJhcHBlbmRDaGlsZCIsIl9pbnRyb0NoYXQiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwiX0NoYW5nZXNMaXN0ZW5lciIsIl91dGlscyIsImlzQW55UGFydE9mRWxlbWVudEluVmlld3BvcnQiLCJlbCIsInNjcm9sbCIsIndpbmRvdyIsInNjcm9sbFkiLCJwYWdlWU9mZnNldCIsImJvdW5kc1RvcCIsImdldEJvdW5kaW5nQ2xpZW50UmVjdCIsInRvcCIsInZpZXdwb3J0IiwiaW5uZXJIZWlnaHQiLCJib3VuZHMiLCJjbGllbnRIZWlnaHQiLCJpc01lc3NhZ2VGcm9tV2lkZ2V0IiwiZXZlbnQiLCJvcmlnaW4iLCJpbmRleE9mIiwiX3R5cGVvZiIsImRhdGEiLCJzb3VyY2UiLCJzdHlsZXNGaWxlUGF0aCIsInNlbGVjdG9yIiwiZXhwYW5kQ2xhc3MiLCJhY3RpdmUiLCJfX2ludHJvIiwid2lkZ2V0SGFzaCIsImF1dG9TaG93Q29uZGl0aW9ucyIsImhhc2giLCJkb21haW4iLCJibG9jayIsInNldE9wdGlvbnMiLCJfcmVmIiwib3B0aW9ucyIsImNvbmZpZyIsInN0eWxlc0xvYWRlZCIsIl9fb2JzZXJ2ZXJzIiwiaW5pdCIsIl90aGlzIiwibG9hZFdpZGdldERhdGEiLCJ0aGVuIiwid2lkZ2V0X2FjdGl2ZSIsImNvbmRpdGlvbnMiLCJsb2NhdGlvbiIsImhvc3QiLCJkZWZhdWx0Iiwib25jaGFuZ2UiLCJyZWZyZXNoIiwib25iZWZvcmVjaGFuZ2UiLCJfaW50cm9JdGVtcyIsImxlbmd0aCIsInN0ZXAiLCJjbG9zZUJ0biIsInF1ZXJ5U2VsZWN0b3IiLCJzdHlsZSIsImRpc3BsYXkiLCJvbmV4aXQiLCJhZGRFdmVudExpc3RlbmVyIiwiX19saXN0ZW5Gb3JIaWdobGlnaHRSZXF1ZXN0cyIsIl9fbGlzdGVuRm9yQWN0aW9uQ2xpY2tlZFJlcXVlc3RzIiwiX19saXN0ZW5Gb3JPYnNlcnZlUmVxdWVzdHMiLCJsb2FkQ29uZGl0aW9uIiwibGlzdGVuRm9yTG9jYXRpb25DaGFuZ2UiLCJfdGhpczIiLCJmb3JFYWNoIiwiY29uZCIsIlJlZ0V4cCIsInVybFJlZ2V4IiwidGVzdCIsInBhdGhuYW1lIiwic2V0VGltZW91dCIsInJlbmRlcldpZGdldCIsInNyYyIsImxvYWRTdHlsZXMiLCJpbml0RXZlbnRMaXN0ZW5lcnMiLCJ0aW1lSW50ZXJ2YWwiLCJmIiwiX3RoaXMzIiwiaGlzdG9yeSIsInB1c2hTdGF0ZSIsInJldCIsImFwcGx5IiwiYXJndW1lbnRzIiwiZGlzcGF0Y2hFdmVudCIsIkV2ZW50IiwicmVwbGFjZVN0YXRlIiwicmVzZXQiLCJlIiwiYWN0aW9uIiwiYW5zd2VyX2lkIiwiX29wdGlvbnMiLCJzdGVwcyIsImhpZ2hsaWdodEV2ZW50QW5zd2VySWQiLCJleGl0IiwibGlzdGVuZXIiLCJ0b3VySnMiLCJoaWdobGlnaHQiLCJfX2dldEVsZW1lbnRGb3JIaWdobGlnaHQiLCJlbGVtZW50cyIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJBcnJheSIsImZyb20iLCJmaW5kIiwiX3JlZjIiLCJfdGhpczQiLCJjbG9zZUV2ZW50IiwiZWxlbWVudCIsImZpeGVkIiwiaW50cm9FbGVtZW50IiwiZXhpdE9uRXNjIiwiZXhpdE9uT3ZlcmxheUNsaWNrIiwiZGlzYWJsZUludGVyYWN0aW9uIiwiYWRkU3RlcCIsIm9uY2UiLCJnb1RvU3RlcE51bWJlciIsInN0YXJ0Iiwic2VuZE1lc3NhZ2UiLCJpZnJhbWUiLCJjb250ZW50V2luZG93IiwicG9zdE1lc3NhZ2UiLCJhc3NpZ24iLCJkZXN0cm95V2lkZ2V0IiwicmVtb3ZlIiwid2lkZ2V0VXJsIiwiY2xhc3NOYW1lIiwid2lkZ2V0SHRtbCIsImNvbmNhdCIsImlubmVySFRNTCIsImJvZHkiLCJfdGhpczUiLCJjbGFzc0xpc3QiLCJjb250YWlucyIsImhpZGVCbG9jayIsImV4cGFuZEJsb2NrIiwiJGljb24iLCJjaGlsZHJlbiIsImFkZCIsInVybCIsIlByb21pc2UiLCJyZXNvbHZlIiwicmVqZWN0IiwiZmV0Y2giLCJtZXRob2QiLCJjcmVkZW50aWFscyIsImhlYWRlcnMiLCJDb250ZW50LVR5cGUiLCJjYWNoZSIsImRhdGFUeXBlIiwicmVzIiwic3RhdHVzIiwianNvbiIsInN0YXR1c1RleHQiLCJyZXNwb25zZSIsImNhdGNoIiwiSW50cm9KcyIsIm9iaiIsIl90YXJnZXRFbGVtZW50IiwiaGlnaGxpZ2h0Q2xhc3MiLCJrZXlib2FyZE5hdmlnYXRpb24iLCJzY3JvbGxUb0VsZW1lbnQiLCJzY3JvbGxUbyIsInNjcm9sbFBhZGRpbmciLCJvdmVybGF5T3BhY2l0eSIsInBvc2l0aW9uUHJlY2VkZW5jZSIsImhlbHBlckVsZW1lbnRQYWRkaW5nIiwiYnV0dG9uQ2xhc3MiLCJfaW50cm9Gb3JFbGVtZW50IiwidGFyZ2V0RWxtIiwiaW50cm9JdGVtcyIsImN1cnJlbnRJdGVtIiwiX2Nsb25lT2JqZWN0Iiwibm9kZVR5cGUiLCJ0ZW1wIiwialF1ZXJ5IiwiZmxvYXRpbmdFbGVtZW50UXVlcnkiLCJwb3NpdGlvbiIsIm92ZXJsYXlMYXllciIsInN0eWxlVGV4dCIsInRhZ05hbWUiLCJ0b0xvd2VyQ2FzZSIsImVsZW1lbnRQb3NpdGlvbiIsIl9nZXRPZmZzZXQiLCJ3aWR0aCIsImhlaWdodCIsImxlZnQiLCJjc3NUZXh0Iiwib25jbGljayIsIl9leGl0SW50cm8iLCJ0b1N0cmluZyIsIl9uZXh0U3RlcCIsIkRPTUV2ZW50Iiwib24iLCJfb25LZXlEb3duIiwiX29uUmVzaXplIiwiY29kZSIsIndoaWNoIiwiY2hhckNvZGUiLCJrZXlDb2RlIiwiX2RpcmVjdGlvbiIsIl9jdXJyZW50U3RlcE51bWJlciIsIl9mb3JFYWNoIiwiaXRlbSIsIl9jdXJyZW50U3RlcCIsInVuZGVmaW5lZCIsIm5leHRTdGVwIiwiY29udGludWVTdGVwIiwiX2ludHJvQmVmb3JlQ2hhbmdlQ2FsbGJhY2siLCJfaW50cm9Db21wbGV0ZUNhbGxiYWNrIiwidGFyZ2V0RWxlbWVudCIsIl9pbnRyb0NoYW5nZUNhbGxiYWNrIiwic2Nyb2xsUGFyZW50Iiwib2xkSGVscGVyTGF5ZXIiLCJvbGRSZWZlcmVuY2VMYXllciIsIl9nZXRTY3JvbGxQYXJlbnQiLCJfc2Nyb2xsUGFyZW50VG9FbGVtZW50IiwiX3NldEhlbHBlckxheWVyUG9zaXRpb24iLCJmaXhQYXJlbnRzIiwicGFyZW50IiwiX3JlbW92ZUNsYXNzIiwiX3JlbW92ZVNob3dFbGVtZW50IiwiX2xhc3RTaG93RWxlbWVudFRpbWVyIiwiY2xlYXJUaW1lb3V0IiwiX3Njcm9sbFRvIiwiaGVscGVyTGF5ZXIiLCJyZWZlcmVuY2VMYXllciIsImRpc2FibGVJbnRlcmFjdGlvbkxheWVyIiwicGFyZW50Tm9kZSIsInJlbW92ZUNoaWxkIiwicGFyZW50RWxtIiwiU1ZHRWxlbWVudCIsIl9hZGRDbGFzcyIsImN1cnJlbnRFbGVtZW50UG9zaXRpb24iLCJfZ2V0UHJvcFZhbHVlIiwiekluZGV4Iiwib3BhY2l0eSIsInBhcnNlRmxvYXQiLCJ0cmFuc2Zvcm0iLCJfc2V0U2hvd0VsZW1lbnQiLCJfaW50cm9BZnRlckNoYW5nZUNhbGxiYWNrIiwiZm9yY2UiLCJjb250aW51ZUV4aXQiLCJfaW50cm9CZWZvcmVFeGl0Q2FsbGJhY2siLCJvdmVybGF5TGF5ZXJzIiwiZmxvYXRpbmdFbGVtZW50Iiwib2ZmIiwiX2ludHJvRXhpdENhbGxiYWNrIiwiY3VycmVudEVsZW1lbnQiLCJ3aWR0aEhlaWdodFBhZGRpbmciLCJfaXNGaXhlZCIsIm5vZGVOYW1lIiwib3ZlcmxheSIsIl9nZXREaW1lbnNpb25zJGNhbGwiLCJoZWxwZXIiLCJvZmZzZXRXaWR0aCIsIm9mZnNldEhlaWdodCIsIm9mZnNldExlZnQiLCJvZmZzZXRUb3AiLCJjb29yZHMiLCJ4IiwieSIsImNsaXBQYXRoIiwibWFwIiwiam9pbiIsInZpc2liaWxpdHkiLCJyZWN0IiwiYm90dG9tIiwicmlnaHQiLCJpbm5lcldpZHRoIiwiX2VsZW1lbnRJblZpZXdwb3J0Iiwid2luSGVpZ2h0IiwiX2dldFdpblNpemUiLCJzY3JvbGxCeSIsImVsbSIsImFyciIsImZvckVhY2hGbmMiLCJjb21wbGV0ZUZuYyIsImxlbiIsImtleXMiLCJfc3RhbXAiLCJldmVudHNfa2V5IiwiX2lkIiwiY29udGV4dCIsInVzZUNhcHR1cmUiLCJpZCIsImhhbmRsZXIiLCJhdHRhY2hFdmVudCIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJkZXRhY2hFdmVudCIsInByZSIsImdldEF0dHJpYnV0ZSIsInNldEF0dHJpYnV0ZSIsInNwbGl0IiwiY2xzIiwibWF0Y2giLCJjbGFzc05hbWVSZWdleCIsInJlcGxhY2UiLCJwcm9wTmFtZSIsInByb3BWYWx1ZSIsImN1cnJlbnRTdHlsZSIsImRlZmF1bHRWaWV3IiwiZ2V0Q29tcHV0ZWRTdHlsZSIsImdldFByb3BlcnR5VmFsdWUiLCJEIiwiZG9jdW1lbnRFbGVtZW50IiwiY2xpZW50V2lkdGgiLCJkb2NFbCIsInNjcm9sbFRvcCIsInNjcm9sbExlZnQiLCJwYWdlWE9mZnNldCIsImV4Y2x1ZGVTdGF0aWNQYXJlbnQiLCJvdmVyZmxvd1JlZ2V4IiwicGFyZW50RWxlbWVudCIsIm92ZXJmbG93Iiwib3ZlcmZsb3dZIiwib3ZlcmZsb3dYIiwiaW50cm9KcyIsImluc3RhbmNlIiwiRXJyb3IiLCJpbnN0YW5jZXMiLCJ2ZXJzaW9uIiwiZm4iLCJjbG9uZSIsInNldE9wdGlvbiIsIm9wdGlvbiIsIm9iajEiLCJvYmoyIiwiYXR0cm5hbWUiLCJvYmozIiwiX21lcmdlT3B0aW9ucyIsImdvVG9TdGVwIiwicHVzaCIsInByb3ZpZGVkQ2FsbGJhY2siLCJvbmFmdGVyY2hhbmdlIiwib25jb21wbGV0ZSIsIm9uYmVmb3JlZXhpdCIsIndhcm4iLCJfX1dFQlBBQ0tfQU1EX0RFRklORV9SRVNVTFRfXyIsIl9fV0VCUEFDS19BTURfREVGSU5FX0ZBQ1RPUllfXyIsIl9fV0VCUEFDS19BTURfREVGSU5FX0FSUkFZX18iLCJfX2lzTmF0aXZlRXZlbnQiLCJDaGFuZ2VzTGlzdGVuZXIiLCJsaXN0ZW5lcl9pZCIsImF0dHJpYnV0ZU5hbWUiLCJfY2xhc3NDYWxsQ2hlY2siLCJfX3RvdXJPYmplY3QiLCJpc0JvZHkiLCJhdHRyaWJ1dGVzIiwiY2hpbGRMaXN0IiwiY2hhcmFjdGVyRGF0YSIsInRhcmdldCIsImNhbGxiYWNrIiwibmF0aXZlQ2xpY2tMaXN0ZW5lciIsIm5hdGl2ZUV2ZW50TGlzdGVuZXIiLCJzdWJ0cmVlIiwib2JzZXJ2ZXIiLCJJbnRlcnNlY3Rpb25TaG93Q2FsbGJhY2siLCJJbnRlcnNlY3Rpb25IaWRlQ2FsbGJhY2siLCJjbGFzc0NoYW5nZUNhbGxiYWNrIiwiYXR0cmlidXRlQ2hhbmdlQ2FsbGJhY2siLCJhdHRyaWJ1dGVPbGRWYWx1ZSIsImNoYXJhY3RlckRhdGFPbGRWYWx1ZSIsImNoYXJhY3RlckRhdGFDaGFuZ2VDYWxsYmFjayIsImNoaWxkcmVuQ2hhbmdlQ2FsbGJhY2siLCJJbnRlcnNlY3Rpb25PYnNlcnZlciIsImVudHJpZXMiLCJNdXRhdGlvbk9ic2VydmVyIiwibXV0YXRpb25zIiwib2JzZXJ2ZSIsInNob3dDYWxsYmFjayIsImhpZGVDYWxsYmFjayIsImRpc2Nvbm5lY3RMaXN0ZW5lciIsImRpc2Nvbm5lY3QiLCJqc0V2ZW50IiwibWF0Y2hlcyIsImNoYW5nZUxpc3RlbmVyIiwiaXNJbnRlcnNlY3RpbmciLCJpbnRlcnNlY3Rpb25SYXRpbyIsImFkZGVkTm9kZXMiLCJpc1NhbWVOb2RlIiwicmVtb3ZlZE5vZGVzIiwibm9kZSIsInZhbCJdLCJtYXBwaW5ncyI6IkNBQUEsU0FBQUEsRUFBQUMsR0FDQSxpQkFBQUMsU0FBQSxpQkFBQUMsT0FDQUEsT0FBQUQsUUFBQUQsSUFDQSxtQkFBQUcsZUFBQUMsSUFDQUQsT0FBQSxhQUFBSCxHQUNBLGlCQUFBQyxRQUNBQSxRQUFBLFFBQUFELElBRUFELEVBQUEsUUFBQUMsSUFSQSxDQVNDLG9CQUFBSyxVQUFBQyxLQUFBLFdBQ0QsbUJDVEEsSUFBQUMsRUFBQSxHQUdBLFNBQUFDLEVBQUFDLEdBR0EsR0FBQUYsRUFBQUUsR0FDQSxPQUFBRixFQUFBRSxHQUFBUixRQUdBLElBQUFDLEVBQUFLLEVBQUFFLEdBQUEsQ0FDQUMsRUFBQUQsRUFDQUUsR0FBQSxFQUNBVixRQUFBLElBVUEsT0FOQVcsRUFBQUgsR0FBQUksS0FBQVgsRUFBQUQsUUFBQUMsSUFBQUQsUUFBQU8sR0FHQU4sRUFBQVMsR0FBQSxFQUdBVCxFQUFBRCxRQTBEQSxPQXJEQU8sRUFBQU0sRUFBQUYsRUFHQUosRUFB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LGFBQWVxQyIsImZpbGUiOiJnZXR0b3VyLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiB3ZWJwYWNrVW5pdmVyc2FsTW9kdWxlRGVmaW5pdGlvbihyb290LCBmYWN0b3J5KSB7XG5cdGlmKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0JyAmJiB0eXBlb2YgbW9kdWxlID09PSAnb2JqZWN0Jylcblx0XHRtb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkoKTtcblx0ZWxzZSBpZih0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQpXG5cdFx0ZGVmaW5lKFwiZ2V0dG91clwiLCBbXSwgZmFjdG9yeSk7XG5cdGVsc2UgaWYodHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnKVxuXHRcdGV4cG9ydHNbXCJnZXR0b3VyXCJdID0gZmFjdG9yeSgpO1xuXHRlbHNlXG5cdFx0cm9vdFtcImdldHRvdXJcIl0gPSBmYWN0b3J5KCk7XG59KSh0eXBlb2Ygc2VsZiAhPT0gJ3VuZGVmaW5lZCcgPyBzZWxmIDogdGhpcywgZnVuY3Rpb24oKSB7XG5yZXR1cm4gIiwiIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcblxuIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbiBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblxuIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbiBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pIHtcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbiBcdFx0fVxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0aTogbW9kdWxlSWQsXG4gXHRcdFx0bDogZmFsc2UsXG4gXHRcdFx0ZXhwb3J0czoge31cbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubCA9IHRydWU7XG5cbiBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbiBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuIFx0fVxuXG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcblxuIFx0Ly8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHtcbiBcdFx0aWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBuYW1lKSkge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZ2V0dGVyIH0pO1xuIFx0XHR9XG4gXHR9O1xuXG4gXHQvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSBmdW5jdGlvbihleHBvcnRzKSB7XG4gXHRcdGlmKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC50b1N0cmluZ1RhZykge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBTeW1ib2wudG9TdHJpbmdUYWcsIHsgdmFsdWU6ICdNb2R1bGUnIH0pO1xuIFx0XHR9XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG4gXHR9O1xuXG4gXHQvLyBjcmVhdGUgYSBmYWtlIG5hbWVzcGFjZSBvYmplY3RcbiBcdC8vIG1vZGUgJiAxOiB2YWx1ZSBpcyBhIG1vZHVsZSBpZCwgcmVxdWlyZSBpdFxuIFx0Ly8gbW9kZSAmIDI6IG1lcmdlIGFsbCBwcm9wZXJ0aWVzIG9mIHZhbHVlIGludG8gdGhlIG5zXG4gXHQvLyBtb2RlICYgNDogcmV0dXJuIHZhbHVlIHdoZW4gYWxyZWFkeSBucyBvYmplY3RcbiBcdC8vIG1vZGUgJiA4fDE6IGJlaGF2ZSBsaWtlIHJlcXVpcmVcbiBcdF9fd2VicGFja19yZXF1aXJlX18udCA9IGZ1bmN0aW9uKHZhbHVlLCBtb2RlKSB7XG4gXHRcdGlmKG1vZGUgJiAxKSB2YWx1ZSA9IF9fd2VicGFja19yZXF1aXJlX18odmFsdWUpO1xuIFx0XHRpZihtb2RlICYgOCkgcmV0dXJuIHZhbHVlO1xuIFx0XHRpZigobW9kZSAmIDQpICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgdmFsdWUgJiYgdmFsdWUuX19lc01vZHVsZSkgcmV0dXJuIHZhbHVlO1xuIFx0XHR2YXIgbnMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIobnMpO1xuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkobnMsICdkZWZhdWx0JywgeyBlbnVtZXJhYmxlOiB0cnVlLCB2YWx1ZTogdmFsdWUgfSk7XG4gXHRcdGlmKG1vZGUgJiAyICYmIHR5cGVvZiB2YWx1ZSAhPSAnc3RyaW5nJykgZm9yKHZhciBrZXkgaW4gdmFsdWUpIF9fd2VicGFja19yZXF1aXJlX18uZChucywga2V5LCBmdW5jdGlvbihrZXkpIHsgcmV0dXJuIHZhbHVlW2tleV07IH0uYmluZChudWxsLCBrZXkpKTtcbiBcdFx0cmV0dXJuIG5zO1xuIFx0fTtcblxuIFx0Ly8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuIFx0XHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cbiBcdFx0XHRmdW5jdGlvbiBnZXREZWZhdWx0KCkgeyByZXR1cm4gbW9kdWxlWydkZWZhdWx0J107IH0gOlxuIFx0XHRcdGZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsICdhJywgZ2V0dGVyKTtcbiBcdFx0cmV0dXJuIGdldHRlcjtcbiBcdH07XG5cbiBcdC8vIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbFxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpOyB9O1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcblxuXG4gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbiBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IDEpO1xuIiwiLyoqXG4gKiDQktGL0LLQvtC0INC+0YjQuNCx0L7QuiDQsiDQutC+0L3RgdC+0LvRjFxuICogQHBhcmFtIHtTdHJpbmd9IG1zZ1xuICovXG5leHBvcnQgZnVuY3Rpb24gc2hvd0Vycm9yKG1zZykge1xuICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tY29uc29sZVxuICBjb25zb2xlLmVycm9yKG1zZyk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBsb2FkQ3NzKHBhdGgpIHtcbiAgY29uc3QgaGVhZCA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCdIRUFEJylbMF07XG4gIGNvbnN0IGxpbmsgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsaW5rJyk7XG5cbiAgbGluay5yZWwgPSAnc3R5bGVzaGVldCc7XG5cbiAgbGluay50eXBlID0gJ3RleHQvY3NzJztcblxuICBsaW5rLmhyZWYgPSBwYXRoO1xuICBoZWFkLmFwcGVuZENoaWxkKGxpbmspO1xufVxuY29uc3QgdXRpbHMgPSB7XG4gIHNob3dFcnJvcixcbiAgbG9hZENzc1xufTtcblxuZXhwb3J0IGRlZmF1bHQgdXRpbHM7XG4iLCIvKiBlc2xpbnQtZGlzYWJsZSBwcmVmZXItcmVzdC1wYXJhbXMgKi9cbi8qIGVzbGludC1kaXNhYmxlIG5vLXVuZGVyc2NvcmUtZGFuZ2xlICovXG4vKiBlc2xpbnQtZGlzYWJsZSBjYW1lbGNhc2UgKi9cbi8qIGdsb2JhbCB3aW5kb3cgKi9cbi8qIGdsb2JhbCBkb2N1bWVudCAqL1xuLyogZ2xvYmFsIGhpc3RvcnkgKi9cbmltcG9ydCBpbnRyb0pzIGZyb20gJy4vaW50cm8tY2hhdCc7XG5cbmltcG9ydCBDaGFuZ2VzTGlzdGVuZXIgZnJvbSAnLi9DaGFuZ2VzTGlzdGVuZXInO1xuaW1wb3J0IHsgc2hvd0Vycm9yLCBsb2FkQ3NzIH0gZnJvbSAnLi91dGlscyc7XG5cbi8qKlxuICogV2FybmluZy4gb3B0aW9ucyAtINGN0YLQviDRgdCy0L7QudGB0YLQviDQvtCx0YrQtdC60YLQsFxuICogQHBhcmFtIHtvYmplY3R9IHBhcmFtMFxuICovXG5mdW5jdGlvbiBzZXRPcHRpb25zKHsgb3B0aW9ucyB9KSB7XG4gIGlmICh0eXBlb2Ygb3B0aW9ucyA9PT0gJ29iamVjdCcpIHtcbiAgICB0aGlzLl9faW50cm8uc2V0T3B0aW9ucyhvcHRpb25zKTtcbiAgfSBlbHNlIHtcbiAgICB0aGlzLl9faW50cm8uc2V0T3B0aW9ucyh0aGlzLmNvbmZpZyk7XG4gIH1cbn1cblxuZnVuY3Rpb24gaXNBbnlQYXJ0T2ZFbGVtZW50SW5WaWV3cG9ydChlbCkge1xuICBjb25zdCBzY3JvbGwgPSB3aW5kb3cuc2Nyb2xsWSB8fCB3aW5kb3cucGFnZVlPZmZzZXQ7XG4gIGNvbnN0IGJvdW5kc1RvcCA9IGVsLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLnRvcCArIHNjcm9sbDtcblxuICBjb25zdCB2aWV3cG9ydCA9IHtcbiAgICB0b3A6IHNjcm9sbCxcbiAgICBib3R0b206IHNjcm9sbCArIHdpbmRvdy5pbm5lckhlaWdodFxuICB9O1xuXG4gIGNvbnN0IGJvdW5kcyA9IHtcbiAgICB0b3A6IGJvdW5kc1RvcCxcbiAgICBib3R0b206IGJvdW5kc1RvcCArIGVsLmNsaWVudEhlaWdodFxuICB9O1xuXG4gIHJldHVybiAoXG4gICAgKGJvdW5kcy5ib3R0b20gPj0gdmlld3BvcnQudG9wICYmIGJvdW5kcy5ib3R0b20gPD0gdmlld3BvcnQuYm90dG9tKSB8fFxuICAgIChib3VuZHMudG9wIDw9IHZpZXdwb3J0LmJvdHRvbSAmJiBib3VuZHMudG9wID49IHZpZXdwb3J0LnRvcClcbiAgKTtcbn1cblxuZnVuY3Rpb24gaXNNZXNzYWdlRnJvbVdpZGdldChldmVudCkge1xuICAvLyBJTVBPUlRBTlQ6IENoZWNrIHRoZSBvcmlnaW4gb2YgdGhlIGRhdGEhXG4gIGlmIChldmVudC5vcmlnaW4uaW5kZXhPZignaHR0cHM6Ly9nZXRjaGF0Lm1lJykgfHwgZXZlbnQub3JpZ2luLmluZGV4T2YoJ2h0dHA6Ly9sb2NhbGhvc3Q6MzAwMCcpKSB7XG4gICAgLy8gVGhlIGRhdGEgaGFzIGJlZW4gc2VudCBmcm9tIHlvdXIgc2l0ZVxuXG4gICAgLy8gVGhlIGRhdGEgc2VudCB3aXRoIHBvc3RNZXNzYWdlIGlzIHN0b3JlZCBpbiBldmVudC5kYXRhXG4gICAgaWYgKHR5cGVvZiBldmVudC5kYXRhICE9PSAnb2JqZWN0JyB8fCBldmVudC5kYXRhLnNvdXJjZSAhPT0gJ2dldGNoYXQtd2lkZ2V0Jykge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIHJldHVybiB0cnVlO1xuICB9XG5cbiAgcmV0dXJuIGZhbHNlO1xufVxuXG5jb25zdCBvbmJvYXJkaW5nID0ge1xuICBzdHlsZXNGaWxlUGF0aDogJ2h0dHA6Ly9sb2NhbGhvc3Q6MzAwMC9nZXR0b3VyLXN0eWxlcy5jc3MnLFxuICBzZWxlY3RvcjogJy5nZXRjaGF0LXdpZGdldF9fZnJhbWUnLFxuICBleHBhbmRDbGFzczogJ2dldGNoYXQtd2lkZ2V0LS1leHBhbmRlZCcsXG4gIGFjdGl2ZTogZmFsc2UsXG4gIF9faW50cm86IG51bGwsXG4gIHdpZGdldEhhc2g6IG51bGwsXG4gIGF1dG9TaG93Q29uZGl0aW9uczogW10sXG4gIGhhc2g6IG51bGwsXG4gIGRvbWFpbjogbnVsbCxcbiAgYmxvY2s6IG51bGwsXG4gIHNldE9wdGlvbnMsXG4gIHN0eWxlc0xvYWRlZDogZmFsc2UsXG4gIF9fb2JzZXJ2ZXJzOiB7fSxcblxuICAvKipcbiAgICpcbiAgICogQHBhcmFtIHtzdHJpbmd9IGhhc2hcbiAgICovXG4gIGluaXQoaGFzaCkge1xuICAgIGNvbnN0IHNlbGYgPSB0aGlzO1xuXG4gICAgdGhpcy5oYXNoID0gaGFzaDtcbiAgICB0aGlzLmxvYWRXaWRnZXREYXRhKCkudGhlbihkYXRhID0+IHtcbiAgICAgIHRoaXMuZG9tYWluID0gZGF0YS5kb21haW47XG4gICAgICB0aGlzLmFjdGl2ZSA9IGRhdGEud2lkZ2V0X2FjdGl2ZTtcbiAgICAgIHRoaXMuYXV0b1Nob3dDb25kaXRpb25zID0gZGF0YS5jb25kaXRpb25zO1xuICAgICAgaWYgKHRoaXMuZG9tYWluICE9PSB3aW5kb3cubG9jYXRpb24uaG9zdCkge1xuICAgICAgICBzaG93RXJyb3IoJ1vQntGI0LjQsdC60LBdINCS0LjQtNC20LXRgiDQvdC1INC00LvRjyDRjdGC0L7Qs9C+INC00L7QvNC10L3QsCcpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBpZiAoIXRoaXMuYWN0aXZlKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIHRoaXMuX19pbnRybyA9IGludHJvSnMoKTtcblxuICAgICAgdGhpcy5fX2ludHJvLm9uY2hhbmdlKCgpID0+IHtcbiAgICAgICAgc2VsZi5fX2ludHJvLnJlZnJlc2goKTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICB9KTtcbiAgICAgIHRoaXMuX19pbnRyby5vbmJlZm9yZWNoYW5nZSgoKSA9PiB7XG4gICAgICAgIGlmICh0aGlzLl9faW50cm8uX2ludHJvSXRlbXMubGVuZ3RoKSB7XG4gICAgICAgICAgY29uc3Qgc3RlcCA9IHRoaXMuX19pbnRyby5faW50cm9JdGVtc1swXTtcblxuICAgICAgICAgIHNlbGYuc2V0T3B0aW9ucyhzdGVwKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vXG4gICAgICAgIGNvbnN0IGNsb3NlQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmdldGNoYXQtd2lkZ2V0ID4gLmdldGNoYXQtd2lkZ2V0X19idG4tLWljb24nKTtcblxuICAgICAgICBpZiAoY2xvc2VCdG4pIHtcbiAgICAgICAgICBjbG9zZUJ0bi5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgICAgdGhpcy5fX2ludHJvLm9uZXhpdCgoKSA9PiB7XG4gICAgICAgIGNvbnN0IGNsb3NlQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmdldGNoYXQtd2lkZ2V0ID4gLmdldGNoYXQtd2lkZ2V0X19idG4tLWljb24nKTtcblxuICAgICAgICBpZiAoY2xvc2VCdG4pIHtcbiAgICAgICAgICBjbG9zZUJ0bi5zdHlsZS5kaXNwbGF5ID0gJ2lubGluZS1mbGV4JztcbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgIC8vINCh0LvRg9GI0LDRgtGMINGB0L7QsdGL0YLQuNGPINCy0YvQtNC10LvQtdC90LjRj1xuICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ21lc3NhZ2UnLCBldmVudCA9PiB7XG4gICAgICAgIHRoaXMuX19saXN0ZW5Gb3JIaWdobGlnaHRSZXF1ZXN0cy5jYWxsKHRoaXMsIGV2ZW50KTtcbiAgICAgIH0pO1xuXG4gICAgICAvLyDQodC70YPRiNCw0YLRjCDRgdC+0LHRi9GC0LjRjyDQutC90L7Qv9C+0Log0YfQsNGC0LBcbiAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdtZXNzYWdlJywgZXZlbnQgPT4ge1xuICAgICAgICB0aGlzLl9fbGlzdGVuRm9yQWN0aW9uQ2xpY2tlZFJlcXVlc3RzLmNhbGwodGhpcywgZXZlbnQpO1xuICAgICAgfSk7XG5cbiAgICAgIC8vINCh0LvRg9GI0LDRgtGMINGB0L7QsdGL0YLQuNGPINC00LvRjyBPYnNlcnZlci3QsFxuICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ21lc3NhZ2UnLCBldmVudCA9PiB7XG4gICAgICAgIHRoaXMuX19saXN0ZW5Gb3JPYnNlcnZlUmVxdWVzdHMuY2FsbCh0aGlzLCBldmVudCk7XG4gICAgICB9KTtcblxuICAgICAgdGhpcy5sb2FkQ29uZGl0aW9uKCk7XG5cbiAgICAgIC8vINCh0LvRg9GJ0LDRgtGMINC40LfQvNC10L3QtdC90LjQtSBVUkxcbiAgICAgIHRoaXMubGlzdGVuRm9yTG9jYXRpb25DaGFuZ2UoKTtcbiAgICB9KTtcblxuICAgIHJldHVybiB0aGlzO1xuICB9LFxuICBsb2FkQ29uZGl0aW9uKCkge1xuICAgIHRoaXMuYXV0b1Nob3dDb25kaXRpb25zLmZvckVhY2goY29uZCA9PiB7XG4gICAgICBjb25zdCByZWdleCA9IG5ldyBSZWdFeHAoY29uZC51cmxSZWdleCwgJ2knKTtcblxuICAgICAgaWYgKHJlZ2V4LnRlc3Qod2luZG93LmxvY2F0aW9uLnBhdGhuYW1lKSkge1xuICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICB0aGlzLnJlbmRlcldpZGdldChjb25kLnNyYyk7XG4gICAgICAgICAgaWYgKCF0aGlzLnN0eWxlc0xvYWRlZCkge1xuICAgICAgICAgICAgdGhpcy5sb2FkU3R5bGVzKCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHRoaXMuaW5pdEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgICAgIH0sIGNvbmQudGltZUludGVydmFsICogMTAwMCk7XG4gICAgICB9XG4gICAgfSk7XG4gIH0sXG4gIGxpc3RlbkZvckxvY2F0aW9uQ2hhbmdlKCkge1xuICAgIC8qIFRoaXMgbW9kaWZpZXMgdGhlc2UgdGhyZWUgZnVuY3Rpb25zIHNvIHRoYXQgYWxsIGZpcmVcbiAgICBhIGN1c3RvbSBsb2NhdGlvbmNoYW5nZSBldmVudCBmb3IgeW91IHRvIHVzZSxcbiAgICBhbmQgYWxzbyBwdXNoc3RhdGUgYW5kIHJlcGxhY2VzdGF0ZSBldmVudHMgaWYgeW91IHdhbnQgdG8gdXNlIHRob3NlOlxuICAgIEZyb206IGh0dHBzOi8vc3RhY2tvdmVyZmxvdy5jb20vYS81MjgwOTEwNS8zOTM5ODUzICovXG4gICAgaGlzdG9yeS5wdXNoU3RhdGUgPSAoZiA9PlxuICAgICAgZnVuY3Rpb24gcHVzaFN0YXRlKCkge1xuICAgICAgICBjb25zdCByZXQgPSBmLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG5cbiAgICAgICAgd2luZG93LmRpc3BhdGNoRXZlbnQobmV3IEV2ZW50KCdwdXNoU3RhdGUnKSk7XG4gICAgICAgIHdpbmRvdy5kaXNwYXRjaEV2ZW50KG5ldyBFdmVudCgnbG9jYXRpb25jaGFuZ2UnKSk7XG4gICAgICAgIHJldHVybiByZXQ7XG4gICAgICB9KShoaXN0b3J5LnB1c2hTdGF0ZSk7XG5cbiAgICBoaXN0b3J5LnJlcGxhY2VTdGF0ZSA9IChmID0+XG4gICAgICBmdW5jdGlvbiByZXBsYWNlU3RhdGUoKSB7XG4gICAgICAgIGNvbnN0IHJldCA9IGYuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcblxuICAgICAgICB3aW5kb3cuZGlzcGF0Y2hFdmVudChuZXcgRXZlbnQoJ3JlcGxhY2VTdGF0ZScpKTtcbiAgICAgICAgd2luZG93LmRpc3BhdGNoRXZlbnQobmV3IEV2ZW50KCdsb2NhdGlvbmNoYW5nZScpKTtcbiAgICAgICAgcmV0dXJuIHJldDtcbiAgICAgIH0pKGhpc3RvcnkucmVwbGFjZVN0YXRlKTtcblxuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdwb3BzdGF0ZScsICgpID0+IHtcbiAgICAgIHdpbmRvdy5kaXNwYXRjaEV2ZW50KG5ldyBFdmVudCgnbG9jYXRpb25jaGFuZ2UnKSk7XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiDQodC70YPRiNCw0YLRjCDQuNC30LzQtdC90LXQvdC40LUgVVJMXG4gICAgICovXG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2xvY2F0aW9uY2hhbmdlJywgKCkgPT4ge1xuICAgICAgdGhpcy5yZXNldCgpO1xuICAgICAgdGhpcy5sb2FkQ29uZGl0aW9uKCk7XG4gICAgfSk7XG4gIH0sXG4gIC8qKlxuICAgKiDQldGB0LvQuCDQv9GA0LjRhdC+0LTRj9GCINGC0LDQutC40LUg0Y3QutGI0L3Riywg0YLQviDRg9Cx0LjRgNCw0YLRjCBoaWdobGlnaHRcbiAgICogQHBhcmFtIHtvYmplY3R9IGVcbiAgICovXG4gIF9fbGlzdGVuRm9yQWN0aW9uQ2xpY2tlZFJlcXVlc3RzKGUpIHtcbiAgICBpZiAoaXNNZXNzYWdlRnJvbVdpZGdldChlKSAmJiBlLmRhdGEuYWN0aW9uID09PSAnQUNUSU9OX0NMSUNLRUQnKSB7XG4gICAgICBjb25zdCB7IGFuc3dlcl9pZCB9ID0gZS5kYXRhO1xuXG4gICAgICBpZiAoYW5zd2VyX2lkID09PSB0aGlzLl9faW50cm8uX29wdGlvbnMuc3RlcHNbMF0uaGlnaGxpZ2h0RXZlbnRBbnN3ZXJJZCkge1xuICAgICAgICB0aGlzLl9faW50cm8uZXhpdCgpO1xuICAgICAgfVxuICAgIH1cbiAgfSxcbiAgLyoqXG4gICAqINCX0LDQv9GD0YHRgtC40YLRjCDQv9GA0L7RgdC70YPRiNC90LjQstCw0L3QuNC1INGB0L7QsdGL0YLQuNC4INC60L7RgtC+0YDRi9C1INCy0YvRgdGC0YDQtdC70LjQstCw0Y7RgiBsaXN0ZW5lcl9pZFxuICAgKiBAcGFyYW0ge09iamVjdH0gZVxuICAgKi9cbiAgX19saXN0ZW5Gb3JPYnNlcnZlUmVxdWVzdHMoZSkge1xuICAgIGlmIChpc01lc3NhZ2VGcm9tV2lkZ2V0KGUpICYmIGUuZGF0YS5hY3Rpb24gPT09ICdPQlNFUlZFJykge1xuICAgICAgY29uc3QgbGlzdGVuZXIgPSBuZXcgQ2hhbmdlc0xpc3RlbmVyKGUuZGF0YSk7XG5cbiAgICAgIGxpc3RlbmVyLnRvdXJKcyA9IHRoaXM7XG4gICAgICBsaXN0ZW5lci5pbml0KCk7XG4gICAgfVxuICB9LFxuICAvKipcbiAgICog0JfQsNC/0YPRgdGC0LjRgtGMINC/0YDQvtGB0LvRg9GI0LjQstCw0L3QuNC1INC30LDQutGA0YvRgtC40Y8g0LLRi9C00LXQu9C10L3QuNGPINGN0LvQtdC80LXQvdGC0LBcbiAgICogQHBhcmFtIHtPYmplY3R9IGVcbiAgICovXG4gIF9fbGlzdGVuRm9ySGlnaGxpZ2h0UmVxdWVzdHMoZSkge1xuICAgIGlmIChpc01lc3NhZ2VGcm9tV2lkZ2V0KGUpICYmIGUuZGF0YS5hY3Rpb24gPT09ICdISUdITElHSFQnKSB7XG4gICAgICBpZiAoZS5kYXRhLnNlbGVjdG9yKSB7XG4gICAgICAgIHRoaXMuaGlnaGxpZ2h0KGUuZGF0YSk7XG4gICAgICB9XG4gICAgfVxuICB9LFxuICBfX2dldEVsZW1lbnRGb3JIaWdobGlnaHQoc2VsZWN0b3IpIHtcbiAgICBjb25zdCBlbGVtZW50cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoc2VsZWN0b3IpO1xuICAgIGNvbnN0IGVsZW1lbnRzQXJyYXkgPSBBcnJheS5mcm9tKGVsZW1lbnRzKTtcblxuICAgIHJldHVybiBlbGVtZW50c0FycmF5LmZpbmQoaXNBbnlQYXJ0T2ZFbGVtZW50SW5WaWV3cG9ydCk7XG4gIH0sXG4gIGhpZ2hsaWdodCh7IHNlbGVjdG9yLCBjbG9zZUV2ZW50LCBoaWdobGlnaHRFdmVudEFuc3dlcklkIH0pIHtcbiAgICBjb25zdCBzdGVwID0ge1xuICAgICAgZWxlbWVudDogc2VsZWN0b3IsXG4gICAgICBmaXhlZDogdHJ1ZSxcbiAgICAgIGNsb3NlRXZlbnQsXG4gICAgICBoaWdobGlnaHRFdmVudEFuc3dlcklkXG4gICAgfTtcbiAgICBjb25zdCBpbnRyb0VsZW1lbnQgPSB0aGlzLl9fZ2V0RWxlbWVudEZvckhpZ2hsaWdodChzZWxlY3Rvcik7XG5cbiAgICBpZiAoaW50cm9FbGVtZW50ID09IG51bGwpIHtcbiAgICAgIHNob3dFcnJvcihcIkVsZW1lbnQgZG9lc24ndCBleGlzdCBvbiBET01cIik7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgaWYgKGNsb3NlRXZlbnQgPT09ICdjaGF0TGlzdGVuZXJDbGljaycpIHtcbiAgICAgIHRoaXMuc2V0T3B0aW9ucyh7XG4gICAgICAgIG9wdGlvbnM6IHtcbiAgICAgICAgICBleGl0T25Fc2M6IGZhbHNlLFxuICAgICAgICAgIGV4aXRPbk92ZXJsYXlDbGljazogZmFsc2UsXG4gICAgICAgICAgZGlzYWJsZUludGVyYWN0aW9uOiB0cnVlXG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLnNldE9wdGlvbnMoe1xuICAgICAgICBvcHRpb25zOiB7XG4gICAgICAgICAgZXhpdE9uRXNjOiB0cnVlLFxuICAgICAgICAgIGV4aXRPbk92ZXJsYXlDbGljazogZmFsc2UsXG4gICAgICAgICAgZGlzYWJsZUludGVyYWN0aW9uOiBmYWxzZVxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG4gICAgdGhpcy5fX2ludHJvLmFkZFN0ZXAoc3RlcCk7XG5cbiAgICAvLyBMaXN0ZW4gdG8gZXZlbnRcbiAgICBpbnRyb0VsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcbiAgICAgIGNsb3NlRXZlbnQsXG4gICAgICAoKSA9PiB7XG4gICAgICAgIHRoaXMuX19pbnRyby5leGl0KCk7XG4gICAgICB9LFxuICAgICAgeyBvbmNlOiB0cnVlIH1cbiAgICApO1xuICAgIC8vIENsb3NlXG4gICAgaWYgKHRoaXMuX19pbnRyby5faW50cm9JdGVtcy5sZW5ndGgpIHtcbiAgICAgIHRoaXMuX19pbnRyby5nb1RvU3RlcE51bWJlcigwKTtcbiAgICB9XG4gICAgdGhpcy5fX2ludHJvLmV4aXQoKTtcblxuICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgdGhpcy5fX2ludHJvLnN0YXJ0KHN0ZXApO1xuICAgIH0sIDUwKTtcbiAgfSxcbiAgc2VuZE1lc3NhZ2UobXNnKSB7XG4gICAgdGhpcy5fX2ludHJvLmV4aXQoKTtcbiAgICBjb25zdCBpZnJhbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHRoaXMuc2VsZWN0b3IpO1xuXG4gICAgaWYgKCFpZnJhbWUpIHtcbiAgICAgIHNob3dFcnJvcihcIldpZGdldCdzIGlmcmFtZSBub3QgZm91bmQhXCIpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGlmcmFtZS5jb250ZW50V2luZG93LnBvc3RNZXNzYWdlKE9iamVjdC5hc3NpZ24obXNnLCB7IHNvdXJjZTogJ2dldC10b3VyLWxpYnJhcnknIH0pKTtcbiAgfSxcbiAgcmVzZXQoKSB7XG4gICAgdGhpcy5fX2ludHJvLl9vcHRpb25zLnN0ZXBzID0gW107XG4gICAgdGhpcy5fX2ludHJvLnJlZnJlc2goKTtcbiAgICB0aGlzLmRlc3Ryb3lXaWRnZXQoKTtcbiAgfSxcbiAgZGVzdHJveVdpZGdldCgpIHtcbiAgICBpZiAodGhpcy5ibG9jaykge1xuICAgICAgdGhpcy5ibG9jay5yZW1vdmUoKTtcbiAgICB9XG4gIH0sXG4gIHJlbmRlcldpZGdldCh3aWRnZXRVcmwpIHtcbiAgICB0aGlzLmJsb2NrID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgdGhpcy5ibG9jay5jbGFzc05hbWUgPSAnZ2V0Y2hhdC13aWRnZXQgZ2V0Y2hhdC13aWRnZXQtLWV4cGFuZGVkJztcbiAgICBjb25zdCB3aWRnZXRIdG1sID1cbiAgICAgICc8YnV0dG9uIHR5cGU9XCJidXR0b25cIiBjbGFzcz1cImdldGNoYXQtd2lkZ2V0X19idG4gZ2V0Y2hhdC13aWRnZXRfX2J0bi0taWNvblwiID4nICtcbiAgICAgICc8aSBhcmlhLWhpZGRlbj1cInRydWVcIiBjbGFzcz1cImdldGNoYXQtd2lkZ2V0X19pY29uLS1jbG9zZVwiPjwvaT48L2J1dHRvbj4nICtcbiAgICAgIGA8aWZyYW1lIHNyYz1cIiR7d2lkZ2V0VXJsfVwiIGNsYXNzPVwiZ2V0Y2hhdC13aWRnZXRfX2ZyYW1lXCI+PC9pZnJhbWU+YDtcblxuICAgIHRoaXMuYmxvY2suaW5uZXJIVE1MID0gd2lkZ2V0SHRtbDtcblxuICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQodGhpcy5ibG9jayk7XG4gIH0sXG4gIGxvYWRTdHlsZXMoKSB7XG4gICAgbG9hZENzcyh0aGlzLnN0eWxlc0ZpbGVQYXRoKTtcbiAgICB0aGlzLnN0eWxlc0xvYWRlZCA9IHRydWU7XG4gIH0sXG4gIGluaXRFdmVudExpc3RlbmVycygpIHtcbiAgICBjb25zdCAkY2xvc2VCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZ2V0Y2hhdC13aWRnZXRfX2J0bi0taWNvbicpO1xuXG4gICAgJGNsb3NlQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgaWYgKHRoaXMuYmxvY2suY2xhc3NMaXN0LmNvbnRhaW5zKHRoaXMuZXhwYW5kQ2xhc3MpKSB7XG4gICAgICAgIHRoaXMuaGlkZUJsb2NrKCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLmV4cGFuZEJsb2NrKCk7XG4gICAgICB9XG4gICAgfSk7XG4gIH0sXG4gIGhpZGVCbG9jaygpIHtcbiAgICBjb25zdCAkY2xvc2VCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZ2V0Y2hhdC13aWRnZXRfX2J0bi0taWNvbicpO1xuICAgIGNvbnN0ICRpY29uID0gJGNsb3NlQnRuLmNoaWxkcmVuWzBdO1xuXG4gICAgdGhpcy5ibG9jay5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuZXhwYW5kQ2xhc3MpO1xuICAgICRpY29uLmNsYXNzTmFtZSA9ICdnZXRjaGF0LXdpZGdldF9faWNvbi0tZXhwYW5kJztcbiAgfSxcbiAgZXhwYW5kQmxvY2soKSB7XG4gICAgY29uc3QgJGNsb3NlQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmdldGNoYXQtd2lkZ2V0X19idG4tLWljb24nKTtcbiAgICBjb25zdCAkaWNvbiA9ICRjbG9zZUJ0bi5jaGlsZHJlblswXTtcblxuICAgIHRoaXMuYmxvY2suY2xhc3NMaXN0LmFkZCh0aGlzLmV4cGFuZENsYXNzKTtcbiAgICAkaWNvbi5jbGFzc05hbWUgPSAnZ2V0Y2hhdC13aWRnZXRfX2ljb24tLWNsb3NlJztcbiAgfSxcbiAgbG9hZFdpZGdldERhdGEoKSB7XG4gICAgLy8gY29uc3QgdXJsID0gYGh0dHBzOi8vZ2V0Y2hhdC5tZS9hcGkvdGhlLWJvdC93aWRnZXQvJHt0aGlzLmhhc2h9L2RhdGFgO1xuICAgIGNvbnN0IHVybCA9IGBodHRwOi8vbG9jYWxob3N0OjMwMDAvYXBpL3RoZS1ib3Qvd2lkZ2V0LyR7dGhpcy5oYXNofS9kYXRhYDtcblxuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PlxuICAgICAgZmV0Y2godXJsLCB7XG4gICAgICAgIG1ldGhvZDogJ0dFVCcsXG4gICAgICAgIGNyZWRlbnRpYWxzOiAnb21pdCcsXG4gICAgICAgIGhlYWRlcnM6IHsgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyB9LFxuICAgICAgICBtb2RlOiAnY29ycycsXG4gICAgICAgIGNhY2hlOiAnbm8tY2FjaGUnLFxuICAgICAgICBkYXRhVHlwZTogJ2pzb25wJ1xuICAgICAgfSlcbiAgICAgICAgLnRoZW4ocmVzID0+IHtcbiAgICAgICAgICBpZiAocmVzLnN0YXR1cyA9PT0gMjAwKSB7XG4gICAgICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgc2hvd0Vycm9yKGBb0J7RiNC40LHQutCwXSAke3Jlcy5zdGF0dXNUZXh0fWApO1xuICAgICAgICAgIHJldHVybiB7fTtcbiAgICAgICAgfSlcbiAgICAgICAgLnRoZW4ocmVzcG9uc2UgPT4gcmVzb2x2ZShyZXNwb25zZSkpXG4gICAgICAgIC5jYXRjaChlcnJvciA9PiB7XG4gICAgICAgICAgc2hvd0Vycm9yKGVycm9yKTtcbiAgICAgICAgICByZWplY3QoZXJyb3IpO1xuICAgICAgICB9KVxuICAgICk7XG4gIH1cbn07XG5cbmV4cG9ydCBkZWZhdWx0IG9uYm9hcmRpbmc7XG4iLCIvKiBlc2xpbnQtZGlzYWJsZSAqL1xuLyoqXG4gKiBJbnRyby5qcyB2Mi45LjMgIGZvcmsuIG9ubHkgaGlnaGxpZ2h0IGVsZW1lbnRcbiAqIGh0dHBzOi8vZ2l0aHViLmNvbS91c2FibGljYS9pbnRyby5qc1xuICpcbiAqIENvcHlyaWdodCAoQykgMjAxNyBBZnNoaW4gTWVocmFiYW5pIChAYWZzaGlubWVoKVxuICovXG5cbihmdW5jdGlvbihmKSB7XG4gIGlmICh0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcgJiYgdHlwZW9mIG1vZHVsZSAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICBtb2R1bGUuZXhwb3J0cyA9IGYoKTtcbiAgICAvLyBkZXByZWNhdGVkIGZ1bmN0aW9uXG4gICAgLy8gQHNpbmNlIDIuOC4wXG4gICAgbW9kdWxlLmV4cG9ydHMuaW50cm9KcyA9IGZ1bmN0aW9uKCkge1xuICAgICAgY29uc29sZS53YXJuKFxuICAgICAgICAnRGVwcmVjYXRlZDogcGxlYXNlIHVzZSByZXF1aXJlKFwiaW50cm8uanNcIikgZGlyZWN0bHksIGluc3RlYWQgb2YgdGhlIGludHJvSnMgbWV0aG9kIG9mIHRoZSBmdW5jdGlvbidcbiAgICAgICk7XG4gICAgICAvLyBpbnRyb0pzKClcbiAgICAgIHJldHVybiBmKCkuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICB9O1xuICB9IGVsc2UgaWYgKHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZCkge1xuICAgIGRlZmluZShbXSwgZik7XG4gIH0gZWxzZSB7XG4gICAgdmFyIGc7XG4gICAgaWYgKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICBnID0gd2luZG93O1xuICAgIH0gZWxzZSBpZiAodHlwZW9mIGdsb2JhbCAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgIGcgPSBnbG9iYWw7XG4gICAgfSBlbHNlIGlmICh0eXBlb2Ygc2VsZiAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgIGcgPSBzZWxmO1xuICAgIH0gZWxzZSB7XG4gICAgICBnID0gdGhpcztcbiAgICB9XG4gICAgZy5pbnRyb0pzID0gZigpO1xuICB9XG59KShmdW5jdGlvbigpIHtcbiAgLy9EZWZhdWx0IGNvbmZpZy92YXJpYWJsZXNcbiAgdmFyIFZFUlNJT04gPSAnMi45LjMnO1xuXG4gIC8qKlxuICAgKiBJbnRyb0pzIG1haW4gY2xhc3NcbiAgICpcbiAgICogQGNsYXNzIEludHJvSnNcbiAgICovXG4gIGZ1bmN0aW9uIEludHJvSnMob2JqKSB7XG4gICAgdGhpcy5fdGFyZ2V0RWxlbWVudCA9IG9iajtcbiAgICB0aGlzLl9pbnRyb0l0ZW1zID0gW107XG5cbiAgICB0aGlzLl9vcHRpb25zID0ge1xuICAgICAgLyogQ1NTIGNsYXNzIHRoYXQgaXMgYWRkZWQgdG8gdGhlIGhlbHBlckxheWVyICovXG4gICAgICBoaWdobGlnaHRDbGFzczogJycsXG4gICAgICAvKiBDbG9zZSBpbnRyb2R1Y3Rpb24gd2hlbiBwcmVzc2luZyBFc2NhcGUgYnV0dG9uPyAqL1xuICAgICAgZXhpdE9uRXNjOiB0cnVlLFxuICAgICAgLyogQ2xvc2UgaW50cm9kdWN0aW9uIHdoZW4gY2xpY2tpbmcgb24gb3ZlcmxheSBsYXllcj8gKi9cbiAgICAgIGV4aXRPbk92ZXJsYXlDbGljazogdHJ1ZSxcbiAgICAgIC8qIExldCB1c2VyIHVzZSBrZXlib2FyZCB0byBuYXZpZ2F0ZSB0aGUgdG91cj8gKi9cbiAgICAgIGtleWJvYXJkTmF2aWdhdGlvbjogZmFsc2UsXG5cbiAgICAgIC8qIFNjcm9sbCB0byBoaWdobGlnaHRlZCBlbGVtZW50PyAqL1xuICAgICAgc2Nyb2xsVG9FbGVtZW50OiB0cnVlLFxuICAgICAgLypcbiAgICAgICAqIFNob3VsZCB3ZSBzY3JvbGwgdGhlIHRvb2x0aXAgb3IgdGFyZ2V0IGVsZW1lbnQ/XG4gICAgICAgKlxuICAgICAgICogT3B0aW9ucyBhcmU6ICdlbGVtZW50JyBvciAndG9vbHRpcCdcbiAgICAgICAqL1xuICAgICAgc2Nyb2xsVG86ICdlbGVtZW50JyxcbiAgICAgIC8qIFBhZGRpbmcgdG8gYWRkIGFmdGVyIHNjcm9sbGluZyB3aGVuIGVsZW1lbnQgaXMgbm90IGluIHRoZSB2aWV3cG9ydCAoaW4gcGl4ZWxzKSAqL1xuICAgICAgc2Nyb2xsUGFkZGluZzogMzAsXG4gICAgICAvKiBTZXQgdGhlIG92ZXJsYXkgb3BhY2l0eSAqL1xuICAgICAgb3ZlcmxheU9wYWNpdHk6IDAuOSxcbiAgICAgIC8qIFByZWNlZGVuY2Ugb2YgcG9zaXRpb25zLCB3aGVuIGF1dG8gaXMgZW5hYmxlZCAqL1xuICAgICAgcG9zaXRpb25QcmVjZWRlbmNlOiBbJ2JvdHRvbScsICd0b3AnLCAncmlnaHQnLCAnbGVmdCddLFxuICAgICAgLyogRGlzYWJsZSBhbiBpbnRlcmFjdGlvbiB3aXRoIGVsZW1lbnQ/ICovXG4gICAgICBkaXNhYmxlSW50ZXJhY3Rpb246IGZhbHNlLFxuICAgICAgLyogU2V0IGhvdyBtdWNoIHBhZGRpbmcgdG8gYmUgdXNlZCBhcm91bmQgaGVscGVyIGVsZW1lbnQgKi9cbiAgICAgIGhlbHBlckVsZW1lbnRQYWRkaW5nOiAwLFxuXG4gICAgICAvKiBhZGRpdGlvbmFsIGNsYXNzZXMgdG8gcHV0IG9uIHRoZSBidXR0b25zICovXG4gICAgICBidXR0b25DbGFzczogJ2ludHJvanMtYnV0dG9uJ1xuICAgIH07XG4gIH1cblxuICAvKipcbiAgICogSW5pdGlhdGUgYSBuZXcgaW50cm9kdWN0aW9uL2d1aWRlIGZyb20gYW4gZWxlbWVudCBpbiB0aGUgcGFnZVxuICAgKlxuICAgKiBAYXBpIHByaXZhdGVcbiAgICogQG1ldGhvZCBfaW50cm9Gb3JFbGVtZW50XG4gICAqIEBwYXJhbSB7T2JqZWN0fSB0YXJnZXRFbG1cbiAgICogQHBhcmFtIHtTdHJpbmd9IGdyb3VwXG4gICAqIEByZXR1cm5zIHtCb29sZWFufSBTdWNjZXNzIG9yIG5vdD9cbiAgICovXG4gIGZ1bmN0aW9uIF9pbnRyb0ZvckVsZW1lbnQodGFyZ2V0RWxtLCBzdGVwKSB7XG4gICAgdmFyIGludHJvSXRlbXMgPSBbXTtcbiAgICB2YXIgY3VycmVudEl0ZW0gPSBfY2xvbmVPYmplY3Qoc3RlcCk7XG5cbiAgICAvL3NldCB0aGUgc3RlcFxuICAgIGN1cnJlbnRJdGVtLnN0ZXAgPSBpbnRyb0l0ZW1zLmxlbmd0aCArIDE7XG5cbiAgICAvL3VzZSBxdWVyeVNlbGVjdG9yIGZ1bmN0aW9uIG9ubHkgd2hlbiBkZXZlbG9wZXIgdXNlZCBDU1Mgc2VsZWN0b3JcbiAgICBpZiAodHlwZW9mIGN1cnJlbnRJdGVtLmVsZW1lbnQgPT09ICdzdHJpbmcnKSB7XG4gICAgICAvL2dyYWIgdGhlIGVsZW1lbnQgd2l0aCBnaXZlbiBzZWxlY3RvciBmcm9tIHRoZSBwYWdlXG4gICAgICBjdXJyZW50SXRlbS5lbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihjdXJyZW50SXRlbS5lbGVtZW50KTtcbiAgICB9XG5cbiAgICAvL2ludHJvIHdpdGhvdXQgZWxlbWVudFxuICAgIGlmIChcbiAgICAgIHR5cGVvZiBjdXJyZW50SXRlbS5lbGVtZW50ID09PSAndW5kZWZpbmVkJyB8fFxuICAgICAgY3VycmVudEl0ZW0uZWxlbWVudCA9PT0gbnVsbFxuICAgICkge1xuICAgICAgdmFyIGZsb2F0aW5nRWxlbWVudFF1ZXJ5ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgICAgJy5pbnRyb2pzRmxvYXRpbmdFbGVtZW50J1xuICAgICAgKTtcblxuICAgICAgaWYgKGZsb2F0aW5nRWxlbWVudFF1ZXJ5ID09PSBudWxsKSB7XG4gICAgICAgIGZsb2F0aW5nRWxlbWVudFF1ZXJ5ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgIGZsb2F0aW5nRWxlbWVudFF1ZXJ5LmNsYXNzTmFtZSA9ICdpbnRyb2pzRmxvYXRpbmdFbGVtZW50JztcblxuICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGZsb2F0aW5nRWxlbWVudFF1ZXJ5KTtcbiAgICAgIH1cblxuICAgICAgY3VycmVudEl0ZW0uZWxlbWVudCA9IGZsb2F0aW5nRWxlbWVudFF1ZXJ5O1xuICAgICAgY3VycmVudEl0ZW0ucG9zaXRpb24gPSAnZmxvYXRpbmcnO1xuICAgIH1cblxuICAgIGN1cnJlbnRJdGVtLnNjcm9sbFRvID0gY3VycmVudEl0ZW0uc2Nyb2xsVG8gfHwgdGhpcy5fb3B0aW9ucy5zY3JvbGxUbztcblxuICAgIGlmICh0eXBlb2YgY3VycmVudEl0ZW0uZGlzYWJsZUludGVyYWN0aW9uID09PSAndW5kZWZpbmVkJykge1xuICAgICAgY3VycmVudEl0ZW0uZGlzYWJsZUludGVyYWN0aW9uID0gdGhpcy5fb3B0aW9ucy5kaXNhYmxlSW50ZXJhY3Rpb247XG4gICAgfVxuXG4gICAgaWYgKGN1cnJlbnRJdGVtLmVsZW1lbnQgIT09IG51bGwpIHtcbiAgICAgIGludHJvSXRlbXMgPSBbY3VycmVudEl0ZW1dO1xuICAgIH1cblxuICAgIC8vc2V0IGl0IHRvIHRoZSBpbnRyb0pzIG9iamVjdFxuICAgIHRoaXMuX2ludHJvSXRlbXMgPSBpbnRyb0l0ZW1zO1xuXG4gICAgLy9hZGQgb3ZlcmxheSBsYXllciB0byB0aGUgcGFnZVxuICAgIGlmIChfYWRkT3ZlcmxheUxheWVyLmNhbGwodGhpcywgdGFyZ2V0RWxtKSkge1xuICAgICAgLy90aGVuLCBzdGFydCB0aGUgc2hvd1xuICAgICAgX25leHRTdGVwLmNhbGwodGhpcyk7XG5cbiAgICAgIGlmICh0aGlzLl9vcHRpb25zLmtleWJvYXJkTmF2aWdhdGlvbikge1xuICAgICAgICBET01FdmVudC5vbih3aW5kb3csICdrZXlkb3duJywgX29uS2V5RG93biwgdGhpcywgdHJ1ZSk7XG4gICAgICB9XG4gICAgICAvL2ZvciB3aW5kb3cgcmVzaXplXG4gICAgICBET01FdmVudC5vbih3aW5kb3csICdyZXNpemUnLCBfb25SZXNpemUsIHRoaXMsIHRydWUpO1xuICAgIH1cbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cblxuICBmdW5jdGlvbiBfb25SZXNpemUoKSB7XG4gICAgdGhpcy5yZWZyZXNoLmNhbGwodGhpcyk7XG4gIH1cblxuICAvKipcbiAgICogb24ga2V5Q29kZTpcbiAgICogaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvQVBJL0tleWJvYXJkRXZlbnQva2V5Q29kZVxuICAgKiBUaGlzIGZlYXR1cmUgaGFzIGJlZW4gcmVtb3ZlZCBmcm9tIHRoZSBXZWIgc3RhbmRhcmRzLlxuICAgKiBUaG91Z2ggc29tZSBicm93c2VycyBtYXkgc3RpbGwgc3VwcG9ydCBpdCwgaXQgaXMgaW5cbiAgICogdGhlIHByb2Nlc3Mgb2YgYmVpbmcgZHJvcHBlZC5cbiAgICogSW5zdGVhZCwgeW91IHNob3VsZCB1c2UgS2V5Ym9hcmRFdmVudC5jb2RlLFxuICAgKiBpZiBpdCdzIGltcGxlbWVudGVkLlxuICAgKlxuICAgKiBqUXVlcnkncyBhcHByb2FjaCBpcyB0byB0ZXN0IGZvclxuICAgKiAgICgxKSBlLndoaWNoLCB0aGVuXG4gICAqICAgKDIpIGUuY2hhckNvZGUsIHRoZW5cbiAgICogICAoMykgZS5rZXlDb2RlXG4gICAqIGh0dHBzOi8vZ2l0aHViLmNvbS9qcXVlcnkvanF1ZXJ5L2Jsb2IvYTZiMDcwNTI5NGQzMzZhZTJmNjNmNzI3NmRlMGRhMTE5NTQ5NTM2My9zcmMvZXZlbnQuanMjTDYzOFxuICAgKlxuICAgKiBAcGFyYW0gdHlwZSB2YXJcbiAgICogQHJldHVybiB0eXBlXG4gICAqL1xuICBmdW5jdGlvbiBfb25LZXlEb3duKGUpIHtcbiAgICB2YXIgY29kZSA9IGUuY29kZSA9PT0gbnVsbCA/IGUud2hpY2ggOiBlLmNvZGU7XG5cbiAgICAvLyBpZiBjb2RlL2Uud2hpY2ggaXMgbnVsbFxuICAgIGlmIChjb2RlID09PSBudWxsKSB7XG4gICAgICBjb2RlID0gZS5jaGFyQ29kZSA9PT0gbnVsbCA/IGUua2V5Q29kZSA6IGUuY2hhckNvZGU7XG4gICAgfVxuXG4gICAgaWYgKFxuICAgICAgKGNvZGUgPT09ICdFc2NhcGUnIHx8IGNvZGUgPT09IDI3KSAmJlxuICAgICAgdGhpcy5fb3B0aW9ucy5leGl0T25Fc2MgPT09IHRydWVcbiAgICApIHtcbiAgICAgIC8vZXNjYXBlIGtleSBwcmVzc2VkLCBleGl0IHRoZSBpbnRyb1xuICAgICAgLy9jaGVjayBpZiBleGl0IGNhbGxiYWNrIGlzIGRlZmluZWRcbiAgICAgIF9leGl0SW50cm8uY2FsbCh0aGlzLCB0aGlzLl90YXJnZXRFbGVtZW50KTtcbiAgICB9XG4gIH1cblxuICAvKlxuICAgKiBtYWtlcyBhIGNvcHkgb2YgdGhlIG9iamVjdFxuICAgKiBAYXBpIHByaXZhdGVcbiAgICogQG1ldGhvZCBfY2xvbmVPYmplY3RcbiAgICovXG4gIGZ1bmN0aW9uIF9jbG9uZU9iamVjdChvYmplY3QpIHtcbiAgICBpZiAoXG4gICAgICBvYmplY3QgPT09IG51bGwgfHxcbiAgICAgIHR5cGVvZiBvYmplY3QgIT09ICdvYmplY3QnIHx8XG4gICAgICB0eXBlb2Ygb2JqZWN0Lm5vZGVUeXBlICE9PSAndW5kZWZpbmVkJ1xuICAgICkge1xuICAgICAgcmV0dXJuIG9iamVjdDtcbiAgICB9XG4gICAgdmFyIHRlbXAgPSB7fTtcbiAgICBmb3IgKHZhciBrZXkgaW4gb2JqZWN0KSB7XG4gICAgICBpZiAoXG4gICAgICAgIHR5cGVvZiB3aW5kb3cualF1ZXJ5ICE9PSAndW5kZWZpbmVkJyAmJlxuICAgICAgICBvYmplY3Rba2V5XSBpbnN0YW5jZW9mIHdpbmRvdy5qUXVlcnlcbiAgICAgICkge1xuICAgICAgICB0ZW1wW2tleV0gPSBvYmplY3Rba2V5XTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRlbXBba2V5XSA9IF9jbG9uZU9iamVjdChvYmplY3Rba2V5XSk7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiB0ZW1wO1xuICB9XG4gIC8qKlxuICAgKiBHbyB0byBzcGVjaWZpYyBzdGVwIG9mIGludHJvZHVjdGlvblxuICAgKlxuICAgKiBAYXBpIHByaXZhdGVcbiAgICogQG1ldGhvZCBfZ29Ub1N0ZXBcbiAgICovXG4gIGZ1bmN0aW9uIF9nb1RvU3RlcChzdGVwKSB7XG4gICAgLy9iZWNhdXNlIHN0ZXBzIHN0YXJ0cyB3aXRoIHplcm9cbiAgICB0aGlzLl9jdXJyZW50U3RlcCA9IHN0ZXAgLSAyO1xuICAgIGlmICh0eXBlb2YgdGhpcy5faW50cm9JdGVtcyAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgIF9uZXh0U3RlcC5jYWxsKHRoaXMpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBHbyB0byB0aGUgc3BlY2lmaWMgc3RlcCBvZiBpbnRyb2R1Y3Rpb24gd2l0aCB0aGUgZXhwbGljaXQgW2RhdGEtc3RlcF0gbnVtYmVyXG4gICAqXG4gICAqIEBhcGkgcHJpdmF0ZVxuICAgKiBAbWV0aG9kIF9nb1RvU3RlcE51bWJlclxuICAgKi9cbiAgZnVuY3Rpb24gX2dvVG9TdGVwTnVtYmVyKHN0ZXApIHtcbiAgICB0aGlzLl9jdXJyZW50U3RlcE51bWJlciA9IHN0ZXA7XG4gICAgaWYgKHR5cGVvZiB0aGlzLl9pbnRyb0l0ZW1zICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgX25leHRTdGVwLmNhbGwodGhpcyk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEdvIHRvIG5leHQgc3RlcCBvbiBpbnRyb1xuICAgKlxuICAgKiBAYXBpIHByaXZhdGVcbiAgICogQG1ldGhvZCBfbmV4dFN0ZXBcbiAgICovXG4gIGZ1bmN0aW9uIF9uZXh0U3RlcCgpIHtcbiAgICB0aGlzLl9kaXJlY3Rpb24gPSAnZm9yd2FyZCc7XG5cbiAgICBpZiAodHlwZW9mIHRoaXMuX2N1cnJlbnRTdGVwTnVtYmVyICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgX2ZvckVhY2goXG4gICAgICAgIHRoaXMuX2ludHJvSXRlbXMsXG4gICAgICAgIGZ1bmN0aW9uKGl0ZW0sIGkpIHtcbiAgICAgICAgICBpZiAoaXRlbS5zdGVwID09PSB0aGlzLl9jdXJyZW50U3RlcE51bWJlcikge1xuICAgICAgICAgICAgdGhpcy5fY3VycmVudFN0ZXAgPSBpIC0gMTtcbiAgICAgICAgICAgIHRoaXMuX2N1cnJlbnRTdGVwTnVtYmVyID0gdW5kZWZpbmVkO1xuICAgICAgICAgIH1cbiAgICAgICAgfS5iaW5kKHRoaXMpXG4gICAgICApO1xuICAgIH1cblxuICAgIGlmICh0eXBlb2YgdGhpcy5fY3VycmVudFN0ZXAgPT09ICd1bmRlZmluZWQnKSB7XG4gICAgICB0aGlzLl9jdXJyZW50U3RlcCA9IDA7XG4gICAgfSBlbHNlIHtcbiAgICAgICsrdGhpcy5fY3VycmVudFN0ZXA7XG4gICAgfVxuXG4gICAgLy8gY29tbWVudCDQvtGB0YLRi9C70YwgdmFyIG5leHRTdGVwID0gdGhpcy5faW50cm9JdGVtc1t0aGlzLl9jdXJyZW50U3RlcF07XG4gICAgdmFyIG5leHRTdGVwID0gdGhpcy5faW50cm9JdGVtc1swXTtcbiAgICB2YXIgY29udGludWVTdGVwID0gdHJ1ZTtcblxuICAgIGlmICh0eXBlb2YgdGhpcy5faW50cm9CZWZvcmVDaGFuZ2VDYWxsYmFjayAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgIGNvbnRpbnVlU3RlcCA9IHRoaXMuX2ludHJvQmVmb3JlQ2hhbmdlQ2FsbGJhY2suY2FsbChcbiAgICAgICAgdGhpcyxcbiAgICAgICAgbmV4dFN0ZXAuZWxlbWVudFxuICAgICAgKTtcbiAgICB9XG5cbiAgICAvLyBpZiBgb25iZWZvcmVjaGFuZ2VgIHJldHVybmVkIGBmYWxzZWAsIHN0b3AgZGlzcGxheWluZyB0aGUgZWxlbWVudFxuICAgIGlmIChjb250aW51ZVN0ZXAgPT09IGZhbHNlKSB7XG4gICAgICAtLXRoaXMuX2N1cnJlbnRTdGVwO1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIGlmICh0aGlzLl9pbnRyb0l0ZW1zLmxlbmd0aCA8PSB0aGlzLl9jdXJyZW50U3RlcCkge1xuICAgICAgLy9lbmQgb2YgdGhlIGludHJvXG4gICAgICAvL2NoZWNrIGlmIGFueSBjYWxsYmFjayBpcyBkZWZpbmVkXG4gICAgICBpZiAodHlwZW9mIHRoaXMuX2ludHJvQ29tcGxldGVDYWxsYmFjayA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICB0aGlzLl9pbnRyb0NvbXBsZXRlQ2FsbGJhY2suY2FsbCh0aGlzKTtcbiAgICAgIH1cbiAgICAgIF9leGl0SW50cm8uY2FsbCh0aGlzLCB0aGlzLl90YXJnZXRFbGVtZW50KTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBfc2hvd0VsZW1lbnQuY2FsbCh0aGlzLCBuZXh0U3RlcCk7XG4gIH1cbiBcbiAgLyoqXG4gICAqIFVwZGF0ZSBwbGFjZW1lbnQgb2YgdGhlIGludHJvIG9iamVjdHMgb24gdGhlIHNjcmVlblxuICAgKiBAYXBpIHByaXZhdGVcbiAgICovXG4gIGZ1bmN0aW9uIF9yZWZyZXNoKCkge1xuICAgIC8vIHJlLWFsaWduIGludHJvc1xuICAgIF9zZXRIZWxwZXJMYXllclBvc2l0aW9uLmNhbGwoXG4gICAgICB0aGlzLFxuICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmludHJvanMtaGVscGVyTGF5ZXInKVxuICAgICk7XG4gICAgX3NldEhlbHBlckxheWVyUG9zaXRpb24uY2FsbChcbiAgICAgIHRoaXMsXG4gICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuaW50cm9qcy10b29sdGlwUmVmZXJlbmNlTGF5ZXInKVxuICAgICk7XG4gICAgX3NldEhlbHBlckxheWVyUG9zaXRpb24uY2FsbChcbiAgICAgIHRoaXMsXG4gICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuaW50cm9qcy1kaXNhYmxlSW50ZXJhY3Rpb24nKVxuICAgICk7XG5cbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIC8qKlxuICAgKiBFeGl0IGZyb20gaW50cm9cbiAgICpcbiAgICogQGFwaSBwcml2YXRlXG4gICAqIEBtZXRob2QgX2V4aXRJbnRyb1xuICAgKiBAcGFyYW0ge09iamVjdH0gdGFyZ2V0RWxlbWVudFxuICAgKiBAcGFyYW0ge0Jvb2xlYW59IGZvcmNlIC0gU2V0dGluZyB0byBgdHJ1ZWAgd2lsbCBza2lwIHRoZSByZXN1bHQgb2YgYmVmb3JlRXhpdCBjYWxsYmFja1xuICAgKi9cbiAgZnVuY3Rpb24gX2V4aXRJbnRybyh0YXJnZXRFbGVtZW50LCBmb3JjZSkge1xuICAgIHZhciBjb250aW51ZUV4aXQgPSB0cnVlO1xuXG4gICAgLy8gY2FsbGluZyBvbmJlZm9yZWV4aXQgY2FsbGJhY2tcbiAgICAvL1xuICAgIC8vIElmIHRoaXMgY2FsbGJhY2sgcmV0dXJuIGBmYWxzZWAsIGl0IHdvdWxkIGhhbHQgdGhlIHByb2Nlc3NcbiAgICBpZiAodGhpcy5faW50cm9CZWZvcmVFeGl0Q2FsbGJhY2sgIT09IHVuZGVmaW5lZCkge1xuICAgICAgY29udGludWVFeGl0ID0gdGhpcy5faW50cm9CZWZvcmVFeGl0Q2FsbGJhY2suY2FsbCh0aGlzKTtcbiAgICB9XG5cbiAgICAvLyBza2lwIHRoaXMgY2hlY2sgaWYgYGZvcmNlYCBwYXJhbWV0ZXIgaXMgYHRydWVgXG4gICAgLy8gb3RoZXJ3aXNlLCBpZiBgb25iZWZvcmVleGl0YCByZXR1cm5lZCBgZmFsc2VgLCBkb24ndCBleGl0IHRoZSBpbnRyb1xuICAgIGlmICghZm9yY2UgJiYgY29udGludWVFeGl0ID09PSBmYWxzZSkgcmV0dXJuO1xuXG4gICAgLy9yZW1vdmUgb3ZlcmxheSBsYXllcnMgZnJvbSB0aGUgcGFnZVxuICAgIHZhciBvdmVybGF5TGF5ZXJzID0gdGFyZ2V0RWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuaW50cm9qcy1vdmVybGF5Jyk7XG5cbiAgICBpZiAob3ZlcmxheUxheWVycyAmJiBvdmVybGF5TGF5ZXJzLmxlbmd0aCkge1xuICAgICAgX2ZvckVhY2goXG4gICAgICAgIG92ZXJsYXlMYXllcnMsXG4gICAgICAgIGZ1bmN0aW9uKG92ZXJsYXlMYXllcikge1xuICAgICAgICAgIG92ZXJsYXlMYXllci5zdHlsZS5vcGFjaXR5ID0gMDtcbiAgICAgICAgICB3aW5kb3cuc2V0VGltZW91dChcbiAgICAgICAgICAgIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICBpZiAodGhpcy5wYXJlbnROb2RlKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHRoaXMpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LmJpbmQob3ZlcmxheUxheWVyKSxcbiAgICAgICAgICAgIDUwMFxuICAgICAgICAgICk7XG4gICAgICAgIH0uYmluZCh0aGlzKVxuICAgICAgKTtcbiAgICB9XG5cbiAgICAvL3JlbW92ZSBhbGwgaGVscGVyIGxheWVyc1xuICAgIHZhciBoZWxwZXJMYXllciA9IHRhcmdldEVsZW1lbnQucXVlcnlTZWxlY3RvcignLmludHJvanMtaGVscGVyTGF5ZXInKTtcbiAgICBpZiAoaGVscGVyTGF5ZXIpIHtcbiAgICAgIGhlbHBlckxheWVyLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoaGVscGVyTGF5ZXIpO1xuICAgIH1cblxuICAgIHZhciByZWZlcmVuY2VMYXllciA9IHRhcmdldEVsZW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgICcuaW50cm9qcy10b29sdGlwUmVmZXJlbmNlTGF5ZXInXG4gICAgKTtcbiAgICBpZiAocmVmZXJlbmNlTGF5ZXIpIHtcbiAgICAgIHJlZmVyZW5jZUxheWVyLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQocmVmZXJlbmNlTGF5ZXIpO1xuICAgIH1cblxuICAgIC8vcmVtb3ZlIGRpc2FibGVJbnRlcmFjdGlvbkxheWVyXG4gICAgdmFyIGRpc2FibGVJbnRlcmFjdGlvbkxheWVyID0gdGFyZ2V0RWxlbWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgJy5pbnRyb2pzLWRpc2FibGVJbnRlcmFjdGlvbidcbiAgICApO1xuICAgIGlmIChkaXNhYmxlSW50ZXJhY3Rpb25MYXllcikge1xuICAgICAgZGlzYWJsZUludGVyYWN0aW9uTGF5ZXIucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChkaXNhYmxlSW50ZXJhY3Rpb25MYXllcik7XG4gICAgfVxuXG4gICAgLy9yZW1vdmUgaW50cm8gZmxvYXRpbmcgZWxlbWVudFxuICAgIHZhciBmbG9hdGluZ0VsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuaW50cm9qc0Zsb2F0aW5nRWxlbWVudCcpO1xuICAgIGlmIChmbG9hdGluZ0VsZW1lbnQpIHtcbiAgICAgIGZsb2F0aW5nRWxlbWVudC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGZsb2F0aW5nRWxlbWVudCk7XG4gICAgfVxuXG4gICAgX3JlbW92ZVNob3dFbGVtZW50KCk7XG5cbiAgICAvL3JlbW92ZSBgaW50cm9qcy1maXhQYXJlbnRgIGNsYXNzIGZyb20gdGhlIGVsZW1lbnRzXG4gICAgdmFyIGZpeFBhcmVudHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuaW50cm9qcy1maXhQYXJlbnQnKTtcbiAgICBfZm9yRWFjaChmaXhQYXJlbnRzLCBmdW5jdGlvbihwYXJlbnQpIHtcbiAgICAgIF9yZW1vdmVDbGFzcyhwYXJlbnQsIC9pbnRyb2pzLWZpeFBhcmVudC9nKTtcbiAgICB9KTtcblxuICAgIC8vY2xlYW4gbGlzdGVuZXJzXG4gICAgRE9NRXZlbnQub2ZmKHdpbmRvdywgJ2tleWRvd24nLCBfb25LZXlEb3duLCB0aGlzLCB0cnVlKTtcbiAgICBET01FdmVudC5vZmYod2luZG93LCAncmVzaXplJywgX29uUmVzaXplLCB0aGlzLCB0cnVlKTtcblxuICAgIC8vY2hlY2sgaWYgYW55IGNhbGxiYWNrIGlzIGRlZmluZWRcbiAgICBpZiAodGhpcy5faW50cm9FeGl0Q2FsbGJhY2sgIT09IHVuZGVmaW5lZCkge1xuICAgICAgdGhpcy5faW50cm9FeGl0Q2FsbGJhY2suY2FsbCh0aGlzKTtcbiAgICB9XG5cbiAgICAvL3NldCB0aGUgc3RlcCB0byB6ZXJvXG4gICAgdGhpcy5fY3VycmVudFN0ZXAgPSB1bmRlZmluZWQ7XG4gIH1cblxuICAvKipcbiAgICogU2V0IHRvb2x0aXAgbGVmdCBzbyBpdCBkb2Vzbid0IGdvIG9mZiB0aGUgcmlnaHQgc2lkZSBvZiB0aGUgd2luZG93XG4gICAqXG4gICAqIEByZXR1cm4gYm9vbGVhbiB0cnVlLCBpZiB0b29sdGlwTGF5ZXJTdHlsZUxlZnQgaXMgb2suICBmYWxzZSwgb3RoZXJ3aXNlLlxuICAgKi9cbiAgZnVuY3Rpb24gX2NoZWNrUmlnaHQoXG4gICAgdGFyZ2V0T2Zmc2V0LFxuICAgIHRvb2x0aXBMYXllclN0eWxlTGVmdCxcbiAgICB0b29sdGlwT2Zmc2V0LFxuICAgIHdpbmRvd1NpemUsXG4gICAgdG9vbHRpcExheWVyXG4gICkge1xuICAgIGlmIChcbiAgICAgIHRhcmdldE9mZnNldC5sZWZ0ICsgdG9vbHRpcExheWVyU3R5bGVMZWZ0ICsgdG9vbHRpcE9mZnNldC53aWR0aCA+XG4gICAgICB3aW5kb3dTaXplLndpZHRoXG4gICAgKSB7XG4gICAgICAvLyBvZmYgdGhlIHJpZ2h0IHNpZGUgb2YgdGhlIHdpbmRvd1xuICAgICAgdG9vbHRpcExheWVyLnN0eWxlLmxlZnQgPVxuICAgICAgICB3aW5kb3dTaXplLndpZHRoIC0gdG9vbHRpcE9mZnNldC53aWR0aCAtIHRhcmdldE9mZnNldC5sZWZ0ICsgJ3B4JztcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgdG9vbHRpcExheWVyLnN0eWxlLmxlZnQgPSB0b29sdGlwTGF5ZXJTdHlsZUxlZnQgKyAncHgnO1xuICAgIHJldHVybiB0cnVlO1xuICB9XG5cbiAgLyoqXG4gICAqIFNldCB0b29sdGlwIHJpZ2h0IHNvIGl0IGRvZXNuJ3QgZ28gb2ZmIHRoZSBsZWZ0IHNpZGUgb2YgdGhlIHdpbmRvd1xuICAgKlxuICAgKiBAcmV0dXJuIGJvb2xlYW4gdHJ1ZSwgaWYgdG9vbHRpcExheWVyU3R5bGVSaWdodCBpcyBvay4gIGZhbHNlLCBvdGhlcndpc2UuXG4gICAqL1xuICBmdW5jdGlvbiBfY2hlY2tMZWZ0KFxuICAgIHRhcmdldE9mZnNldCxcbiAgICB0b29sdGlwTGF5ZXJTdHlsZVJpZ2h0LFxuICAgIHRvb2x0aXBPZmZzZXQsXG4gICAgdG9vbHRpcExheWVyXG4gICkge1xuICAgIGlmIChcbiAgICAgIHRhcmdldE9mZnNldC5sZWZ0ICtcbiAgICAgICAgdGFyZ2V0T2Zmc2V0LndpZHRoIC1cbiAgICAgICAgdG9vbHRpcExheWVyU3R5bGVSaWdodCAtXG4gICAgICAgIHRvb2x0aXBPZmZzZXQud2lkdGggPFxuICAgICAgMFxuICAgICkge1xuICAgICAgLy8gb2ZmIHRoZSBsZWZ0IHNpZGUgb2YgdGhlIHdpbmRvd1xuICAgICAgdG9vbHRpcExheWVyLnN0eWxlLmxlZnQgPSAtdGFyZ2V0T2Zmc2V0LmxlZnQgKyAncHgnO1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICB0b29sdGlwTGF5ZXIuc3R5bGUucmlnaHQgPSB0b29sdGlwTGF5ZXJTdHlsZVJpZ2h0ICsgJ3B4JztcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxuXG4gIC8qKlxuICAgKiBEZXRlcm1pbmVzIHRoZSBwb3NpdGlvbiBvZiB0aGUgdG9vbHRpcCBiYXNlZCBvbiB0aGUgcG9zaXRpb24gcHJlY2VkZW5jZSBhbmQgYXZhaWxhYmlsaXR5XG4gICAqIG9mIHNjcmVlbiBzcGFjZS5cbiAgICpcbiAgICogQHBhcmFtIHtPYmplY3R9ICAgIHRhcmdldEVsZW1lbnRcbiAgICogQHBhcmFtIHtPYmplY3R9ICAgIHRvb2x0aXBMYXllclxuICAgKiBAcGFyYW0ge1N0cmluZ30gICAgZGVzaXJlZFRvb2x0aXBQb3NpdGlvblxuICAgKiBAcmV0dXJuIHtTdHJpbmd9ICAgY2FsY3VsYXRlZFBvc2l0aW9uXG4gICAqL1xuICBmdW5jdGlvbiBfZGV0ZXJtaW5lQXV0b1Bvc2l0aW9uKFxuICAgIHRhcmdldEVsZW1lbnQsXG4gICAgdG9vbHRpcExheWVyLFxuICAgIGRlc2lyZWRUb29sdGlwUG9zaXRpb25cbiAgKSB7XG4gICAgLy8gVGFrZSBhIGNsb25lIG9mIHBvc2l0aW9uIHByZWNlZGVuY2UuIFRoZXNlIHdpbGwgYmUgdGhlIGF2YWlsYWJsZVxuICAgIHZhciBwb3NzaWJsZVBvc2l0aW9ucyA9IHRoaXMuX29wdGlvbnMucG9zaXRpb25QcmVjZWRlbmNlLnNsaWNlKCk7XG5cbiAgICB2YXIgd2luZG93U2l6ZSA9IF9nZXRXaW5TaXplKCk7XG4gICAgdmFyIHRvb2x0aXBIZWlnaHQgPSBfZ2V0T2Zmc2V0KHRvb2x0aXBMYXllcikuaGVpZ2h0ICsgMTA7XG4gICAgdmFyIHRvb2x0aXBXaWR0aCA9IF9nZXRPZmZzZXQodG9vbHRpcExheWVyKS53aWR0aCArIDIwO1xuICAgIHZhciB0YXJnZXRFbGVtZW50UmVjdCA9IHRhcmdldEVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG5cbiAgICAvLyBJZiB3ZSBjaGVjayBhbGwgdGhlIHBvc3NpYmxlIGFyZWFzLCBhbmQgdGhlcmUgYXJlIG5vIHZhbGlkIHBsYWNlcyBmb3IgdGhlIHRvb2x0aXAsIHRoZSBlbGVtZW50XG4gICAgLy8gbXVzdCB0YWtlIHVwIG1vc3Qgb2YgdGhlIHNjcmVlbiByZWFsIGVzdGF0ZS4gU2hvdyB0aGUgdG9vbHRpcCBmbG9hdGluZyBpbiB0aGUgbWlkZGxlIG9mIHRoZSBzY3JlZW4uXG4gICAgdmFyIGNhbGN1bGF0ZWRQb3NpdGlvbiA9ICdmbG9hdGluZyc7XG5cbiAgICAvKlxuICAgICAqIGF1dG8gZGV0ZXJtaW5lIHBvc2l0aW9uXG4gICAgICovXG5cbiAgICAvLyBDaGVjayBmb3Igc3BhY2UgYmVsb3dcbiAgICBpZiAoXG4gICAgICB0YXJnZXRFbGVtZW50UmVjdC5ib3R0b20gKyB0b29sdGlwSGVpZ2h0ICsgdG9vbHRpcEhlaWdodCA+XG4gICAgICB3aW5kb3dTaXplLmhlaWdodFxuICAgICkge1xuICAgICAgX3JlbW92ZUVudHJ5KHBvc3NpYmxlUG9zaXRpb25zLCAnYm90dG9tJyk7XG4gICAgfVxuXG4gICAgLy8gQ2hlY2sgZm9yIHNwYWNlIGFib3ZlXG4gICAgaWYgKHRhcmdldEVsZW1lbnRSZWN0LnRvcCAtIHRvb2x0aXBIZWlnaHQgPCAwKSB7XG4gICAgICBfcmVtb3ZlRW50cnkocG9zc2libGVQb3NpdGlvbnMsICd0b3AnKTtcbiAgICB9XG5cbiAgICAvLyBDaGVjayBmb3Igc3BhY2UgdG8gdGhlIHJpZ2h0XG4gICAgaWYgKHRhcmdldEVsZW1lbnRSZWN0LnJpZ2h0ICsgdG9vbHRpcFdpZHRoID4gd2luZG93U2l6ZS53aWR0aCkge1xuICAgICAgX3JlbW92ZUVudHJ5KHBvc3NpYmxlUG9zaXRpb25zLCAncmlnaHQnKTtcbiAgICB9XG5cbiAgICAvLyBDaGVjayBmb3Igc3BhY2UgdG8gdGhlIGxlZnRcbiAgICBpZiAodGFyZ2V0RWxlbWVudFJlY3QubGVmdCAtIHRvb2x0aXBXaWR0aCA8IDApIHtcbiAgICAgIF9yZW1vdmVFbnRyeShwb3NzaWJsZVBvc2l0aW9ucywgJ2xlZnQnKTtcbiAgICB9XG5cbiAgICAvLyBAdmFyIHtTdHJpbmd9ICBleDogJ3JpZ2h0LWFsaWduZWQnXG4gICAgdmFyIGRlc2lyZWRBbGlnbm1lbnQgPSAoZnVuY3Rpb24ocG9zKSB7XG4gICAgICB2YXIgaHlwaGVuSW5kZXggPSBwb3MuaW5kZXhPZignLScpO1xuICAgICAgaWYgKGh5cGhlbkluZGV4ICE9PSAtMSkge1xuICAgICAgICAvLyBoYXMgYWxpZ25tZW50XG4gICAgICAgIHJldHVybiBwb3Muc3Vic3RyKGh5cGhlbkluZGV4KTtcbiAgICAgIH1cbiAgICAgIHJldHVybiAnJztcbiAgICB9KShkZXNpcmVkVG9vbHRpcFBvc2l0aW9uIHx8ICcnKTtcblxuICAgIC8vIHN0cmlwIGFsaWdubWVudCBmcm9tIHBvc2l0aW9uXG4gICAgaWYgKGRlc2lyZWRUb29sdGlwUG9zaXRpb24pIHtcbiAgICAgIC8vIGV4OiBcImJvdHRvbS1yaWdodC1hbGlnbmVkXCJcbiAgICAgIC8vIHNob3VsZCByZXR1cm4gJ2JvdHRvbSdcbiAgICAgIGRlc2lyZWRUb29sdGlwUG9zaXRpb24gPSBkZXNpcmVkVG9vbHRpcFBvc2l0aW9uLnNwbGl0KCctJylbMF07XG4gICAgfVxuXG4gICAgaWYgKHBvc3NpYmxlUG9zaXRpb25zLmxlbmd0aCkge1xuICAgICAgaWYgKFxuICAgICAgICBkZXNpcmVkVG9vbHRpcFBvc2l0aW9uICE9PSAnYXV0bycgJiZcbiAgICAgICAgcG9zc2libGVQb3NpdGlvbnMuaW5kZXhPZihkZXNpcmVkVG9vbHRpcFBvc2l0aW9uKSA+IC0xXG4gICAgICApIHtcbiAgICAgICAgLy8gSWYgdGhlIHJlcXVlc3RlZCBwb3NpdGlvbiBpcyBpbiB0aGUgbGlzdCwgY2hvb3NlIHRoYXRcbiAgICAgICAgY2FsY3VsYXRlZFBvc2l0aW9uID0gZGVzaXJlZFRvb2x0aXBQb3NpdGlvbjtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIFBpY2sgdGhlIGZpcnN0IHZhbGlkIHBvc2l0aW9uLCBpbiBvcmRlclxuICAgICAgICBjYWxjdWxhdGVkUG9zaXRpb24gPSBwb3NzaWJsZVBvc2l0aW9uc1swXTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBvbmx5IHRvcCBhbmQgYm90dG9tIHBvc2l0aW9ucyBoYXZlIG9wdGlvbmFsIGFsaWdubWVudHNcbiAgICBpZiAoWyd0b3AnLCAnYm90dG9tJ10uaW5kZXhPZihjYWxjdWxhdGVkUG9zaXRpb24pICE9PSAtMSkge1xuICAgICAgY2FsY3VsYXRlZFBvc2l0aW9uICs9IF9kZXRlcm1pbmVBdXRvQWxpZ25tZW50KFxuICAgICAgICB0YXJnZXRFbGVtZW50UmVjdC5sZWZ0LFxuICAgICAgICB0b29sdGlwV2lkdGgsXG4gICAgICAgIHdpbmRvd1NpemUsXG4gICAgICAgIGRlc2lyZWRBbGlnbm1lbnRcbiAgICAgICk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGNhbGN1bGF0ZWRQb3NpdGlvbjtcbiAgfVxuXG4gIC8qKlxuICAgKiBhdXRvLWRldGVybWluZSBhbGlnbm1lbnRcbiAgICogQHBhcmFtIHtJbnRlZ2VyfSAgb2Zmc2V0TGVmdFxuICAgKiBAcGFyYW0ge0ludGVnZXJ9ICB0b29sdGlwV2lkdGhcbiAgICogQHBhcmFtIHtPYmplY3R9ICAgd2luZG93U2l6ZVxuICAgKiBAcGFyYW0ge1N0cmluZ30gICBkZXNpcmVkQWxpZ25tZW50XG4gICAqIEByZXR1cm4ge1N0cmluZ30gIGNhbGN1bGF0ZWRBbGlnbm1lbnRcbiAgICovXG4gIGZ1bmN0aW9uIF9kZXRlcm1pbmVBdXRvQWxpZ25tZW50KFxuICAgIG9mZnNldExlZnQsXG4gICAgdG9vbHRpcFdpZHRoLFxuICAgIHdpbmRvd1NpemUsXG4gICAgZGVzaXJlZEFsaWdubWVudFxuICApIHtcbiAgICB2YXIgaGFsZlRvb2x0aXBXaWR0aCA9IHRvb2x0aXBXaWR0aCAvIDIsXG4gICAgICB3aW5XaWR0aCA9IE1hdGgubWluKHdpbmRvd1NpemUud2lkdGgsIHdpbmRvdy5zY3JlZW4ud2lkdGgpLFxuICAgICAgcG9zc2libGVBbGlnbm1lbnRzID0gW1xuICAgICAgICAnLWxlZnQtYWxpZ25lZCcsXG4gICAgICAgICctbWlkZGxlLWFsaWduZWQnLFxuICAgICAgICAnLXJpZ2h0LWFsaWduZWQnXG4gICAgICBdLFxuICAgICAgY2FsY3VsYXRlZEFsaWdubWVudCA9ICcnO1xuXG4gICAgLy8gdmFsaWQgbGVmdCBtdXN0IGJlIGF0IGxlYXN0IGEgdG9vbHRpcFdpZHRoXG4gICAgLy8gYXdheSBmcm9tIHJpZ2h0IHNpZGVcbiAgICBpZiAod2luV2lkdGggLSBvZmZzZXRMZWZ0IDwgdG9vbHRpcFdpZHRoKSB7XG4gICAgICBfcmVtb3ZlRW50cnkocG9zc2libGVBbGlnbm1lbnRzLCAnLWxlZnQtYWxpZ25lZCcpO1xuICAgIH1cblxuICAgIC8vIHZhbGlkIG1pZGRsZSBtdXN0IGJlIGF0IGxlYXN0IGhhbGZcbiAgICAvLyB3aWR0aCBhd2F5IGZyb20gYm90aCBzaWRlc1xuICAgIGlmIChcbiAgICAgIG9mZnNldExlZnQgPCBoYWxmVG9vbHRpcFdpZHRoIHx8XG4gICAgICB3aW5XaWR0aCAtIG9mZnNldExlZnQgPCBoYWxmVG9vbHRpcFdpZHRoXG4gICAgKSB7XG4gICAgICBfcmVtb3ZlRW50cnkocG9zc2libGVBbGlnbm1lbnRzLCAnLW1pZGRsZS1hbGlnbmVkJyk7XG4gICAgfVxuXG4gICAgLy8gdmFsaWQgcmlnaHQgbXVzdCBiZSBhdCBsZWFzdCBhIHRvb2x0aXBXaWR0aFxuICAgIC8vIHdpZHRoIGF3YXkgZnJvbSBsZWZ0IHNpZGVcbiAgICBpZiAob2Zmc2V0TGVmdCA8IHRvb2x0aXBXaWR0aCkge1xuICAgICAgX3JlbW92ZUVudHJ5KHBvc3NpYmxlQWxpZ25tZW50cywgJy1yaWdodC1hbGlnbmVkJyk7XG4gICAgfVxuXG4gICAgaWYgKHBvc3NpYmxlQWxpZ25tZW50cy5sZW5ndGgpIHtcbiAgICAgIGlmIChwb3NzaWJsZUFsaWdubWVudHMuaW5kZXhPZihkZXNpcmVkQWxpZ25tZW50KSAhPT0gLTEpIHtcbiAgICAgICAgLy8gdGhlIGRlc2lyZWQgYWxpZ25tZW50IGlzIHZhbGlkXG4gICAgICAgIGNhbGN1bGF0ZWRBbGlnbm1lbnQgPSBkZXNpcmVkQWxpZ25tZW50O1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8gcGljayB0aGUgZmlyc3QgdmFsaWQgcG9zaXRpb24sIGluIG9yZGVyXG4gICAgICAgIGNhbGN1bGF0ZWRBbGlnbm1lbnQgPSBwb3NzaWJsZUFsaWdubWVudHNbMF07XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIGlmIHNjcmVlbiB3aWR0aCBpcyB0b28gc21hbGxcbiAgICAgIC8vIGZvciBBTlkgYWxpZ25tZW50LCBtaWRkbGUgaXNcbiAgICAgIC8vIHByb2JhYmx5IHRoZSBiZXN0IGZvciB2aXNpYmlsaXR5XG4gICAgICBjYWxjdWxhdGVkQWxpZ25tZW50ID0gJy1taWRkbGUtYWxpZ25lZCc7XG4gICAgfVxuXG4gICAgcmV0dXJuIGNhbGN1bGF0ZWRBbGlnbm1lbnQ7XG4gIH1cblxuICAvKipcbiAgICogUmVtb3ZlIGFuIGVudHJ5IGZyb20gYSBzdHJpbmcgYXJyYXkgaWYgaXQncyB0aGVyZSwgZG9lcyBub3RoaW5nIGlmIGl0IGlzbid0IHRoZXJlLlxuICAgKlxuICAgKiBAcGFyYW0ge0FycmF5fSBzdHJpbmdBcnJheVxuICAgKiBAcGFyYW0ge1N0cmluZ30gc3RyaW5nVG9SZW1vdmVcbiAgICovXG4gIGZ1bmN0aW9uIF9yZW1vdmVFbnRyeShzdHJpbmdBcnJheSwgc3RyaW5nVG9SZW1vdmUpIHtcbiAgICBpZiAoc3RyaW5nQXJyYXkuaW5kZXhPZihzdHJpbmdUb1JlbW92ZSkgPiAtMSkge1xuICAgICAgc3RyaW5nQXJyYXkuc3BsaWNlKHN0cmluZ0FycmF5LmluZGV4T2Yoc3RyaW5nVG9SZW1vdmUpLCAxKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogVXBkYXRlIHRoZSBwb3NpdGlvbiBvZiB0aGUgaGVscGVyIGxheWVyIG9uIHRoZSBzY3JlZW5cbiAgICpcbiAgICogQGFwaSBwcml2YXRlXG4gICAqIEBtZXRob2QgX3NldEhlbHBlckxheWVyUG9zaXRpb25cbiAgICogQHBhcmFtIHtPYmplY3R9IGhlbHBlckxheWVyXG4gICAqL1xuICBmdW5jdGlvbiBfc2V0SGVscGVyTGF5ZXJQb3NpdGlvbihoZWxwZXJMYXllcikge1xuICAgIGlmIChoZWxwZXJMYXllcikge1xuICAgICAgLy9wcmV2ZW50IGVycm9yIHdoZW4gYHRoaXMuX2N1cnJlbnRTdGVwYCBpbiB1bmRlZmluZWRcbiAgICAgIGlmICghdGhpcy5faW50cm9JdGVtc1t0aGlzLl9jdXJyZW50U3RlcF0pIHJldHVybjtcblxuICAgICAgdmFyIGN1cnJlbnRFbGVtZW50ID0gdGhpcy5faW50cm9JdGVtc1t0aGlzLl9jdXJyZW50U3RlcF0sXG4gICAgICAgIGVsZW1lbnRQb3NpdGlvbiA9IF9nZXRPZmZzZXQoY3VycmVudEVsZW1lbnQuZWxlbWVudCksXG4gICAgICAgIHdpZHRoSGVpZ2h0UGFkZGluZyA9IHRoaXMuX29wdGlvbnMuaGVscGVyRWxlbWVudFBhZGRpbmc7XG5cbiAgICAgIC8vIElmIHRoZSB0YXJnZXQgZWxlbWVudCBpcyBmaXhlZCwgdGhlIHRvb2x0aXAgc2hvdWxkIGJlIGZpeGVkIGFzIHdlbGwuXG4gICAgICAvLyBPdGhlcndpc2UsIHJlbW92ZSBhIGZpeGVkIGNsYXNzIHRoYXQgbWF5IGJlIGxlZnQgb3ZlciBmcm9tIHRoZSBwcmV2aW91c1xuICAgICAgLy8gc3RlcC5cbiAgICAgIGlmIChfaXNGaXhlZChjdXJyZW50RWxlbWVudC5lbGVtZW50KSkge1xuICAgICAgICBfYWRkQ2xhc3MoaGVscGVyTGF5ZXIsICdpbnRyb2pzLWZpeGVkVG9vbHRpcCcpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgX3JlbW92ZUNsYXNzKGhlbHBlckxheWVyLCAnaW50cm9qcy1maXhlZFRvb2x0aXAnKTtcbiAgICAgIH1cblxuICAgICAgaWYgKGN1cnJlbnRFbGVtZW50LnBvc2l0aW9uID09PSAnZmxvYXRpbmcnKSB7XG4gICAgICAgIHdpZHRoSGVpZ2h0UGFkZGluZyA9IDA7XG4gICAgICB9XG5cbiAgICAgIC8vc2V0IG5ldyBwb3NpdGlvbiB0byBoZWxwZXIgbGF5ZXJcbiAgICAgIGhlbHBlckxheWVyLnN0eWxlLmNzc1RleHQgPVxuICAgICAgICAnd2lkdGg6ICcgK1xuICAgICAgICAoZWxlbWVudFBvc2l0aW9uLndpZHRoICsgd2lkdGhIZWlnaHRQYWRkaW5nKSArXG4gICAgICAgICdweDsgJyArXG4gICAgICAgICdoZWlnaHQ6JyArXG4gICAgICAgIChlbGVtZW50UG9zaXRpb24uaGVpZ2h0ICsgd2lkdGhIZWlnaHRQYWRkaW5nKSArXG4gICAgICAgICdweDsgJyArXG4gICAgICAgICd0b3A6JyArXG4gICAgICAgIChlbGVtZW50UG9zaXRpb24udG9wIC0gd2lkdGhIZWlnaHRQYWRkaW5nIC8gMikgK1xuICAgICAgICAncHg7JyArXG4gICAgICAgICdsZWZ0OiAnICtcbiAgICAgICAgKGVsZW1lbnRQb3NpdGlvbi5sZWZ0IC0gd2lkdGhIZWlnaHRQYWRkaW5nIC8gMikgK1xuICAgICAgICAncHg7JztcblxuICAgICAgd2luZG93LnNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICBfc2V0Q2xpcFBhdGhPZkhlbHBlci5jYWxsKHRoaXMsIGhlbHBlckxheWVyKTtcbiAgICAgIH0sIDM1KTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQWRkIGRpc2FibGVpbnRlcmFjdGlvbiBsYXllciBhbmQgYWRqdXN0IHRoZSBzaXplIGFuZCBwb3NpdGlvbiBvZiB0aGUgbGF5ZXJcbiAgICpcbiAgICogQGFwaSBwcml2YXRlXG4gICAqIEBtZXRob2QgX2Rpc2FibGVJbnRlcmFjdGlvblxuICAgKi9cbiAgZnVuY3Rpb24gX2Rpc2FibGVJbnRlcmFjdGlvbigpIHtcbiAgICB2YXIgZGlzYWJsZUludGVyYWN0aW9uTGF5ZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgJy5pbnRyb2pzLWRpc2FibGVJbnRlcmFjdGlvbidcbiAgICApO1xuXG4gICAgaWYgKGRpc2FibGVJbnRlcmFjdGlvbkxheWVyID09PSBudWxsKSB7XG4gICAgICBkaXNhYmxlSW50ZXJhY3Rpb25MYXllciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgZGlzYWJsZUludGVyYWN0aW9uTGF5ZXIuY2xhc3NOYW1lID0gJ2ludHJvanMtZGlzYWJsZUludGVyYWN0aW9uJztcbiAgICAgIHRoaXMuX3RhcmdldEVsZW1lbnQuYXBwZW5kQ2hpbGQoZGlzYWJsZUludGVyYWN0aW9uTGF5ZXIpO1xuICAgIH1cblxuICAgIF9zZXRIZWxwZXJMYXllclBvc2l0aW9uLmNhbGwodGhpcywgZGlzYWJsZUludGVyYWN0aW9uTGF5ZXIpO1xuICB9XG5cbiAgLyoqXG4gICAqIFNldHRpbmcgYW5jaG9ycyB0byBiZWhhdmUgbGlrZSBidXR0b25zXG4gICAqXG4gICAqIEBhcGkgcHJpdmF0ZVxuICAgKiBAbWV0aG9kIF9zZXRBbmNob3JBc0J1dHRvblxuICAgKi9cbiAgZnVuY3Rpb24gX3NldEFuY2hvckFzQnV0dG9uKGFuY2hvcikge1xuICAgIGFuY2hvci5zZXRBdHRyaWJ1dGUoJ3JvbGUnLCAnYnV0dG9uJyk7XG4gICAgYW5jaG9yLnRhYkluZGV4ID0gMDtcbiAgfVxuXG4gIC8qKlxuICAgKiBAYXBpIHByaXZhdGVcbiAgICogQG1ldGhvZCBfZ2V0RGltZW5zaW9uc1xuICAgKi9cbiAgZnVuY3Rpb24gX2dldERpbWVuc2lvbnMoaGVscGVyKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHdpZHRoOiBoZWxwZXIub2Zmc2V0V2lkdGgsXG4gICAgICBoZWlnaHQ6IGhlbHBlci5vZmZzZXRIZWlnaHQsXG4gICAgICBsZWZ0OiBoZWxwZXIub2Zmc2V0TGVmdCxcbiAgICAgIHRvcDogaGVscGVyLm9mZnNldFRvcFxuICAgIH07XG4gIH1cblxuICAvKipcbiAgICogQGFwaSBwcml2YXRlXG4gICAqIEBtZXRob2QgX3NldENsaXBQYXRoT2ZIZWxwZXJcbiAgICovXG4gIGZ1bmN0aW9uIF9zZXRDbGlwUGF0aE9mSGVscGVyKGhlbHBlckxheWVyKSB7XG4gICAgLy8g0LrQvtGB0YLRi9C70YwgY29uc3Qgc3RlcCA9IHRoaXMuX2ludHJvSXRlbXNbdGhpcy5fY3VycmVudFN0ZXBdO1xuICAgIGNvbnN0IHN0ZXAgPSB0aGlzLl9pbnRyb0l0ZW1zWzBdO1xuICAgIFxuICAgIGNvbnN0IG92ZXJsYXkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuaW50cm9qcy1vdmVybGF5Jyk7XG4gICAgaWYgKHN0ZXAuZml4ZWQpIHtcbiAgICAgIGNvbnN0IHsgd2lkdGgsIGhlaWdodCwgbGVmdCwgdG9wIH0gPSBfZ2V0RGltZW5zaW9ucy5jYWxsKFxuICAgICAgICB0aGlzLFxuICAgICAgICBoZWxwZXJMYXllclxuICAgICAgKTtcbiAgICAgIGNvbnN0IGNvb3JkcyA9IFtcbiAgICAgICAge1xuICAgICAgICAgIHg6ICcwJScsXG4gICAgICAgICAgeTogJzAlJ1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgeDogJzAlJyxcbiAgICAgICAgICB5OiAnMTAwJSdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgIHg6IGxlZnQgKyAncHgnLFxuICAgICAgICAgIHk6ICcxMDAlJ1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgeDogbGVmdCArICdweCcsXG4gICAgICAgICAgeTogdG9wICsgJ3B4J1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgeDogbGVmdCArIHdpZHRoICsgJ3B4JyxcbiAgICAgICAgICB5OiB0b3AgKyAncHgnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICB4OiBsZWZ0ICsgd2lkdGggKyAncHgnLFxuICAgICAgICAgIHk6IHRvcCArIGhlaWdodCArICdweCdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgIHg6IGxlZnQgKyAncHgnLFxuICAgICAgICAgIHk6IHRvcCArIGhlaWdodCArICdweCdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgIHg6IGxlZnQgKyAncHgnLFxuICAgICAgICAgIHk6ICcxMDAlJ1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgeDogJzEwMCUnLFxuICAgICAgICAgIHk6ICcxMDAlJ1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgeDogJzEwMCUnLFxuICAgICAgICAgIHk6ICcwJSdcbiAgICAgICAgfVxuICAgICAgXTtcblxuICAgICAgaWYgKG92ZXJsYXkpIHtcbiAgICAgICAgb3ZlcmxheS5zdHlsZS5jbGlwUGF0aCA9IGBwb2x5Z29uKCR7Y29vcmRzXG4gICAgICAgICAgLm1hcCgoeyB4LCB5IH0pID0+IHggKyAnICcgKyB5KVxuICAgICAgICAgIC5qb2luKCcsICcpfSlgO1xuICAgICAgfVxuXG4gICAgICBoZWxwZXJMYXllci5zdHlsZS52aXNpYmlsaXR5ID0gJ2hpZGRlbic7XG4gICAgfSBlbHNlIHtcbiAgICAgIG92ZXJsYXkuc3R5bGUuY2xpcFBhdGggPSAnJztcbiAgICAgIGhlbHBlckxheWVyLnN0eWxlLnZpc2liaWxpdHkgPSAndmlzaWJsZSc7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFNob3cgYW4gZWxlbWVudCBvbiB0aGUgcGFnZVxuICAgKlxuICAgKiBAYXBpIHByaXZhdGVcbiAgICogQG1ldGhvZCBfc2hvd0VsZW1lbnRcbiAgICogQHBhcmFtIHtPYmplY3R9IHRhcmdldEVsZW1lbnRcbiAgICovXG4gIGZ1bmN0aW9uIF9zaG93RWxlbWVudCh0YXJnZXRFbGVtZW50KSB7XG4gICAgaWYgKHR5cGVvZiB0aGlzLl9pbnRyb0NoYW5nZUNhbGxiYWNrICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgdGhpcy5faW50cm9DaGFuZ2VDYWxsYmFjay5jYWxsKHRoaXMsIHRhcmdldEVsZW1lbnQuZWxlbWVudCk7XG4gICAgfVxuXG4gICAgdmFyIHNlbGYgPSB0aGlzLFxuICAgICAgb2xkSGVscGVyTGF5ZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuaW50cm9qcy1oZWxwZXJMYXllcicpLFxuICAgICAgb2xkUmVmZXJlbmNlTGF5ZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgICAnLmludHJvanMtdG9vbHRpcFJlZmVyZW5jZUxheWVyJ1xuICAgICAgKSxcbiAgICAgIGhpZ2hsaWdodENsYXNzID0gJ2ludHJvanMtaGVscGVyTGF5ZXInLFxuICAgICAgc2Nyb2xsUGFyZW50O1xuXG4gICAgLy9jaGVjayBmb3IgYSBjdXJyZW50IHN0ZXAgaGlnaGxpZ2h0IGNsYXNzXG4gICAgaWYgKHR5cGVvZiB0YXJnZXRFbGVtZW50LmhpZ2hsaWdodENsYXNzID09PSAnc3RyaW5nJykge1xuICAgICAgaGlnaGxpZ2h0Q2xhc3MgKz0gJyAnICsgdGFyZ2V0RWxlbWVudC5oaWdobGlnaHRDbGFzcztcbiAgICB9XG4gICAgLy9jaGVjayBmb3Igb3B0aW9ucyBoaWdobGlnaHQgY2xhc3NcbiAgICBpZiAodHlwZW9mIHRoaXMuX29wdGlvbnMuaGlnaGxpZ2h0Q2xhc3MgPT09ICdzdHJpbmcnKSB7XG4gICAgICBoaWdobGlnaHRDbGFzcyArPSAnICcgKyB0aGlzLl9vcHRpb25zLmhpZ2hsaWdodENsYXNzO1xuICAgIH1cblxuICAgIGlmIChvbGRIZWxwZXJMYXllciAhPT0gbnVsbCkge1xuICAgICAgXG5cbiAgICAgIC8vIHNjcm9sbCB0byBlbGVtZW50XG4gICAgICBzY3JvbGxQYXJlbnQgPSBfZ2V0U2Nyb2xsUGFyZW50KHRhcmdldEVsZW1lbnQuZWxlbWVudCk7XG5cbiAgICAgIGlmIChzY3JvbGxQYXJlbnQgIT09IGRvY3VtZW50LmJvZHkpIHtcbiAgICAgICAgLy8gdGFyZ2V0IGlzIHdpdGhpbiBhIHNjcm9sbGFibGUgZWxlbWVudFxuICAgICAgICBfc2Nyb2xsUGFyZW50VG9FbGVtZW50KHNjcm9sbFBhcmVudCwgdGFyZ2V0RWxlbWVudC5lbGVtZW50KTtcbiAgICAgIH1cblxuICAgICAgLy8gc2V0IG5ldyBwb3NpdGlvbiB0byBoZWxwZXIgbGF5ZXJcbiAgICAgIF9zZXRIZWxwZXJMYXllclBvc2l0aW9uLmNhbGwoc2VsZiwgb2xkSGVscGVyTGF5ZXIpO1xuICAgICAgX3NldEhlbHBlckxheWVyUG9zaXRpb24uY2FsbChzZWxmLCBvbGRSZWZlcmVuY2VMYXllcik7XG5cbiAgICAgIC8vcmVtb3ZlIGBpbnRyb2pzLWZpeFBhcmVudGAgY2xhc3MgZnJvbSB0aGUgZWxlbWVudHNcbiAgICAgIHZhciBmaXhQYXJlbnRzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmludHJvanMtZml4UGFyZW50Jyk7XG4gICAgICBfZm9yRWFjaChmaXhQYXJlbnRzLCBmdW5jdGlvbihwYXJlbnQpIHtcbiAgICAgICAgX3JlbW92ZUNsYXNzKHBhcmVudCwgL2ludHJvanMtZml4UGFyZW50L2cpO1xuICAgICAgfSk7XG5cbiAgICAgIC8vcmVtb3ZlIG9sZCBjbGFzc2VzIGlmIHRoZSBlbGVtZW50IHN0aWxsIGV4aXN0XG4gICAgICBfcmVtb3ZlU2hvd0VsZW1lbnQoKTtcblxuICAgICAgLy93ZSBzaG91bGQgd2FpdCB1bnRpbCB0aGUgQ1NTMyB0cmFuc2l0aW9uIGlzIGNvbXBldGVkIChpdCdzIDAuMyBzZWMpIHRvIHByZXZlbnQgaW5jb3JyZWN0IGBoZWlnaHRgIGFuZCBgd2lkdGhgIGNhbGN1bGF0aW9uXG4gICAgICBpZiAoc2VsZi5fbGFzdFNob3dFbGVtZW50VGltZXIpIHtcbiAgICAgICAgd2luZG93LmNsZWFyVGltZW91dChzZWxmLl9sYXN0U2hvd0VsZW1lbnRUaW1lcik7XG4gICAgICB9XG5cbiAgICAgIHNlbGYuX2xhc3RTaG93RWxlbWVudFRpbWVyID0gd2luZG93LnNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgIC8vIGNoYW5nZSB0aGUgc2Nyb2xsIG9mIHRoZSB3aW5kb3csIGlmIG5lZWRlZFxuICAgICAgICBfc2Nyb2xsVG8uY2FsbChzZWxmLCB0YXJnZXRFbGVtZW50LnNjcm9sbFRvLCB0YXJnZXRFbGVtZW50KTtcbiAgICAgIH0sIDM1MCk7XG5cbiAgICAgIC8vIGVuZCBvZiBvbGQgZWxlbWVudCBpZi1lbHNlIGNvbmRpdGlvblxuICAgIH0gZWxzZSB7XG4gICAgICB2YXIgaGVscGVyTGF5ZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKSxcbiAgICAgICAgcmVmZXJlbmNlTGF5ZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcblxuICAgICAgaGVscGVyTGF5ZXIuY2xhc3NOYW1lID0gaGlnaGxpZ2h0Q2xhc3M7XG4gICAgICByZWZlcmVuY2VMYXllci5jbGFzc05hbWUgPSAnaW50cm9qcy10b29sdGlwUmVmZXJlbmNlTGF5ZXInO1xuXG4gICAgICAvLyBzY3JvbGwgdG8gZWxlbWVudFxuICAgICAgc2Nyb2xsUGFyZW50ID0gX2dldFNjcm9sbFBhcmVudCh0YXJnZXRFbGVtZW50LmVsZW1lbnQpO1xuXG4gICAgICBpZiAoc2Nyb2xsUGFyZW50ICE9PSBkb2N1bWVudC5ib2R5KSB7XG4gICAgICAgIC8vIHRhcmdldCBpcyB3aXRoaW4gYSBzY3JvbGxhYmxlIGVsZW1lbnRcbiAgICAgICAgX3Njcm9sbFBhcmVudFRvRWxlbWVudChzY3JvbGxQYXJlbnQsIHRhcmdldEVsZW1lbnQuZWxlbWVudCk7XG4gICAgICB9XG5cbiAgICAgIC8vc2V0IG5ldyBwb3NpdGlvbiB0byBoZWxwZXIgbGF5ZXJcbiAgICAgIF9zZXRIZWxwZXJMYXllclBvc2l0aW9uLmNhbGwoc2VsZiwgaGVscGVyTGF5ZXIpO1xuICAgICAgX3NldEhlbHBlckxheWVyUG9zaXRpb24uY2FsbChzZWxmLCByZWZlcmVuY2VMYXllcik7XG5cbiAgICAgIC8vYWRkIGhlbHBlciBsYXllciB0byB0YXJnZXQgZWxlbWVudFxuICAgICAgdGhpcy5fdGFyZ2V0RWxlbWVudC5hcHBlbmRDaGlsZChoZWxwZXJMYXllcik7XG4gICAgICB0aGlzLl90YXJnZXRFbGVtZW50LmFwcGVuZENoaWxkKHJlZmVyZW5jZUxheWVyKTtcbiBcbiAgICAgIC8vIGNoYW5nZSB0aGUgc2Nyb2xsIG9mIHRoZSB3aW5kb3csIGlmIG5lZWRlZFxuICAgICAgX3Njcm9sbFRvLmNhbGwodGhpcywgdGFyZ2V0RWxlbWVudC5zY3JvbGxUbywgdGFyZ2V0RWxlbWVudCk7XG5cbiAgICAgIC8vZW5kIG9mIG5ldyBlbGVtZW50IGlmLWVsc2UgY29uZGl0aW9uXG4gICAgfVxuXG4gICAgLy8gcmVtb3ZpbmcgcHJldmlvdXMgZGlzYWJsZSBpbnRlcmFjdGlvbiBsYXllclxuICAgIHZhciBkaXNhYmxlSW50ZXJhY3Rpb25MYXllciA9IHNlbGYuX3RhcmdldEVsZW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgICcuaW50cm9qcy1kaXNhYmxlSW50ZXJhY3Rpb24nXG4gICAgKTtcbiAgICBpZiAoZGlzYWJsZUludGVyYWN0aW9uTGF5ZXIpIHtcbiAgICAgIGRpc2FibGVJbnRlcmFjdGlvbkxheWVyLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoZGlzYWJsZUludGVyYWN0aW9uTGF5ZXIpO1xuICAgIH1cblxuICAgIC8vZGlzYWJsZSBpbnRlcmFjdGlvblxuICAgIGlmICh0YXJnZXRFbGVtZW50LmRpc2FibGVJbnRlcmFjdGlvbikge1xuICAgICAgX2Rpc2FibGVJbnRlcmFjdGlvbi5jYWxsKHNlbGYpO1xuICAgIH1cblxuICAgIF9zZXRTaG93RWxlbWVudCh0YXJnZXRFbGVtZW50KTtcblxuICAgIGlmICh0eXBlb2YgdGhpcy5faW50cm9BZnRlckNoYW5nZUNhbGxiYWNrICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgdGhpcy5faW50cm9BZnRlckNoYW5nZUNhbGxiYWNrLmNhbGwodGhpcywgdGFyZ2V0RWxlbWVudC5lbGVtZW50KTtcbiAgICB9XG4gICAgXG4gIH1cblxuICAvKipcbiAgICogVG8gY2hhbmdlIHRoZSBzY3JvbGwgb2YgYHdpbmRvd2AgYWZ0ZXIgaGlnaGxpZ2h0aW5nIGFuIGVsZW1lbnRcbiAgICpcbiAgICogQGFwaSBwcml2YXRlXG4gICAqIEBtZXRob2QgX3Njcm9sbFRvXG4gICAqIEBwYXJhbSB7U3RyaW5nfSBzY3JvbGxUb1xuICAgKiBAcGFyYW0ge09iamVjdH0gdGFyZ2V0RWxlbWVudFxuICAgKi9cbiAgZnVuY3Rpb24gX3Njcm9sbFRvKHNjcm9sbFRvLCB0YXJnZXRFbGVtZW50KSB7XG4gICAgaWYgKHNjcm9sbFRvID09PSAnb2ZmJykgcmV0dXJuO1xuICAgIHZhciByZWN0O1xuXG4gICAgaWYgKCF0aGlzLl9vcHRpb25zLnNjcm9sbFRvRWxlbWVudCkgcmV0dXJuO1xuXG4gICAgcmVjdCA9IHRhcmdldEVsZW1lbnQuZWxlbWVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcblxuICAgIGlmICghX2VsZW1lbnRJblZpZXdwb3J0KHRhcmdldEVsZW1lbnQuZWxlbWVudCkpIHtcbiAgICAgIHZhciB3aW5IZWlnaHQgPSBfZ2V0V2luU2l6ZSgpLmhlaWdodDtcbiAgICAgIHZhciB0b3AgPSByZWN0LmJvdHRvbSAtIChyZWN0LmJvdHRvbSAtIHJlY3QudG9wKTtcblxuICAgICAgLy8gVE9ETyAoYWZzaGlubSk6IGRvIHdlIG5lZWQgc2Nyb2xsIHBhZGRpbmcgbm93P1xuICAgICAgLy8gSSBoYXZlIGNoYW5nZWQgdGhlIHNjcm9sbCBvcHRpb24gYW5kIG5vdyBpdCBzY3JvbGxzIHRoZSB3aW5kb3cgdG9cbiAgICAgIC8vIHRoZSBjZW50ZXIgb2YgdGhlIHRhcmdldCBlbGVtZW50IG9yIHRvb2x0aXAuXG5cbiAgICAgIGlmICh0b3AgPCAwIHx8IHRhcmdldEVsZW1lbnQuZWxlbWVudC5jbGllbnRIZWlnaHQgPiB3aW5IZWlnaHQpIHtcbiAgICAgICAgd2luZG93LnNjcm9sbEJ5KFxuICAgICAgICAgIDAsXG4gICAgICAgICAgcmVjdC50b3AgLVxuICAgICAgICAgICAgKHdpbkhlaWdodCAvIDIgLSByZWN0LmhlaWdodCAvIDIpIC1cbiAgICAgICAgICAgIHRoaXMuX29wdGlvbnMuc2Nyb2xsUGFkZGluZ1xuICAgICAgICApOyAvLyAzMHB4IHBhZGRpbmcgZnJvbSBlZGdlIHRvIGxvb2sgbmljZVxuXG4gICAgICAgIC8vU2Nyb2xsIGRvd25cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHdpbmRvdy5zY3JvbGxCeShcbiAgICAgICAgICAwLFxuICAgICAgICAgIHJlY3QudG9wIC1cbiAgICAgICAgICAgICh3aW5IZWlnaHQgLyAyIC0gcmVjdC5oZWlnaHQgLyAyKSArXG4gICAgICAgICAgICB0aGlzLl9vcHRpb25zLnNjcm9sbFBhZGRpbmdcbiAgICAgICAgKTsgLy8gMzBweCBwYWRkaW5nIGZyb20gZWRnZSB0byBsb29rIG5pY2VcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogVG8gcmVtb3ZlIGFsbCBzaG93IGVsZW1lbnQocylcbiAgICpcbiAgICogQGFwaSBwcml2YXRlXG4gICAqIEBtZXRob2QgX3JlbW92ZVNob3dFbGVtZW50XG4gICAqL1xuICBmdW5jdGlvbiBfcmVtb3ZlU2hvd0VsZW1lbnQoKSB7XG4gICAgdmFyIGVsbXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuaW50cm9qcy1zaG93RWxlbWVudCcpO1xuXG4gICAgX2ZvckVhY2goZWxtcywgZnVuY3Rpb24oZWxtKSB7XG4gICAgICBfcmVtb3ZlQ2xhc3MoZWxtLCAvaW50cm9qcy1bYS16QS1aXSsvZyk7XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogVG8gc2V0IHRoZSBzaG93IGVsZW1lbnRcbiAgICogVGhpcyBmdW5jdGlvbiBzZXQgYSByZWxhdGl2ZSAoaW4gbW9zdCBjYXNlcykgcG9zaXRpb24gYW5kIGNoYW5nZXMgdGhlIHotaW5kZXhcbiAgICpcbiAgICogQGFwaSBwcml2YXRlXG4gICAqIEBtZXRob2QgX3NldFNob3dFbGVtZW50XG4gICAqIEBwYXJhbSB7T2JqZWN0fSB0YXJnZXRFbGVtZW50XG4gICAqL1xuICBmdW5jdGlvbiBfc2V0U2hvd0VsZW1lbnQodGFyZ2V0RWxlbWVudCkge1xuICAgIHZhciBwYXJlbnRFbG07XG4gICAgLy8gd2UgbmVlZCB0byBhZGQgdGhpcyBzaG93IGVsZW1lbnQgY2xhc3MgdG8gdGhlIHBhcmVudCBvZiBTVkcgZWxlbWVudHNcbiAgICAvLyBiZWNhdXNlIHRoZSBTVkcgZWxlbWVudHMgY2FuJ3QgaGF2ZSBpbmRlcGVuZGVudCB6LWluZGV4XG4gICAgaWYgKHRhcmdldEVsZW1lbnQuZWxlbWVudCBpbnN0YW5jZW9mIFNWR0VsZW1lbnQpIHtcbiAgICAgIHBhcmVudEVsbSA9IHRhcmdldEVsZW1lbnQuZWxlbWVudC5wYXJlbnROb2RlO1xuXG4gICAgICB3aGlsZSAodGFyZ2V0RWxlbWVudC5lbGVtZW50LnBhcmVudE5vZGUgIT09IG51bGwpIHtcbiAgICAgICAgaWYgKCFwYXJlbnRFbG0udGFnTmFtZSB8fCBwYXJlbnRFbG0udGFnTmFtZS50b0xvd2VyQ2FzZSgpID09PSAnYm9keScpXG4gICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgaWYgKHBhcmVudEVsbS50YWdOYW1lLnRvTG93ZXJDYXNlKCkgPT09ICdzdmcnKSB7XG4gICAgICAgICAgX2FkZENsYXNzKHBhcmVudEVsbSwgJ2ludHJvanMtc2hvd0VsZW1lbnQgaW50cm9qcy1yZWxhdGl2ZVBvc2l0aW9uJyk7XG4gICAgICAgIH1cblxuICAgICAgICBwYXJlbnRFbG0gPSBwYXJlbnRFbG0ucGFyZW50Tm9kZTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBfYWRkQ2xhc3ModGFyZ2V0RWxlbWVudC5lbGVtZW50LCAnaW50cm9qcy1zaG93RWxlbWVudCcpO1xuXG4gICAgdmFyIGN1cnJlbnRFbGVtZW50UG9zaXRpb24gPSBfZ2V0UHJvcFZhbHVlKFxuICAgICAgdGFyZ2V0RWxlbWVudC5lbGVtZW50LFxuICAgICAgJ3Bvc2l0aW9uJ1xuICAgICk7XG4gICAgaWYgKFxuICAgICAgY3VycmVudEVsZW1lbnRQb3NpdGlvbiAhPT0gJ2Fic29sdXRlJyAmJlxuICAgICAgY3VycmVudEVsZW1lbnRQb3NpdGlvbiAhPT0gJ3JlbGF0aXZlJyAmJlxuICAgICAgY3VycmVudEVsZW1lbnRQb3NpdGlvbiAhPT0gJ2ZpeGVkJ1xuICAgICkge1xuICAgICAgLy9jaGFuZ2UgdG8gbmV3IGludHJvIGl0ZW1cbiAgICAgIF9hZGRDbGFzcyh0YXJnZXRFbGVtZW50LmVsZW1lbnQsICdpbnRyb2pzLXJlbGF0aXZlUG9zaXRpb24nKTtcbiAgICB9XG5cbiAgICBwYXJlbnRFbG0gPSB0YXJnZXRFbGVtZW50LmVsZW1lbnQucGFyZW50Tm9kZTtcbiAgICB3aGlsZSAocGFyZW50RWxtICE9PSBudWxsKSB7XG4gICAgICBpZiAoIXBhcmVudEVsbS50YWdOYW1lIHx8IHBhcmVudEVsbS50YWdOYW1lLnRvTG93ZXJDYXNlKCkgPT09ICdib2R5JylcbiAgICAgICAgYnJlYWs7XG5cbiAgICAgIC8vZml4IFRoZSBTdGFja2luZyBDb250ZXh0IHByb2JsZW0uXG4gICAgICAvL01vcmUgZGV0YWlsOiBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9HdWlkZS9DU1MvVW5kZXJzdGFuZGluZ196X2luZGV4L1RoZV9zdGFja2luZ19jb250ZXh0XG4gICAgICB2YXIgekluZGV4ID0gX2dldFByb3BWYWx1ZShwYXJlbnRFbG0sICd6LWluZGV4Jyk7XG4gICAgICB2YXIgb3BhY2l0eSA9IHBhcnNlRmxvYXQoX2dldFByb3BWYWx1ZShwYXJlbnRFbG0sICdvcGFjaXR5JykpO1xuICAgICAgdmFyIHRyYW5zZm9ybSA9XG4gICAgICAgIF9nZXRQcm9wVmFsdWUocGFyZW50RWxtLCAndHJhbnNmb3JtJykgfHxcbiAgICAgICAgX2dldFByb3BWYWx1ZShwYXJlbnRFbG0sICctd2Via2l0LXRyYW5zZm9ybScpIHx8XG4gICAgICAgIF9nZXRQcm9wVmFsdWUocGFyZW50RWxtLCAnLW1vei10cmFuc2Zvcm0nKSB8fFxuICAgICAgICBfZ2V0UHJvcFZhbHVlKHBhcmVudEVsbSwgJy1tcy10cmFuc2Zvcm0nKSB8fFxuICAgICAgICBfZ2V0UHJvcFZhbHVlKHBhcmVudEVsbSwgJy1vLXRyYW5zZm9ybScpO1xuICAgICAgaWYgKFxuICAgICAgICAvWzAtOV0rLy50ZXN0KHpJbmRleCkgfHxcbiAgICAgICAgb3BhY2l0eSA8IDEgfHxcbiAgICAgICAgKHRyYW5zZm9ybSAhPT0gJ25vbmUnICYmIHRyYW5zZm9ybSAhPT0gdW5kZWZpbmVkKVxuICAgICAgKSB7XG4gICAgICAgIF9hZGRDbGFzcyhwYXJlbnRFbG0sICdpbnRyb2pzLWZpeFBhcmVudCcpO1xuICAgICAgfVxuXG4gICAgICBwYXJlbnRFbG0gPSBwYXJlbnRFbG0ucGFyZW50Tm9kZTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogSXRlcmF0ZXMgYXJyYXlzXG4gICAqXG4gICAqIEBwYXJhbSB7QXJyYXl9IGFyclxuICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBmb3JFYWNoRm5jXG4gICAqIEBwYXJhbSB7RnVuY3Rpb259IGNvbXBsZXRlRm5jXG4gICAqIEByZXR1cm4ge051bGx9XG4gICAqL1xuICBmdW5jdGlvbiBfZm9yRWFjaChhcnIsIGZvckVhY2hGbmMsIGNvbXBsZXRlRm5jKSB7XG4gICAgLy8gaW4gY2FzZSBhcnIgaXMgYW4gZW1wdHkgcXVlcnkgc2VsZWN0b3Igbm9kZSBsaXN0XG4gICAgaWYgKGFycikge1xuICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IGFyci5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgICAgICBmb3JFYWNoRm5jKGFycltpXSwgaSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKHR5cGVvZiBjb21wbGV0ZUZuYyA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgY29tcGxldGVGbmMoKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogTWFyayBhbnkgb2JqZWN0IHdpdGggYW4gaW5jcmVtZW50aW5nIG51bWJlclxuICAgKiB1c2VkIGZvciBrZWVwaW5nIHRyYWNrIG9mIG9iamVjdHNcbiAgICpcbiAgICogQHBhcmFtIE9iamVjdCBvYmogICBBbnkgb2JqZWN0IG9yIERPTSBFbGVtZW50XG4gICAqIEBwYXJhbSBTdHJpbmcga2V5XG4gICAqIEByZXR1cm4gT2JqZWN0XG4gICAqL1xuICB2YXIgX3N0YW1wID0gKGZ1bmN0aW9uKCkge1xuICAgIHZhciBrZXlzID0ge307XG4gICAgcmV0dXJuIGZ1bmN0aW9uIHN0YW1wKG9iaiwga2V5KSB7XG4gICAgICAvLyBnZXQgZ3JvdXAga2V5XG4gICAgICBrZXkgPSBrZXkgfHwgJ2ludHJvanMtc3RhbXAnO1xuXG4gICAgICAvLyBlYWNoIGdyb3VwIGluY3JlbWVudHMgZnJvbSAwXG4gICAgICBrZXlzW2tleV0gPSBrZXlzW2tleV0gfHwgMDtcblxuICAgICAgLy8gc3RhbXAgb25seSBvbmNlIHBlciBvYmplY3RcbiAgICAgIGlmIChvYmpba2V5XSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIC8vIGluY3JlbWVudCBrZXkgZm9yIGVhY2ggbmV3IG9iamVjdFxuICAgICAgICBvYmpba2V5XSA9IGtleXNba2V5XSsrO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gb2JqW2tleV07XG4gICAgfTtcbiAgfSkoKTtcblxuICAvKipcbiAgICogRE9NRXZlbnQgSGFuZGxlcyBhbGwgRE9NIGV2ZW50c1xuICAgKlxuICAgKiBtZXRob2RzOlxuICAgKlxuICAgKiBvbiAtIGFkZCBldmVudCBoYW5kbGVyXG4gICAqIG9mZiAtIHJlbW92ZSBldmVudFxuICAgKi9cbiAgdmFyIERPTUV2ZW50ID0gKGZ1bmN0aW9uKCkge1xuICAgIGZ1bmN0aW9uIERPTUV2ZW50KCkge1xuICAgICAgdmFyIGV2ZW50c19rZXkgPSAnaW50cm9qc19ldmVudCc7XG5cbiAgICAgIC8qKlxuICAgICAgICogR2V0cyBhIHVuaXF1ZSBJRCBmb3IgYW4gZXZlbnQgbGlzdGVuZXJcbiAgICAgICAqXG4gICAgICAgKiBAcGFyYW0gT2JqZWN0IG9ialxuICAgICAgICogQHBhcmFtIFN0cmluZyB0eXBlICAgICAgICBldmVudCB0eXBlXG4gICAgICAgKiBAcGFyYW0gRnVuY3Rpb24gbGlzdGVuZXJcbiAgICAgICAqIEBwYXJhbSBPYmplY3QgY29udGV4dFxuICAgICAgICogQHJldHVybiBTdHJpbmdcbiAgICAgICAqL1xuICAgICAgdGhpcy5faWQgPSBmdW5jdGlvbihvYmosIHR5cGUsIGxpc3RlbmVyLCBjb250ZXh0KSB7XG4gICAgICAgIHJldHVybiB0eXBlICsgX3N0YW1wKGxpc3RlbmVyKSArIChjb250ZXh0ID8gJ18nICsgX3N0YW1wKGNvbnRleHQpIDogJycpO1xuICAgICAgfTtcblxuICAgICAgLyoqXG4gICAgICAgKiBBZGRzIGV2ZW50IGxpc3RlbmVyXG4gICAgICAgKlxuICAgICAgICogQHBhcmFtIE9iamVjdCBvYmpcbiAgICAgICAqIEBwYXJhbSBTdHJpbmcgdHlwZSAgICAgICAgZXZlbnQgdHlwZVxuICAgICAgICogQHBhcmFtIEZ1bmN0aW9uIGxpc3RlbmVyXG4gICAgICAgKiBAcGFyYW0gT2JqZWN0IGNvbnRleHRcbiAgICAgICAqIEBwYXJhbSBCb29sZWFuIHVzZUNhcHR1cmVcbiAgICAgICAqIEByZXR1cm4gbnVsbFxuICAgICAgICovXG4gICAgICB0aGlzLm9uID0gZnVuY3Rpb24ob2JqLCB0eXBlLCBsaXN0ZW5lciwgY29udGV4dCwgdXNlQ2FwdHVyZSkge1xuICAgICAgICB2YXIgaWQgPSB0aGlzLl9pZC5hcHBseSh0aGlzLCBhcmd1bWVudHMpLFxuICAgICAgICAgIGhhbmRsZXIgPSBmdW5jdGlvbihlKSB7XG4gICAgICAgICAgICByZXR1cm4gbGlzdGVuZXIuY2FsbChjb250ZXh0IHx8IG9iaiwgZSB8fCB3aW5kb3cuZXZlbnQpO1xuICAgICAgICAgIH07XG5cbiAgICAgICAgaWYgKCdhZGRFdmVudExpc3RlbmVyJyBpbiBvYmopIHtcbiAgICAgICAgICBvYmouYWRkRXZlbnRMaXN0ZW5lcih0eXBlLCBoYW5kbGVyLCB1c2VDYXB0dXJlKTtcbiAgICAgICAgfSBlbHNlIGlmICgnYXR0YWNoRXZlbnQnIGluIG9iaikge1xuICAgICAgICAgIG9iai5hdHRhY2hFdmVudCgnb24nICsgdHlwZSwgaGFuZGxlcik7XG4gICAgICAgIH1cblxuICAgICAgICBvYmpbZXZlbnRzX2tleV0gPSBvYmpbZXZlbnRzX2tleV0gfHwge307XG4gICAgICAgIG9ialtldmVudHNfa2V5XVtpZF0gPSBoYW5kbGVyO1xuICAgICAgfTtcblxuICAgICAgLyoqXG4gICAgICAgKiBSZW1vdmVzIGV2ZW50IGxpc3RlbmVyXG4gICAgICAgKlxuICAgICAgICogQHBhcmFtIE9iamVjdCBvYmpcbiAgICAgICAqIEBwYXJhbSBTdHJpbmcgdHlwZSAgICAgICAgZXZlbnQgdHlwZVxuICAgICAgICogQHBhcmFtIEZ1bmN0aW9uIGxpc3RlbmVyXG4gICAgICAgKiBAcGFyYW0gT2JqZWN0IGNvbnRleHRcbiAgICAgICAqIEBwYXJhbSBCb29sZWFuIHVzZUNhcHR1cmVcbiAgICAgICAqIEByZXR1cm4gbnVsbFxuICAgICAgICovXG4gICAgICB0aGlzLm9mZiA9IGZ1bmN0aW9uKG9iaiwgdHlwZSwgbGlzdGVuZXIsIGNvbnRleHQsIHVzZUNhcHR1cmUpIHtcbiAgICAgICAgdmFyIGlkID0gdGhpcy5faWQuYXBwbHkodGhpcywgYXJndW1lbnRzKSxcbiAgICAgICAgICBoYW5kbGVyID0gb2JqW2V2ZW50c19rZXldICYmIG9ialtldmVudHNfa2V5XVtpZF07XG5cbiAgICAgICAgaWYgKCFoYW5kbGVyKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKCdyZW1vdmVFdmVudExpc3RlbmVyJyBpbiBvYmopIHtcbiAgICAgICAgICBvYmoucmVtb3ZlRXZlbnRMaXN0ZW5lcih0eXBlLCBoYW5kbGVyLCB1c2VDYXB0dXJlKTtcbiAgICAgICAgfSBlbHNlIGlmICgnZGV0YWNoRXZlbnQnIGluIG9iaikge1xuICAgICAgICAgIG9iai5kZXRhY2hFdmVudCgnb24nICsgdHlwZSwgaGFuZGxlcik7XG4gICAgICAgIH1cblxuICAgICAgICBvYmpbZXZlbnRzX2tleV1baWRdID0gbnVsbDtcbiAgICAgIH07XG4gICAgfVxuXG4gICAgcmV0dXJuIG5ldyBET01FdmVudCgpO1xuICB9KSgpO1xuXG4gIC8qKlxuICAgKiBBcHBlbmQgYSBjbGFzcyB0byBhbiBlbGVtZW50XG4gICAqXG4gICAqIEBhcGkgcHJpdmF0ZVxuICAgKiBAbWV0aG9kIF9hZGRDbGFzc1xuICAgKiBAcGFyYW0ge09iamVjdH0gZWxlbWVudFxuICAgKiBAcGFyYW0ge1N0cmluZ30gY2xhc3NOYW1lXG4gICAqIEByZXR1cm5zIG51bGxcbiAgICovXG4gIGZ1bmN0aW9uIF9hZGRDbGFzcyhlbGVtZW50LCBjbGFzc05hbWUpIHtcbiAgICBpZiAoZWxlbWVudCBpbnN0YW5jZW9mIFNWR0VsZW1lbnQpIHtcbiAgICAgIC8vIHN2Z1xuICAgICAgdmFyIHByZSA9IGVsZW1lbnQuZ2V0QXR0cmlidXRlKCdjbGFzcycpIHx8ICcnO1xuXG4gICAgICBlbGVtZW50LnNldEF0dHJpYnV0ZSgnY2xhc3MnLCBwcmUgKyAnICcgKyBjbGFzc05hbWUpO1xuICAgIH0gZWxzZSB7XG4gICAgICBpZiAoZWxlbWVudC5jbGFzc0xpc3QgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAvLyBjaGVjayBmb3IgbW9kZXJuIGNsYXNzTGlzdCBwcm9wZXJ0eVxuICAgICAgICB2YXIgY2xhc3NlcyA9IGNsYXNzTmFtZS5zcGxpdCgnICcpO1xuICAgICAgICBfZm9yRWFjaChjbGFzc2VzLCBmdW5jdGlvbihjbHMpIHtcbiAgICAgICAgICBlbGVtZW50LmNsYXNzTGlzdC5hZGQoY2xzKTtcbiAgICAgICAgfSk7XG4gICAgICB9IGVsc2UgaWYgKCFlbGVtZW50LmNsYXNzTmFtZS5tYXRjaChjbGFzc05hbWUpKSB7XG4gICAgICAgIC8vIGNoZWNrIGlmIGVsZW1lbnQgZG9lc24ndCBhbHJlYWR5IGhhdmUgY2xhc3NOYW1lXG4gICAgICAgIGVsZW1lbnQuY2xhc3NOYW1lICs9ICcgJyArIGNsYXNzTmFtZTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogUmVtb3ZlIGEgY2xhc3MgZnJvbSBhbiBlbGVtZW50XG4gICAqXG4gICAqIEBhcGkgcHJpdmF0ZVxuICAgKiBAbWV0aG9kIF9yZW1vdmVDbGFzc1xuICAgKiBAcGFyYW0ge09iamVjdH0gZWxlbWVudFxuICAgKiBAcGFyYW0ge1JlZ0V4cHxTdHJpbmd9IGNsYXNzTmFtZVJlZ2V4IGNhbiBiZSByZWdleCBvciBzdHJpbmdcbiAgICogQHJldHVybnMgbnVsbFxuICAgKi9cbiAgZnVuY3Rpb24gX3JlbW92ZUNsYXNzKGVsZW1lbnQsIGNsYXNzTmFtZVJlZ2V4KSB7XG4gICAgaWYgKGVsZW1lbnQgaW5zdGFuY2VvZiBTVkdFbGVtZW50KSB7XG4gICAgICB2YXIgcHJlID0gZWxlbWVudC5nZXRBdHRyaWJ1dGUoJ2NsYXNzJykgfHwgJyc7XG5cbiAgICAgIGVsZW1lbnQuc2V0QXR0cmlidXRlKFxuICAgICAgICAnY2xhc3MnLFxuICAgICAgICBwcmUucmVwbGFjZShjbGFzc05hbWVSZWdleCwgJycpLnJlcGxhY2UoL15cXHMrfFxccyskL2csICcnKVxuICAgICAgKTtcbiAgICB9IGVsc2Uge1xuICAgICAgZWxlbWVudC5jbGFzc05hbWUgPSBlbGVtZW50LmNsYXNzTmFtZVxuICAgICAgICAucmVwbGFjZShjbGFzc05hbWVSZWdleCwgJycpXG4gICAgICAgIC5yZXBsYWNlKC9eXFxzK3xcXHMrJC9nLCAnJyk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEdldCBhbiBlbGVtZW50IENTUyBwcm9wZXJ0eSBvbiB0aGUgcGFnZVxuICAgKiBUaGFua3MgdG8gSmF2YVNjcmlwdCBLaXQ6IGh0dHA6Ly93d3cuamF2YXNjcmlwdGtpdC5jb20vZGh0bWx0dXRvcnMvZGh0bWxjYXNjYWRlNC5zaHRtbFxuICAgKlxuICAgKiBAYXBpIHByaXZhdGVcbiAgICogQG1ldGhvZCBfZ2V0UHJvcFZhbHVlXG4gICAqIEBwYXJhbSB7T2JqZWN0fSBlbGVtZW50XG4gICAqIEBwYXJhbSB7U3RyaW5nfSBwcm9wTmFtZVxuICAgKiBAcmV0dXJucyBFbGVtZW50J3MgcHJvcGVydHkgdmFsdWVcbiAgICovXG4gIGZ1bmN0aW9uIF9nZXRQcm9wVmFsdWUoZWxlbWVudCwgcHJvcE5hbWUpIHtcbiAgICB2YXIgcHJvcFZhbHVlID0gJyc7XG4gICAgaWYgKGVsZW1lbnQuY3VycmVudFN0eWxlKSB7XG4gICAgICAvL0lFXG4gICAgICBwcm9wVmFsdWUgPSBlbGVtZW50LmN1cnJlbnRTdHlsZVtwcm9wTmFtZV07XG4gICAgfSBlbHNlIGlmIChkb2N1bWVudC5kZWZhdWx0VmlldyAmJiBkb2N1bWVudC5kZWZhdWx0Vmlldy5nZXRDb21wdXRlZFN0eWxlKSB7XG4gICAgICAvL090aGVyc1xuICAgICAgcHJvcFZhbHVlID0gZG9jdW1lbnQuZGVmYXVsdFZpZXdcbiAgICAgICAgLmdldENvbXB1dGVkU3R5bGUoZWxlbWVudCwgbnVsbClcbiAgICAgICAgLmdldFByb3BlcnR5VmFsdWUocHJvcE5hbWUpO1xuICAgIH1cblxuICAgIC8vUHJldmVudCBleGNlcHRpb24gaW4gSUVcbiAgICBpZiAocHJvcFZhbHVlICYmIHByb3BWYWx1ZS50b0xvd2VyQ2FzZSkge1xuICAgICAgcmV0dXJuIHByb3BWYWx1ZS50b0xvd2VyQ2FzZSgpO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gcHJvcFZhbHVlO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBDaGVja3MgdG8gc2VlIGlmIHRhcmdldCBlbGVtZW50IChvciBwYXJlbnRzKSBwb3NpdGlvbiBpcyBmaXhlZCBvciBub3RcbiAgICpcbiAgICogQGFwaSBwcml2YXRlXG4gICAqIEBtZXRob2QgX2lzRml4ZWRcbiAgICogQHBhcmFtIHtPYmplY3R9IGVsZW1lbnRcbiAgICogQHJldHVybnMgQm9vbGVhblxuICAgKi9cbiAgZnVuY3Rpb24gX2lzRml4ZWQoZWxlbWVudCkge1xuICAgIHZhciBwID0gZWxlbWVudC5wYXJlbnROb2RlO1xuXG4gICAgaWYgKCFwIHx8IHAubm9kZU5hbWUgPT09ICdIVE1MJykge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIGlmIChfZ2V0UHJvcFZhbHVlKGVsZW1lbnQsICdwb3NpdGlvbicpID09PSAnZml4ZWQnKSB7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG5cbiAgICByZXR1cm4gX2lzRml4ZWQocCk7XG4gIH1cblxuICAvKipcbiAgICogUHJvdmlkZXMgYSBjcm9zcy1icm93c2VyIHdheSB0byBnZXQgdGhlIHNjcmVlbiBkaW1lbnNpb25zXG4gICAqIHZpYTogaHR0cDovL3N0YWNrb3ZlcmZsb3cuY29tL3F1ZXN0aW9ucy81ODY0NDY3L2ludGVybmV0LWV4cGxvcmVyLWlubmVyaGVpZ2h0XG4gICAqXG4gICAqIEBhcGkgcHJpdmF0ZVxuICAgKiBAbWV0aG9kIF9nZXRXaW5TaXplXG4gICAqIEByZXR1cm5zIHtPYmplY3R9IHdpZHRoIGFuZCBoZWlnaHQgYXR0cmlidXRlc1xuICAgKi9cbiAgZnVuY3Rpb24gX2dldFdpblNpemUoKSB7XG4gICAgaWYgKHdpbmRvdy5pbm5lcldpZHRoICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIHJldHVybiB7IHdpZHRoOiB3aW5kb3cuaW5uZXJXaWR0aCwgaGVpZ2h0OiB3aW5kb3cuaW5uZXJIZWlnaHQgfTtcbiAgICB9IGVsc2Uge1xuICAgICAgdmFyIEQgPSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQ7XG4gICAgICByZXR1cm4geyB3aWR0aDogRC5jbGllbnRXaWR0aCwgaGVpZ2h0OiBELmNsaWVudEhlaWdodCB9O1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBDaGVjayB0byBzZWUgaWYgdGhlIGVsZW1lbnQgaXMgaW4gdGhlIHZpZXdwb3J0IG9yIG5vdFxuICAgKiBodHRwOi8vc3RhY2tvdmVyZmxvdy5jb20vcXVlc3Rpb25zLzEyMzk5OS9ob3ctdG8tdGVsbC1pZi1hLWRvbS1lbGVtZW50LWlzLXZpc2libGUtaW4tdGhlLWN1cnJlbnQtdmlld3BvcnRcbiAgICpcbiAgICogQGFwaSBwcml2YXRlXG4gICAqIEBtZXRob2QgX2VsZW1lbnRJblZpZXdwb3J0XG4gICAqIEBwYXJhbSB7T2JqZWN0fSBlbFxuICAgKi9cbiAgZnVuY3Rpb24gX2VsZW1lbnRJblZpZXdwb3J0KGVsKSB7XG4gICAgdmFyIHJlY3QgPSBlbC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcblxuICAgIHJldHVybiAoXG4gICAgICByZWN0LnRvcCA+PSAwICYmXG4gICAgICByZWN0LmxlZnQgPj0gMCAmJlxuICAgICAgcmVjdC5ib3R0b20gKyA4MCA8PSB3aW5kb3cuaW5uZXJIZWlnaHQgJiYgLy8gYWRkIDgwIHRvIGdldCB0aGUgdGV4dCByaWdodFxuICAgICAgcmVjdC5yaWdodCA8PSB3aW5kb3cuaW5uZXJXaWR0aFxuICAgICk7XG4gIH1cblxuICAvKipcbiAgICogQWRkIG92ZXJsYXkgbGF5ZXIgdG8gdGhlIHBhZ2VcbiAgICpcbiAgICogQGFwaSBwcml2YXRlXG4gICAqIEBtZXRob2QgX2FkZE92ZXJsYXlMYXllclxuICAgKiBAcGFyYW0ge09iamVjdH0gdGFyZ2V0RWxtXG4gICAqL1xuICBmdW5jdGlvbiBfYWRkT3ZlcmxheUxheWVyKHRhcmdldEVsbSkge1xuICAgIHZhciBvdmVybGF5TGF5ZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKSxcbiAgICAgIHN0eWxlVGV4dCA9ICcnLFxuICAgICAgc2VsZiA9IHRoaXM7XG5cbiAgICAvL3NldCBjc3MgY2xhc3MgbmFtZVxuICAgIG92ZXJsYXlMYXllci5jbGFzc05hbWUgPSAnaW50cm9qcy1vdmVybGF5JztcblxuICAgIC8vY2hlY2sgaWYgdGhlIHRhcmdldCBlbGVtZW50IGlzIGJvZHksIHdlIHNob3VsZCBjYWxjdWxhdGUgdGhlIHNpemUgb2Ygb3ZlcmxheSBsYXllciBpbiBhIGJldHRlciB3YXlcbiAgICBpZiAoIXRhcmdldEVsbS50YWdOYW1lIHx8IHRhcmdldEVsbS50YWdOYW1lLnRvTG93ZXJDYXNlKCkgPT09ICdib2R5Jykge1xuICAgICAgc3R5bGVUZXh0ICs9ICd0b3A6IDA7Ym90dG9tOiAwOyBsZWZ0OiAwO3JpZ2h0OiAwO3Bvc2l0aW9uOiBmaXhlZDsnO1xuICAgICAgb3ZlcmxheUxheWVyLnN0eWxlLmNzc1RleHQgPSBzdHlsZVRleHQ7XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vc2V0IG92ZXJsYXkgbGF5ZXIgcG9zaXRpb25cbiAgICAgIHZhciBlbGVtZW50UG9zaXRpb24gPSBfZ2V0T2Zmc2V0KHRhcmdldEVsbSk7XG4gICAgICBpZiAoZWxlbWVudFBvc2l0aW9uKSB7XG4gICAgICAgIHN0eWxlVGV4dCArPVxuICAgICAgICAgICd3aWR0aDogJyArXG4gICAgICAgICAgZWxlbWVudFBvc2l0aW9uLndpZHRoICtcbiAgICAgICAgICAncHg7IGhlaWdodDonICtcbiAgICAgICAgICBlbGVtZW50UG9zaXRpb24uaGVpZ2h0ICtcbiAgICAgICAgICAncHg7IHRvcDonICtcbiAgICAgICAgICBlbGVtZW50UG9zaXRpb24udG9wICtcbiAgICAgICAgICAncHg7bGVmdDogJyArXG4gICAgICAgICAgZWxlbWVudFBvc2l0aW9uLmxlZnQgK1xuICAgICAgICAgICdweDsnO1xuICAgICAgICBvdmVybGF5TGF5ZXIuc3R5bGUuY3NzVGV4dCA9IHN0eWxlVGV4dDtcbiAgICAgIH1cbiAgICB9XG5cbiAgICB0YXJnZXRFbG0uYXBwZW5kQ2hpbGQob3ZlcmxheUxheWVyKTtcblxuICAgIG92ZXJsYXlMYXllci5vbmNsaWNrID0gZnVuY3Rpb24oKSB7XG4gICAgICBpZiAoc2VsZi5fb3B0aW9ucy5leGl0T25PdmVybGF5Q2xpY2sgPT09IHRydWUpIHtcbiAgICAgICAgX2V4aXRJbnRyby5jYWxsKHNlbGYsIHRhcmdldEVsbSk7XG4gICAgICB9XG4gICAgfTtcblxuICAgIHdpbmRvdy5zZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgc3R5bGVUZXh0ICs9ICdvcGFjaXR5OiAnICsgc2VsZi5fb3B0aW9ucy5vdmVybGF5T3BhY2l0eS50b1N0cmluZygpICsgJzsnO1xuICAgICAgb3ZlcmxheUxheWVyLnN0eWxlLmNzc1RleHQgPSBzdHlsZVRleHQ7XG4gICAgfSwgMTApO1xuICAgIHJldHVybiB0cnVlO1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCBhbiBlbGVtZW50IHBvc2l0aW9uIG9uIHRoZSBwYWdlXG4gICAqIFRoYW5rcyB0byBgbWVvdXdgOiBodHRwOi8vc3RhY2tvdmVyZmxvdy5jb20vYS80NDI0NzQvMzc1OTY2XG4gICAqXG4gICAqIEBhcGkgcHJpdmF0ZVxuICAgKiBAbWV0aG9kIF9nZXRPZmZzZXRcbiAgICogQHBhcmFtIHtPYmplY3R9IGVsZW1lbnRcbiAgICogQHJldHVybnMgRWxlbWVudCdzIHBvc2l0aW9uIGluZm9cbiAgICovXG4gIGZ1bmN0aW9uIF9nZXRPZmZzZXQoZWxlbWVudCkge1xuICAgIHZhciBib2R5ID0gZG9jdW1lbnQuYm9keTtcbiAgICB2YXIgZG9jRWwgPSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQ7XG4gICAgdmFyIHNjcm9sbFRvcCA9IHdpbmRvdy5wYWdlWU9mZnNldCB8fCBkb2NFbC5zY3JvbGxUb3AgfHwgYm9keS5zY3JvbGxUb3A7XG4gICAgdmFyIHNjcm9sbExlZnQgPSB3aW5kb3cucGFnZVhPZmZzZXQgfHwgZG9jRWwuc2Nyb2xsTGVmdCB8fCBib2R5LnNjcm9sbExlZnQ7XG4gICAgdmFyIHggPSBlbGVtZW50LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICAgIHJldHVybiB7XG4gICAgICB0b3A6IHgudG9wICsgc2Nyb2xsVG9wLFxuICAgICAgd2lkdGg6IHgud2lkdGgsXG4gICAgICBoZWlnaHQ6IHguaGVpZ2h0LFxuICAgICAgbGVmdDogeC5sZWZ0ICsgc2Nyb2xsTGVmdFxuICAgIH07XG4gIH1cblxuICAvKipcbiAgICogRmluZCB0aGUgbmVhcmVzdCBzY3JvbGxhYmxlIHBhcmVudFxuICAgKiBjb3BpZWQgZnJvbSBodHRwczovL3N0YWNrb3ZlcmZsb3cuY29tL3F1ZXN0aW9ucy8zNTkzOTg4Ni9maW5kLWZpcnN0LXNjcm9sbGFibGUtcGFyZW50XG4gICAqXG4gICAqIEBwYXJhbSBFbGVtZW50IGVsZW1lbnRcbiAgICogQHJldHVybiBFbGVtZW50XG4gICAqL1xuICBmdW5jdGlvbiBfZ2V0U2Nyb2xsUGFyZW50KGVsZW1lbnQpIHtcbiAgICB2YXIgc3R5bGUgPSB3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZShlbGVtZW50KTtcbiAgICB2YXIgZXhjbHVkZVN0YXRpY1BhcmVudCA9IHN0eWxlLnBvc2l0aW9uID09PSAnYWJzb2x1dGUnO1xuICAgIHZhciBvdmVyZmxvd1JlZ2V4ID0gLyhhdXRvfHNjcm9sbCkvO1xuXG4gICAgaWYgKHN0eWxlLnBvc2l0aW9uID09PSAnZml4ZWQnKSByZXR1cm4gZG9jdW1lbnQuYm9keTtcblxuICAgIGZvciAodmFyIHBhcmVudCA9IGVsZW1lbnQ7IChwYXJlbnQgPSBwYXJlbnQucGFyZW50RWxlbWVudCk7ICkge1xuICAgICAgc3R5bGUgPSB3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZShwYXJlbnQpO1xuICAgICAgaWYgKGV4Y2x1ZGVTdGF0aWNQYXJlbnQgJiYgc3R5bGUucG9zaXRpb24gPT09ICdzdGF0aWMnKSB7XG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgfVxuICAgICAgaWYgKFxuICAgICAgICBvdmVyZmxvd1JlZ2V4LnRlc3Qoc3R5bGUub3ZlcmZsb3cgKyBzdHlsZS5vdmVyZmxvd1kgKyBzdHlsZS5vdmVyZmxvd1gpXG4gICAgICApXG4gICAgICAgIHJldHVybiBwYXJlbnQ7XG4gICAgfVxuXG4gICAgcmV0dXJuIGRvY3VtZW50LmJvZHk7XG4gIH1cblxuICAvKipcbiAgICogc2Nyb2xsIGEgc2Nyb2xsYWJsZSBlbGVtZW50IHRvIGEgY2hpbGQgZWxlbWVudFxuICAgKlxuICAgKiBAcGFyYW0gRWxlbWVudCBwYXJlbnRcbiAgICogQHBhcmFtIEVsZW1lbnQgZWxlbWVudFxuICAgKiBAcmV0dXJuIE51bGxcbiAgICovXG4gIGZ1bmN0aW9uIF9zY3JvbGxQYXJlbnRUb0VsZW1lbnQocGFyZW50LCBlbGVtZW50KSB7XG4gICAgcGFyZW50LnNjcm9sbFRvcCA9IGVsZW1lbnQub2Zmc2V0VG9wIC0gcGFyZW50Lm9mZnNldFRvcDtcbiAgfVxuXG4gIC8qKlxuICAgKiBPdmVyd3JpdGVzIG9iajEncyB2YWx1ZXMgd2l0aCBvYmoyJ3MgYW5kIGFkZHMgb2JqMidzIGlmIG5vbiBleGlzdGVudCBpbiBvYmoxXG4gICAqIHZpYTogaHR0cDovL3N0YWNrb3ZlcmZsb3cuY29tL3F1ZXN0aW9ucy8xNzEyNTEvaG93LWNhbi1pLW1lcmdlLXByb3BlcnRpZXMtb2YtdHdvLWphdmFzY3JpcHQtb2JqZWN0cy1keW5hbWljYWxseVxuICAgKlxuICAgKiBAcGFyYW0gb2JqMVxuICAgKiBAcGFyYW0gb2JqMlxuICAgKiBAcmV0dXJucyBvYmozIGEgbmV3IG9iamVjdCBiYXNlZCBvbiBvYmoxIGFuZCBvYmoyXG4gICAqL1xuICBmdW5jdGlvbiBfbWVyZ2VPcHRpb25zKG9iajEsIG9iajIpIHtcbiAgICB2YXIgb2JqMyA9IHt9LFxuICAgICAgYXR0cm5hbWU7XG4gICAgZm9yIChhdHRybmFtZSBpbiBvYmoxKSB7XG4gICAgICBvYmozW2F0dHJuYW1lXSA9IG9iajFbYXR0cm5hbWVdO1xuICAgIH1cbiAgICBmb3IgKGF0dHJuYW1lIGluIG9iajIpIHtcbiAgICAgIG9iajNbYXR0cm5hbWVdID0gb2JqMlthdHRybmFtZV07XG4gICAgfVxuICAgIHJldHVybiBvYmozO1xuICB9XG5cbiAgdmFyIGludHJvSnMgPSBmdW5jdGlvbih0YXJnZXRFbG0pIHtcbiAgICB2YXIgaW5zdGFuY2U7XG5cbiAgICBpZiAodHlwZW9mIHRhcmdldEVsbSA9PT0gJ29iamVjdCcpIHtcbiAgICAgIC8vT2ssIGNyZWF0ZSBhIG5ldyBpbnN0YW5jZVxuICAgICAgaW5zdGFuY2UgPSBuZXcgSW50cm9Kcyh0YXJnZXRFbG0pO1xuICAgIH0gZWxzZSBpZiAodHlwZW9mIHRhcmdldEVsbSA9PT0gJ3N0cmluZycpIHtcbiAgICAgIC8vc2VsZWN0IHRoZSB0YXJnZXQgZWxlbWVudCB3aXRoIHF1ZXJ5IHNlbGVjdG9yXG4gICAgICB2YXIgdGFyZ2V0RWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IodGFyZ2V0RWxtKTtcblxuICAgICAgaWYgKHRhcmdldEVsZW1lbnQpIHtcbiAgICAgICAgaW5zdGFuY2UgPSBuZXcgSW50cm9Kcyh0YXJnZXRFbGVtZW50KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignVGhlcmUgaXMgbm8gZWxlbWVudCB3aXRoIGdpdmVuIHNlbGVjdG9yLicpO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBpbnN0YW5jZSA9IG5ldyBJbnRyb0pzKGRvY3VtZW50LmJvZHkpO1xuICAgIH1cbiAgICAvLyBhZGQgaW5zdGFuY2UgdG8gbGlzdCBvZiBfaW5zdGFuY2VzXG4gICAgLy8gcGFzc2luZyBncm91cCB0byBfc3RhbXAgdG8gaW5jcmVtZW50XG4gICAgLy8gZnJvbSAwIG9ud2FyZCBzb21ld2hhdCByZWxpYWJseVxuICAgIGludHJvSnMuaW5zdGFuY2VzW19zdGFtcChpbnN0YW5jZSwgJ2ludHJvanMtaW5zdGFuY2UnKV0gPSBpbnN0YW5jZTtcblxuICAgIHJldHVybiBpbnN0YW5jZTtcbiAgfTtcblxuICAvKipcbiAgICogQ3VycmVudCBJbnRyb0pzIHZlcnNpb25cbiAgICpcbiAgICogQHByb3BlcnR5IHZlcnNpb25cbiAgICogQHR5cGUgU3RyaW5nXG4gICAqL1xuICBpbnRyb0pzLnZlcnNpb24gPSBWRVJTSU9OO1xuXG4gIC8qKlxuICAgKiBrZXktdmFsIG9iamVjdCBoZWxwZXIgZm9yIGludHJvSnMgaW5zdGFuY2VzXG4gICAqXG4gICAqIEBwcm9wZXJ0eSBpbnN0YW5jZXNcbiAgICogQHR5cGUgT2JqZWN0XG4gICAqL1xuICBpbnRyb0pzLmluc3RhbmNlcyA9IHt9O1xuXG4gIC8vUHJvdG90eXBlXG4gIGludHJvSnMuZm4gPSBJbnRyb0pzLnByb3RvdHlwZSA9IHtcbiAgICBjbG9uZTogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gbmV3IEludHJvSnModGhpcyk7XG4gICAgfSxcbiAgICBzZXRPcHRpb246IGZ1bmN0aW9uKG9wdGlvbiwgdmFsdWUpIHtcbiAgICAgIHRoaXMuX29wdGlvbnNbb3B0aW9uXSA9IHZhbHVlO1xuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfSxcbiAgICBzZXRPcHRpb25zOiBmdW5jdGlvbihvcHRpb25zKSB7XG4gICAgICB0aGlzLl9vcHRpb25zID0gX21lcmdlT3B0aW9ucyh0aGlzLl9vcHRpb25zLCBvcHRpb25zKTtcbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH0sXG4gICAgc3RhcnQ6IGZ1bmN0aW9uKHNlbGVjdG9yKSB7XG4gICAgICBfaW50cm9Gb3JFbGVtZW50LmNhbGwodGhpcywgdGhpcy5fdGFyZ2V0RWxlbWVudCwgc2VsZWN0b3IpO1xuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfSxcbiAgICBnb1RvU3RlcDogZnVuY3Rpb24oc3RlcCkge1xuICAgICAgX2dvVG9TdGVwLmNhbGwodGhpcywgc3RlcCk7XG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9LFxuICAgIGFkZFN0ZXA6IGZ1bmN0aW9uKG9wdGlvbnMpIHtcbiAgICAgIGlmICghdGhpcy5fb3B0aW9ucy5zdGVwcykge1xuICAgICAgICB0aGlzLl9vcHRpb25zLnN0ZXBzID0gW107XG4gICAgICB9XG5cbiAgICAgIHRoaXMuX29wdGlvbnMuc3RlcHMucHVzaChvcHRpb25zKTtcblxuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfSwgXG4gICAgZ29Ub1N0ZXBOdW1iZXI6IGZ1bmN0aW9uKHN0ZXApIHtcbiAgICAgIF9nb1RvU3RlcE51bWJlci5jYWxsKHRoaXMsIHN0ZXApO1xuXG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9LFxuICAgIG5leHRTdGVwOiBmdW5jdGlvbigpIHtcbiAgICAgIF9uZXh0U3RlcC5jYWxsKHRoaXMpO1xuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfSxcbiAgICBleGl0OiBmdW5jdGlvbihmb3JjZSkge1xuICAgICAgX2V4aXRJbnRyby5jYWxsKHRoaXMsIHRoaXMuX3RhcmdldEVsZW1lbnQsIGZvcmNlKTtcbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH0sXG4gICAgcmVmcmVzaDogZnVuY3Rpb24oKSB7XG4gICAgICBfcmVmcmVzaC5jYWxsKHRoaXMpO1xuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfSxcbiAgICBvbmJlZm9yZWNoYW5nZTogZnVuY3Rpb24ocHJvdmlkZWRDYWxsYmFjaykge1xuICAgICAgaWYgKHR5cGVvZiBwcm92aWRlZENhbGxiYWNrID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgIHRoaXMuX2ludHJvQmVmb3JlQ2hhbmdlQ2FsbGJhY2sgPSBwcm92aWRlZENhbGxiYWNrO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFxuICAgICAgICAgICdQcm92aWRlZCBjYWxsYmFjayBmb3Igb25iZWZvcmVjaGFuZ2Ugd2FzIG5vdCBhIGZ1bmN0aW9uJ1xuICAgICAgICApO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfSxcbiAgICBvbmNoYW5nZTogZnVuY3Rpb24ocHJvdmlkZWRDYWxsYmFjaykge1xuICAgICAgaWYgKHR5cGVvZiBwcm92aWRlZENhbGxiYWNrID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgIHRoaXMuX2ludHJvQ2hhbmdlQ2FsbGJhY2sgPSBwcm92aWRlZENhbGxiYWNrO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdQcm92aWRlZCBjYWxsYmFjayBmb3Igb25jaGFuZ2Ugd2FzIG5vdCBhIGZ1bmN0aW9uLicpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfSxcbiAgICBvbmFmdGVyY2hhbmdlOiBmdW5jdGlvbihwcm92aWRlZENhbGxiYWNrKSB7XG4gICAgICBpZiAodHlwZW9mIHByb3ZpZGVkQ2FsbGJhY2sgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgdGhpcy5faW50cm9BZnRlckNoYW5nZUNhbGxiYWNrID0gcHJvdmlkZWRDYWxsYmFjaztcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgICAgICAnUHJvdmlkZWQgY2FsbGJhY2sgZm9yIG9uYWZ0ZXJjaGFuZ2Ugd2FzIG5vdCBhIGZ1bmN0aW9uJ1xuICAgICAgICApO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfSxcbiAgICBvbmNvbXBsZXRlOiBmdW5jdGlvbihwcm92aWRlZENhbGxiYWNrKSB7XG4gICAgICBpZiAodHlwZW9mIHByb3ZpZGVkQ2FsbGJhY2sgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgdGhpcy5faW50cm9Db21wbGV0ZUNhbGxiYWNrID0gcHJvdmlkZWRDYWxsYmFjaztcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignUHJvdmlkZWQgY2FsbGJhY2sgZm9yIG9uY29tcGxldGUgd2FzIG5vdCBhIGZ1bmN0aW9uLicpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfSxcblxuICAgIG9uZXhpdDogZnVuY3Rpb24ocHJvdmlkZWRDYWxsYmFjaykge1xuICAgICAgaWYgKHR5cGVvZiBwcm92aWRlZENhbGxiYWNrID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgIHRoaXMuX2ludHJvRXhpdENhbGxiYWNrID0gcHJvdmlkZWRDYWxsYmFjaztcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignUHJvdmlkZWQgY2FsbGJhY2sgZm9yIG9uZXhpdCB3YXMgbm90IGEgZnVuY3Rpb24uJyk7XG4gICAgICB9XG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9LFxuICAgIG9uYmVmb3JlZXhpdDogZnVuY3Rpb24ocHJvdmlkZWRDYWxsYmFjaykge1xuICAgICAgaWYgKHR5cGVvZiBwcm92aWRlZENhbGxiYWNrID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgIHRoaXMuX2ludHJvQmVmb3JlRXhpdENhbGxiYWNrID0gcHJvdmlkZWRDYWxsYmFjaztcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgICAgICAnUHJvdmlkZWQgY2FsbGJhY2sgZm9yIG9uYmVmb3JlZXhpdCB3YXMgbm90IGEgZnVuY3Rpb24uJ1xuICAgICAgICApO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICB9O1xuXG4gIHJldHVybiBpbnRyb0pzO1xufSk7XG4iLCIvKiBlc2xpbnQtZGlzYWJsZSBjYW1lbGNhc2UgKi9cbi8qIGVzbGludC1kaXNhYmxlIG5vLXVuZGVyc2NvcmUtZGFuZ2xlICovXG4vKiBnbG9iYWwgTXV0YXRpb25PYnNlcnZlciAqL1xuLyogZ2xvYmFsIEludGVyc2VjdGlvbk9ic2VydmVyICovXG4vKiBnbG9iYWwgZG9jdW1lbnQgKi9cbmltcG9ydCB7IHNob3dFcnJvciB9IGZyb20gJy4vdXRpbHMnO1xuXG5leHBvcnQgZnVuY3Rpb24gX19pc05hdGl2ZUV2ZW50KGV2ZW50KSB7XG4gIGNvbnN0IGRlZmF1bHRFdmVudHMgPSBbJ2NsaWNrJywgJ21vdXNlb3ZlcicsICdtb3VzZW91dCcsICdrZXl1cCcsICdrZXlwcmVzcycsICdjaGFuZ2UnLCAnZm9jdXMnLCAnc3VibWl0J107XG5cbiAgcmV0dXJuIGRlZmF1bHRFdmVudHMuaW5kZXhPZihldmVudCkgPiAtMTtcbn1cblxuY2xhc3MgQ2hhbmdlc0xpc3RlbmVyIHtcbiAgY29uc3RydWN0b3IoeyBsaXN0ZW5lcl9pZCwgc2VsZWN0b3IsIGV2ZW50LCBhdHRyaWJ1dGVOYW1lIH0pIHtcbiAgICB0aGlzLl9fdG91ck9iamVjdCA9IG51bGw7XG4gICAgdGhpcy5saXN0ZW5lcl9pZCA9IGxpc3RlbmVyX2lkO1xuICAgIHRoaXMuc2VsZWN0b3IgPSBzZWxlY3RvcjtcbiAgICB0aGlzLmV2ZW50ID0gZXZlbnQ7XG4gICAgdGhpcy5hdHRyaWJ1dGVOYW1lID0gYXR0cmlidXRlTmFtZTtcbiAgfVxuXG4gIGdldCB0b3VySnMoKSB7XG4gICAgcmV0dXJuIHRoaXMuX190b3VyT2JqZWN0O1xuICB9XG5cbiAgc2V0IHRvdXJKcyh2YWwpIHtcbiAgICB0aGlzLl9fdG91ck9iamVjdCA9IHZhbDtcbiAgfVxuXG4gIGluaXQoKSB7XG4gICAgaWYgKHRoaXMudG91ckpzID09IG51bGwpIHtcbiAgICAgIHNob3dFcnJvcign0KHQv9C10YDQstCwINC30LDQtNCw0LnRgtC1INC30L3QsNGH0LXQvdC40LUgdG91ckpzJyk7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGxldCBpc0JvZHkgPSBmYWxzZTtcbiAgICBjb25zdCB7IGV2ZW50IH0gPSB0aGlzO1xuICAgIC8vINC60L7QvdGE0LjQs9GD0YDQsNGG0LjRjyDQvdCw0YjQtdCz0L4gb2JzZXJ2ZXI6XG4gICAgbGV0IGNvbmZpZyA9IHsgYXR0cmlidXRlczogdHJ1ZSwgY2hpbGRMaXN0OiB0cnVlLCBjaGFyYWN0ZXJEYXRhOiBmYWxzZSB9O1xuICAgIC8vINCy0YvQsdC40YDQsNC10Lwg0YbQtdC70LXQstC+0Lkg0Y3Qu9C10LzQtdC90YJcbiAgICBsZXQgdGFyZ2V0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih0aGlzLnNlbGVjdG9yKTtcblxuICAgIGlmIChfX2lzTmF0aXZlRXZlbnQoZXZlbnQpKSB7XG4gICAgICAvLyDQntCx0YDQsNCx0L7RgtC60LAg0LrQu9C40LrQsFxuICAgICAgaWYgKGV2ZW50ID09PSAnY2xpY2snKSB7XG4gICAgICAgIHRoaXMuY2FsbGJhY2sgPSB0aGlzLm5hdGl2ZUNsaWNrTGlzdGVuZXIuYmluZCh0aGlzKTtcbiAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihldmVudCwgdGhpcy5jYWxsYmFjaywgZmFsc2UpO1xuICAgICAgfSBlbHNlIGlmICh0YXJnZXQgIT0gbnVsbCkge1xuICAgICAgICAvLyDQntCx0YDQsNCx0L7RgtC60LAg0L7RgdGC0LDQu9GM0L3QvtCz0L5cbiAgICAgICAgdGhpcy5jYWxsYmFjayA9IHRoaXMubmF0aXZlRXZlbnRMaXN0ZW5lci5iaW5kKHRoaXMpO1xuICAgICAgICB0YXJnZXQuYWRkRXZlbnRMaXN0ZW5lcihldmVudCwgdGhpcy5jYWxsYmFjaywgZmFsc2UpO1xuICAgICAgfSBlbHNlIGlmICh0YXJnZXQgPT0gbnVsbCkge1xuICAgICAgICBzaG93RXJyb3IoJ9Ce0YjQuNCx0LrQsDog0K3Qu9C10LzQtdC90YIg0L7RgtGB0YPRgtGB0YLQstGD0LXRgiDQsiBET00nKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIC8vINCV0YHQu9C4INGN0LvQtdC80LXQvdGCINC90LUg0L3QsNC50LTQtdC9INCyIERPTSDQtNC10YDQtdCy0LVcbiAgICBpZiAoIXRhcmdldCkge1xuICAgICAgdGFyZ2V0ID0gZG9jdW1lbnQuYm9keTtcbiAgICAgIGNvbmZpZy5zdWJ0cmVlID0gdHJ1ZTtcbiAgICAgIGlzQm9keSA9IHRydWU7XG4gICAgfVxuXG4gICAgaWYgKGlzQm9keSA9PT0gZmFsc2UpIHtcbiAgICAgIGxldCBvYnNlcnZlcjtcbiAgICAgIGxldCBjYWxsYmFjaztcblxuICAgICAgc3dpdGNoIChldmVudCkge1xuICAgICAgICBjYXNlICdzaG93JzpcbiAgICAgICAgICBjYWxsYmFjayA9IHRoaXMuSW50ZXJzZWN0aW9uU2hvd0NhbGxiYWNrO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICdoaWRlJzpcbiAgICAgICAgICBjYWxsYmFjayA9IHRoaXMuSW50ZXJzZWN0aW9uSGlkZUNhbGxiYWNrO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICdjbGFzc19jaGFuZ2UnOlxuICAgICAgICAgIGNhbGxiYWNrID0gdGhpcy5jbGFzc0NoYW5nZUNhbGxiYWNrO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICdhdHRyX2NoYW5nZSc6XG4gICAgICAgICAgY2FsbGJhY2sgPSB0aGlzLmF0dHJpYnV0ZUNoYW5nZUNhbGxiYWNrO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICd0ZXh0X2NoYW5nZSc6XG4gICAgICAgICAgY29uZmlnID0gT2JqZWN0LmFzc2lnbihjb25maWcsIHtcbiAgICAgICAgICAgIHN1YnRyZWU6IHRydWUsXG4gICAgICAgICAgICBjaGFyYWN0ZXJEYXRhOiB0cnVlLFxuICAgICAgICAgICAgYXR0cmlidXRlT2xkVmFsdWU6IHRydWUsXG4gICAgICAgICAgICBjaGFyYWN0ZXJEYXRhT2xkVmFsdWU6IHRydWVcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBjYWxsYmFjayA9IHRoaXMuY2hhcmFjdGVyRGF0YUNoYW5nZUNhbGxiYWNrO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICdjaGlsZHJlbl9jaGFuZ2UnOlxuICAgICAgICAgIGNvbmZpZy5zdWJ0cmVlID0gdHJ1ZTtcbiAgICAgICAgICBjYWxsYmFjayA9IHRoaXMuY2hpbGRyZW5DaGFuZ2VDYWxsYmFjaztcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICBzaG93RXJyb3IoYNCd0LUg0L/QvtC/0LDQuyDQv9C+0LQg0YPRgdC70L7QstC40Y86ICR7dGhpcy5zZWxlY3Rvcn0gLSAke2V2ZW50fWApO1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgLy8gYnJlYWs7XG4gICAgICB9XG5cbiAgICAgIGlmICh0eXBlb2YgY2FsbGJhY2sgIT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgc2hvd0Vycm9yKCdDYWxsYmFjayDRhNGD0L3QutGG0LjRjyDQvdC1INC+0L/RgNC10LTQtdC70LXQvdCwIScpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIC8vINC10YHQu9C4INC40YHQv9C+0LvRjNC30YPQtdGC0YHRjyBJbnRlcnNlY3Rpb25PYnNlcnZlclxuICAgICAgaWYgKFsnc2hvdycsICdoaWRlJ10uaW5kZXhPZihldmVudCkgPiAtMSkge1xuICAgICAgICBvYnNlcnZlciA9IG5ldyBJbnRlcnNlY3Rpb25PYnNlcnZlcigoZW50cmllcywgY29udGV4dCkgPT4ge1xuICAgICAgICAgIGVudHJpZXMuZm9yRWFjaChjYWxsYmFjay5iaW5kKGNvbnRleHQpKTtcbiAgICAgICAgfSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvLyDQldGB0LvQuCDQuNGB0L/QvtC70YzQt9GD0LXRgtGB0Y8gTXV0YXRpb25PYnNlcnZlclxuICAgICAgICBvYnNlcnZlciA9IG5ldyBNdXRhdGlvbk9ic2VydmVyKChtdXRhdGlvbnMsIGNvbnRleHQpID0+IHtcbiAgICAgICAgICBtdXRhdGlvbnMuZm9yRWFjaChjYWxsYmFjay5iaW5kKGNvbnRleHQpKTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICB0aGlzLnRvdXJKcy5fX29ic2VydmVyc1t0aGlzLmxpc3RlbmVyX2lkXSA9IG9ic2VydmVyO1xuICAgICAgb2JzZXJ2ZXIub2JzZXJ2ZSh0YXJnZXQsIGNvbmZpZyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vINGB0L7Qt9C00LDRkdC8INGN0LrQt9C10LzQv9C70Y/RgCBNdXRhdGlvbk9ic2VydmVyXG4gICAgICBjb25zdCBvYnNlcnZlciA9IG5ldyBNdXRhdGlvbk9ic2VydmVyKChtdXRhdGlvbnMsIGNvbnRleHQpID0+IHtcbiAgICAgICAgc3dpdGNoIChldmVudCkge1xuICAgICAgICAgIGNhc2UgJ3Nob3cnOlxuICAgICAgICAgICAgbXV0YXRpb25zLmZvckVhY2godGhpcy5zaG93Q2FsbGJhY2suYmluZChjb250ZXh0KSk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICBjYXNlICdoaWRlJzpcbiAgICAgICAgICAgIG11dGF0aW9ucy5mb3JFYWNoKHRoaXMuaGlkZUNhbGxiYWNrLmJpbmQoY29udGV4dCkpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIHNob3dFcnJvcihg0J3QtSDQv9C+0L/QsNC7INC/0L7QtCDRg9GB0LvQvtCy0LjRjzogJHt0aGlzLnNlbGVjdG9yfSAtICR7dGhpcy5ldmVudH1gKTtcbiAgICAgICAgICAgIHRoaXMuZGlzY29ubmVjdExpc3RlbmVyKCk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgIC8vINC/0LXRgNC10LTQsNGR0Lwg0LIg0LrQsNGH0LXRgdGC0LLQtSDQsNGA0LPRg9C80LXQvdGC0L7QsiDRhtC10LvQtdCy0L7QuSDRjdC70LXQvNC10L3RgiDQuCDQtdCz0L4g0LrQvtC90YTQuNCz0YPRgNCw0YbQuNGOXG4gICAgICB0aGlzLnRvdXJKcy5fX29ic2VydmVyc1t0aGlzLmxpc3RlbmVyX2lkXSA9IG9ic2VydmVyO1xuICAgICAgb2JzZXJ2ZXIub2JzZXJ2ZSh0YXJnZXQsIGNvbmZpZyk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqXG4gICAqL1xuICBkaXNjb25uZWN0TGlzdGVuZXIoKSB7XG4gICAgY29uc3QgbGlzdGVuZXIgPSB0aGlzLnRvdXJKcy5fX29ic2VydmVyc1t0aGlzLmxpc3RlbmVyX2lkXTtcblxuICAgIGlmICghbGlzdGVuZXIpIHtcbiAgICAgIHNob3dFcnJvcihgTGlzdGVuZXIg0YEgaWQgJHt0aGlzLmxpc3RlbmVyX2lkfSDQvdC1INC90LDQudC00LXQvWApO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGxpc3RlbmVyLmRpc2Nvbm5lY3QoKTtcbiAgfVxuXG4gIHNlbmRNZXNzYWdlKCkge1xuICAgIHRoaXMudG91ckpzLnNlbmRNZXNzYWdlKHtcbiAgICAgIGxpc3RlbmVyX2lkOiB0aGlzLmxpc3RlbmVyX2lkXG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogQ2FsbGJhY2sg0YTRg9C90LrRhtC40Y8g0LTQu9GPINC/0YDQvtGB0LvRg9GI0LjQstCw0L3QuNGPINC90LDRgtC40LLQvdGL0YUg0YHQvtCx0YvRgtC40LggSmF2YVNjcmlwdFxuICAgKiBAcGFyYW0ge0V2ZW50fSBqc0V2ZW50XG4gICAqL1xuICBuYXRpdmVFdmVudExpc3RlbmVyKGpzRXZlbnQpIHtcbiAgICBpZiAoanNFdmVudC50YXJnZXQubWF0Y2hlcyh0aGlzLnNlbGVjdG9yKSkge1xuICAgICAgdGhpcy5zZW5kTWVzc2FnZSgpO1xuICAgICAganNFdmVudC50YXJnZXQucmVtb3ZlRXZlbnRMaXN0ZW5lcih0aGlzLmV2ZW50LCB0aGlzLmNhbGxiYWNrLCBmYWxzZSk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqQ2FsbGJhY2sg0YTRg9C90LrRhtC40Y8g0LTQu9GPINC/0YDQvtGB0LvRg9GI0LjQstCw0L3QuNGPINC90LDRgtC40LLQvdGL0YUgQ0xJQ0sg0YHQvtCx0YvRgtC40LggSmF2YVNjcmlwdFxuICAgKiBAcGFyYW0ge0V2ZW50fSBqc0V2ZW50XG4gICAqL1xuICBuYXRpdmVDbGlja0xpc3RlbmVyKGpzRXZlbnQpIHtcbiAgICBpZiAoanNFdmVudC50YXJnZXQubWF0Y2hlcyh0aGlzLnNlbGVjdG9yKSkge1xuICAgICAgdGhpcy5zZW5kTWVzc2FnZSgpO1xuXG4gICAgICBqc0V2ZW50LnRhcmdldC5yZW1vdmVFdmVudExpc3RlbmVyKHRoaXMuZXZlbnQsIHRoaXMuY2FsbGJhY2ssIGZhbHNlKTtcbiAgICB9XG4gIH1cblxuICBJbnRlcnNlY3Rpb25TaG93Q2FsbGJhY2soY2hhbmdlTGlzdGVuZXIpIHtcbiAgICBpZiAodGhpcy5pc0ludGVyc2VjdGluZykge1xuICAgICAgY2hhbmdlTGlzdGVuZXIuc2VuZE1lc3NhZ2UoKTtcbiAgICAgIGNoYW5nZUxpc3RlbmVyLmRpc2Nvbm5lY3RMaXN0ZW5lcigpO1xuICAgIH1cbiAgfVxuXG4gIEludGVyc2VjdGlvbkhpZGVDYWxsYmFjayhjaGFuZ2VMaXN0ZW5lcikge1xuICAgIGlmICh0aGlzLmludGVyc2VjdGlvblJhdGlvID09PSAwICYmIHRoaXMuaXNJbnRlcnNlY3RpbmcgPT09IGZhbHNlKSB7XG4gICAgICBjaGFuZ2VMaXN0ZW5lci5zZW5kTWVzc2FnZSgpO1xuICAgICAgY2hhbmdlTGlzdGVuZXIuZGlzY29ubmVjdExpc3RlbmVyKCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIENhbGxiYWNrINGE0YPQvdC60YbQuNGPINC60L7Qs9C00LAgZXZlbnQgPT0gJ3Nob3cnICjQv9C+0LrQsNC3KSDQuCDRjdGC0L7Qs9C+INGN0LvQtdC80LXQvdGC0LAg0L3QtdGCINCyIERPTVxuICAgKi9cbiAgc2hvd0NhbGxiYWNrKGNoYW5nZUxpc3RlbmVyKSB7XG4gICAgaWYgKHRoaXMudHlwZSA9PT0gJ2NoaWxkTGlzdCcgJiYgdGhpcy5hZGRlZE5vZGVzLmxlbmd0aCA+IDApIHtcbiAgICAgIGNvbnN0IGVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihjaGFuZ2VMaXN0ZW5lci5zZWxlY3Rvcik7XG5cbiAgICAgIGlmICh0aGlzLmFkZGVkTm9kZXNbMF0uaXNTYW1lTm9kZShlbCkpIHtcbiAgICAgICAgY2hhbmdlTGlzdGVuZXIuc2VuZE1lc3NhZ2UoKTtcbiAgICAgICAgcmV0dXJuIGNoYW5nZUxpc3RlbmVyLmRpc2Nvbm5lY3RMaXN0ZW5lcigpO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuXG4gIGhpZGVDYWxsYmFjayhjaGFuZ2VMaXN0ZW5lcikge1xuICAgIGlmICh0aGlzLnR5cGUgPT09ICdjaGlsZExpc3QnICYmIHRoaXMucmVtb3ZlZE5vZGVzLmxlbmd0aCA+IDApIHtcbiAgICAgIGNvbnN0IG5vZGUgPSB0aGlzLnJlbW92ZWROb2Rlc1swXTtcblxuICAgICAgaWYgKG5vZGUubm9kZVR5cGUgPT09IDEgJiYgbm9kZS5tYXRjaGVzKGNoYW5nZUxpc3RlbmVyLnNlbGVjdG9yKSkge1xuICAgICAgICBjaGFuZ2VMaXN0ZW5lci5zZW5kTWVzc2FnZSgpO1xuICAgICAgICByZXR1cm4gY2hhbmdlTGlzdGVuZXIuZGlzY29ubmVjdExpc3RlbmVyKCk7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuXG4gIGNsYXNzQ2hhbmdlQ2FsbGJhY2soY2hhbmdlTGlzdGVuZXIpIHtcbiAgICBpZiAodGhpcy50eXBlID09PSAnYXR0cmlidXRlcycgJiYgdGhpcy5hdHRyaWJ1dGVOYW1lID09PSAnY2xhc3MnKSB7XG4gICAgICBjaGFuZ2VMaXN0ZW5lci5zZW5kTWVzc2FnZSgpO1xuICAgICAgcmV0dXJuIGNoYW5nZUxpc3RlbmVyLmRpc2Nvbm5lY3RMaXN0ZW5lcigpO1xuICAgIH1cbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cblxuICBhdHRyaWJ1dGVDaGFuZ2VDYWxsYmFjayhjaGFuZ2VMaXN0ZW5lcikge1xuICAgIGlmICh0aGlzLnR5cGUgPT09ICdhdHRyaWJ1dGVzJyAmJiB0aGlzLmF0dHJpYnV0ZU5hbWUgPT09IGNoYW5nZUxpc3RlbmVyLmF0dHJpYnV0ZU5hbWUpIHtcbiAgICAgIGNoYW5nZUxpc3RlbmVyLnNlbmRNZXNzYWdlKCk7XG4gICAgICByZXR1cm4gY2hhbmdlTGlzdGVuZXIuZGlzY29ubmVjdExpc3RlbmVyKCk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbiAgY2hhcmFjdGVyRGF0YUNoYW5nZUNhbGxiYWNrKGNoYW5nZUxpc3RlbmVyKSB7XG4gICAgaWYgKHRoaXMudHlwZSA9PT0gJ2NoYXJhY3RlckRhdGEnIHx8IHRoaXMudHlwZSA9PT0gJ2NoaWxkTGlzdCcpIHtcbiAgICAgIGNoYW5nZUxpc3RlbmVyLnNlbmRNZXNzYWdlKCk7XG4gICAgICBjaGFuZ2VMaXN0ZW5lci5kaXNjb25uZWN0TGlzdGVuZXIoKTtcbiAgICB9XG4gIH1cblxuICBjaGlsZHJlbkNoYW5nZUNhbGxiYWNrKGNoYW5nZUxpc3RlbmVyKSB7XG4gICAgaWYgKHRoaXMudHlwZSA9PT0gJ2NoaWxkTGlzdCcpIHtcbiAgICAgIGNoYW5nZUxpc3RlbmVyLnNlbmRNZXNzYWdlKCk7XG4gICAgICBjaGFuZ2VMaXN0ZW5lci5kaXNjb25uZWN0TGlzdGVuZXIoKTtcbiAgICB9XG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgQ2hhbmdlc0xpc3RlbmVyO1xuIl0sInNvdXJjZVJvb3QiOiIifQ==